<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZerO Inbox - Interactive Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* iOS Safari tap fix - make all clickable elements tappable */
        [onclick], button, [role="button"], .clickable, *[cursor="pointer"] {
            -webkit-tap-highlight-color: rgba(255, 255, 255, 0.2);
            -webkit-touch-callout: none;
        }

        html {
            overflow-x: hidden;
            width: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 30%, #4a1942 60%, #1f1f3a 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
            position: relative;
            padding-top: 30px;
            padding-bottom: 20px;
        }

        /* Beta Banner - Fixed Top on Desktop, Bottom on Mobile */
        .beta-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg,
                rgba(26, 26, 46, 0.95) 0%,
                rgba(45, 27, 78, 0.95) 30%,
                rgba(74, 25, 66, 0.95) 60%,
                rgba(31, 31, 58, 0.95) 100%
            );
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(139, 92, 246, 0.4);
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.15),
                        0 0 40px rgba(139, 92, 246, 0.1);
            padding: 6px 20px;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
        }

        .beta-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg,
                transparent 0%,
                rgba(59, 130, 246, 0.05) 20%,
                rgba(139, 92, 246, 0.05) 50%,
                rgba(59, 130, 246, 0.05) 80%,
                transparent 100%
            );
            pointer-events: none;
            animation: shimmer 8s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .beta-banner-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .beta-banner-text {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .beta-banner-title {
            display: none;
        }

        .beta-banner-subtitle {
            font-size: 13px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.85);
        }

        .beta-banner-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-left: auto;
        }

        .beta-banner-btn {
            padding: 8px 20px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            white-space: nowrap;
            border: none;
            cursor: pointer;
            font-family: inherit;
        }

        .beta-banner-btn.primary {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #6366f1 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3),
                        0 0 20px rgba(139, 92, 246, 0.2);
            position: relative;
            overflow: hidden;
        }

        .beta-banner-btn.primary::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent
            );
            transform: rotate(45deg);
            animation: button-shine 3s ease-in-out infinite;
        }

        @keyframes button-shine {
            0%, 100% { transform: translateX(-100%) rotate(45deg); }
            50% { transform: translateX(100%) rotate(45deg); }
        }

        .beta-banner-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(59, 130, 246, 0.5),
                        0 0 40px rgba(139, 92, 246, 0.3);
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 50%, #4f46e5 100%);
        }

        .beta-banner-btn.secondary {
            background: rgba(139, 92, 246, 0.1);
            color: white;
            border: 1px solid rgba(139, 92, 246, 0.4);
            box-shadow: 0 2px 8px rgba(139, 92, 246, 0.1);
        }

        .beta-banner-btn.secondary:hover {
            background: rgba(139, 92, 246, 0.2);
            border-color: rgba(139, 92, 246, 0.6);
            box-shadow: 0 4px 16px rgba(139, 92, 246, 0.3);
        }

        .beta-banner-stats {
            display: flex;
            gap: 16px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            position: relative;
            z-index: 1;
        }

        .beta-banner-stat {
            display: flex;
            flex-direction: column;
            text-align: center;
        }

        .beta-banner-stat strong {
            font-size: 14px;
            font-weight: 700;
            color: white;
            display: block;
        }

        @media (max-width: 768px) {
            body {
                padding-top: 0;
                padding-bottom: 60px;
            }

            .beta-banner {
                top: auto;
                bottom: 0;
                border-top: 2px solid rgba(139, 92, 246, 0.4);
                border-bottom: none;
                box-shadow: 0 -4px 20px rgba(59, 130, 246, 0.15),
                            0 0 40px rgba(139, 92, 246, 0.1);
                padding: 6px 12px;
            }

            .beta-banner-actions {
                width: 100%;
                justify-content: flex-end;
                gap: 8px;
            }

            .beta-banner-stats {
                width: 100%;
                justify-content: space-around;
            }

            /* Mobile Touch Targets - Quick Action Buttons */
            .quick-action-icon {
                width: 64px;
                height: 64px;
                font-size: 26px;
            }

            .quick-action-btn {
                gap: 10px;
                padding: 8px;
                min-width: 80px;
            }

            .quick-action-label {
                font-size: 13px;
            }
        }

        /* Firefly Shader Background */
        .firefly-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .firefly {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            will-change: transform, opacity;
            animation: firefly-float ease-in-out infinite;
        }

        .firefly.small {
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, rgba(147, 197, 253, 1), rgba(147, 197, 253, 0.5) 40%, transparent 70%);
            box-shadow: 0 0 10px rgba(147, 197, 253, 0.8), 0 0 20px rgba(147, 197, 253, 0.4);
        }

        .firefly.medium {
            width: 5px;
            height: 5px;
            background: radial-gradient(circle, rgba(196, 181, 253, 1), rgba(196, 181, 253, 0.6) 40%, transparent 70%);
            box-shadow: 0 0 15px rgba(196, 181, 253, 0.9), 0 0 30px rgba(196, 181, 253, 0.5);
        }

        .firefly.warm {
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, rgba(251, 191, 36, 1), rgba(251, 191, 36, 0.7) 40%, transparent 70%);
            box-shadow: 0 0 12px rgba(251, 191, 36, 0.9), 0 0 25px rgba(251, 146, 60, 0.6);
        }

        @keyframes firefly-float {
            0%, 100% {
                transform: translate3d(0, 0, 0);
                opacity: 0.3;
            }
            25% {
                transform: translate3d(var(--tx1), var(--ty1), 0);
                opacity: 0.8;
            }
            50% {
                transform: translate3d(var(--tx2), var(--ty2), 0);
                opacity: 0.5;
            }
            75% {
                transform: translate3d(var(--tx3), var(--ty3), 0);
                opacity: 0.9;
            }
        }

        /* Main Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-top: 25px;
            margin-bottom: 25px;
        }

        .header-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .btn-home {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-home:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .main-title {
            font-size: 60px;
            font-weight: 900;
            margin-bottom: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        .main-subtitle {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.85);
            max-width: 600px;
            margin: 0 auto 8px;
            line-height: 1.3;
            text-align: center;
        }

        /* Animated Metrics */
        .metrics-bar {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 40px 0 80px;
            flex-wrap: wrap;
        }

        .metric-item {
            text-align: center;
            min-width: 200px;
        }

        .metric-value {
            font-size: 64px;
            font-weight: 900;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            margin-bottom: 12px;
        }

        .metric-label {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Tab Switcher */
        .tab-switcher {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin: 16px 0;
        }

        /* Tab Button Grid Container - 3x2 Grid */
        .tab-button-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            max-width: 600px;
            margin: 50px auto 40px;
        }

        .tab-button {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.7);
            padding: 14px 18px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            text-decoration: none;
            text-align: center;
            font-family: inherit;
            position: relative;
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
        }

        .tab-button:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
            padding: 6px 12px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            border-radius: 6px;
            pointer-events: none;
            opacity: 0;
            animation: tooltipFadeIn 0.2s ease forwards;
        }

        @keyframes tooltipFadeIn {
            to { opacity: 1; }
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Hero Section - iPhone Mockup */
        .hero-section {
            margin-top: 6px;
            margin-bottom: 0;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            position: relative;
        }

        .demo-instruction {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(102, 126, 234, 0.2);
            border: 2px solid rgba(102, 126, 234, 0.5);
            border-radius: 12px;
            padding: 16px 32px;
            font-size: 18px;
            font-weight: 600;
            color: white;
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            }
            50% {
                box-shadow: 0 0 40px rgba(102, 126, 234, 0.6);
            }
        }

        /* In-Phone Instruction (below status bar) */
        .in-phone-instruction {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(102, 126, 234, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(102, 126, 234, 0.4);
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            color: white;
            z-index: 250;
            animation: pulse-glow 2s ease-in-out infinite;
            width: 343px;
            text-align: center;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .in-phone-instruction.hide {
            opacity: 0;
            transform: translateX(-50%) translateY(-20px);
            pointer-events: none;
        }

        /* Bottom In-Phone Instruction */
        .in-phone-instruction-bottom {
            position: absolute;
            bottom: 85px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(102, 126, 234, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(102, 126, 234, 0.4);
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            color: white;
            z-index: 250;
            animation: pulse-glow 2s ease-in-out infinite;
            width: 343px;
            text-align: center;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .in-phone-instruction-bottom.hide {
            opacity: 0;
            transform: translateX(-50%) translateY(20px);
            pointer-events: none;
        }

        /* iPhone Mockup */
        .iphone-mockup {
            position: relative;
            width: 375px;
            height: 812px;
            background: #000;
            border-radius: 48px;
            box-shadow:
                0 40px 80px rgba(0, 0, 0, 0.8),
                0 0 0 12px #1d1d1f,
                0 0 0 14px rgba(255, 255, 255, 0.1),
                0 0 100px rgba(59, 130, 246, 0.4),
                0 0 200px rgba(139, 92, 246, 0.3),
                0 0 300px rgba(59, 130, 246, 0.2);
            overflow: hidden;
            animation: hero-glow 4s ease-in-out infinite;
        }

        @keyframes hero-glow {
            0%, 100% {
                box-shadow:
                    0 40px 80px rgba(0, 0, 0, 0.8),
                    0 0 0 12px #1d1d1f,
                    0 0 0 14px rgba(255, 255, 255, 0.1),
                    0 0 100px rgba(59, 130, 246, 0.4),
                    0 0 200px rgba(139, 92, 246, 0.3),
                    0 0 300px rgba(59, 130, 246, 0.2);
            }
            50% {
                box-shadow:
                    0 40px 80px rgba(0, 0, 0, 0.8),
                    0 0 0 12px #1d1d1f,
                    0 0 0 14px rgba(255, 255, 255, 0.1),
                    0 0 120px rgba(59, 130, 246, 0.6),
                    0 0 240px rgba(139, 92, 246, 0.5),
                    0 0 360px rgba(59, 130, 246, 0.4);
            }
        }

        .iphone-notch {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 180px;
            height: 30px;
            background: #000;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            z-index: 1000;
        }

        .iphone-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 30%, #4a1942 60%, #1f1f3a 100%);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .status-bar {
            height: 44px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            color: white;
            font-weight: 600;
        }

        .email-feed {
            position: absolute;
            top: 40px;
            bottom: 80px;
            left: 0;
            right: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Design System Gradients */
        .gradient-mail {
            background: linear-gradient(135deg, #3b82f6 0%, #0ea5e9 100%);
        }

        .gradient-ads {
            background: linear-gradient(135deg, #10b981 0%, #34ecb3 100%);
        }

        /* Email Card - iOS Faithful Swipe Stack */
        .email-card {
            position: absolute;
            width: 343px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 20px;
            cursor: grab;
            transition: transform 0.3s ease, opacity 0.3s ease;
            user-select: none;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .email-card.top-card {
            z-index: 100;
            cursor: grab;
        }

        .email-card.top-card:active {
            cursor: grabbing;
        }

        /* Card Header - iOS Layout */
        .card-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 16px;
        }

        /* Thread Badge */
        .thread-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: rgba(59, 130, 246, 0.25);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 12px;
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 700;
            color: rgba(147, 197, 253, 1);
            backdrop-filter: blur(10px);
        }

        .thread-badge-icon {
            font-size: 10px;
        }

        .square-view-btn {
            width: 56px;
            height: 56px;
            background: rgba(255, 255, 255, 0.25);
            border: none;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .square-view-btn:hover {
            background: rgba(255, 255, 255, 0.35);
        }

        .square-view-btn span {
            font-size: 10px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.85);
        }

        .sender-block {
            flex: 1;
            min-width: 0;
        }

        .sender-name {
            font-size: 16px;
            font-weight: 700;
            color: white;
            margin-bottom: 2px;
        }

        .sender-time {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Priority Badges - iOS Style */
        .priority-badge {
            font-size: 10px;
            font-weight: 800;
            padding: 3px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-badge.high {
            background: rgba(251, 146, 60, 0.9);
            color: white;
        }

        .priority-badge.medium {
            background: rgba(234, 179, 8, 0.9);
            color: black;
        }

        .priority-badge.low {
            background: rgba(34, 197, 94, 0.9);
            color: white;
        }

        /* Status Dots - iOS Indicators */
        .status-dots {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .status-dot.shopping {
            background: rgba(34, 197, 94, 0.9);
            box-shadow: 0 0 8px rgba(34, 197, 94, 0.5);
        }

        .status-dot.deadline {
            background: rgba(239, 68, 68, 0.9);
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.5);
        }

        .status-dot.attachment {
            background: rgba(59, 130, 246, 0.9);
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
        }

        /* Urgency Bar - iOS Style */
        .urgency-bar {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            color: white;
        }

        /* Email Content */
        .email-title {
            font-size: 19px;
            font-weight: 700;
            color: white;
            margin-bottom: 12px;
            line-height: 1.2;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .product-image-placeholder {
            width: 100%;
            height: 140px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            margin: 12px 0;
        }

        .email-summary {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.85);
            line-height: 1.5;
            margin: 12px 0;
        }

        /* Product Image - Shopping/ADS Cards */
        .product-image-container {
            width: 100%;
            height: 120px;
            border-radius: 12px;
            overflow: hidden;
            margin: 12px 0;
            background: rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .product-image-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.3);
            font-size: 14px;
        }

        /* Pricing Section - iOS Shopping Cards */
        .pricing-section {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 16px 0;
        }

        .sale-price {
            font-size: 34px;
            font-weight: 700;
            color: white;
        }

        .original-price {
            font-size: 20px;
            color: rgba(255, 255, 255, 0.5);
            text-decoration: line-through;
        }

        .discount-badge {
            font-size: 11px;
            font-weight: 700;
            color: white;
            padding: 6px 12px;
            background: rgba(34, 197, 94, 0.9);
            border-radius: 8px;
            text-transform: uppercase;
        }

        /* AI Intelligence Preview Section */
        .ai-preview-section {
            margin: 16px 0;
            padding: 16px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(167, 139, 250, 0.15));
            border: 1.5px solid rgba(139, 92, 246, 0.4);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .ai-preview-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(139, 92, 246, 0.1),
                transparent
            );
            animation: ai-shimmer 3s linear infinite;
        }

        @keyframes ai-shimmer {
            to {
                left: 100%;
            }
        }

        /* Streamlined AI Header with Percentage Bar */
        .ai-header-streamlined {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .ai-header-top {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-label {
            font-size: 11px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.8);
            margin-right: auto;
        }

        .ai-percentage {
            font-size: 11px;
            font-weight: 600;
            color: white;
            opacity: 0.9;
        }

        .ai-progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
        }

        .ai-progress-fill {
            height: 100%;
            background: white;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .ai-content {
            position: relative;
            z-index: 1;
        }

        .ai-actions-list {
            font-size: 15px;
            color: white;
            line-height: 1.6;
            margin-bottom: 10px;
            white-space: pre-line;
        }

        .ai-why {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
            font-style: italic;
        }

        .ai-context {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            white-space: pre-line;
            line-height: 1.5;
        }

        .ai-suggested-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 12px;
            position: relative;
            z-index: 1;
        }

        .action-badge {
            font-size: 11px;
            font-weight: 600;
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .action-badge.primary {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            border: 1px solid rgba(139, 92, 246, 0.5);
        }

        .action-badge:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .action-badge.primary:hover {
            background: linear-gradient(135deg, #7c3aed, #8b5cf6);
        }

        /* Action Modal System */
        .action-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .action-modal {
            background: linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 100%);
            border: 2px solid rgba(139, 92, 246, 0.4);
            border-radius: 24px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 28px;
            font-weight: 800;
            color: white;
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 24px;
            font-weight: 300;
            line-height: 1;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .modal-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .modal-section {
            margin-bottom: 24px;
        }

        .modal-section-title {
            font-size: 14px;
            font-weight: 700;
            color: rgba(139, 92, 246, 0.9);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .modal-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .modal-info-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-info-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .modal-info-value {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px 24px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
        }

        .modal-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.4);
        }

        .modal-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Success Toast - iOS Banner Style */
        .action-toast {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: linear-gradient(135deg, #10b981, #34d399);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            z-index: 600;
            animation: slideDownToast 0.4s ease-out forwards;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.6);
            max-width: 94%;
            width: 94%;
            text-align: center;
        }

        @keyframes slideDownToast {
            0% {
                transform: translateX(-50%) translateY(-100px);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            80% {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideUpToastOut {
            from {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            to {
                transform: translateX(-50%) translateY(-100px);
                opacity: 0;
            }
        }

        /* Action Bottom Sheet - Inside iPhone */
        .action-sheet-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 500;
            animation: fadeIn 0.3s ease-out;
        }

        .action-sheet {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 100%);
            border-top-left-radius: 24px;
            border-top-right-radius: 24px;
            padding: 20px;
            max-height: 60%;
            overflow-y: auto;
            z-index: 500;
            animation: slideUpSheet 0.3s ease-out;
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.5);
        }

        @keyframes slideUpSheet {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        .action-sheet-handle {
            width: 40px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            margin: 0 auto 20px;
        }

        .action-sheet-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .action-sheet-title {
            font-size: 22px;
            font-weight: 800;
            color: white;
        }

        .action-sheet-close {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 20px;
            line-height: 1;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-sheet-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .action-sheet-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 20px;
        }

        .action-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .action-option {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .action-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(139, 92, 246, 0.5);
            transform: translateX(4px);
        }

        .action-option.selected {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(167, 139, 250, 0.2));
            border-color: rgba(139, 92, 246, 0.6);
        }

        .action-option-content {
            flex: 1;
        }

        .action-option-name {
            font-size: 16px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .action-option-type {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .action-option-check {
            width: 24px;
            height: 24px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .action-option.selected .action-option-check {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            border-color: #8b5cf6;
        }

        .action-option-check svg {
            width: 14px;
            height: 14px;
            fill: white;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .action-option.selected .action-option-check svg {
            opacity: 1;
        }

        /* Quick Actions */
        .quick-actions-section {
            padding: 0 20px 16px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 16px;
        }

        .quick-actions-label {
            font-size: 10px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.5);
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .quick-actions-row {
            display: flex;
            gap: 16px;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: transform 0.2s ease;
            flex: 0 0 auto;
        }

        .quick-action-btn:hover {
            transform: scale(1.05);
        }

        .quick-action-btn.disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .quick-action-btn.disabled:hover {
            transform: none;
        }

        .quick-action-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.2s ease;
        }

        .quick-action-btn.share .quick-action-icon {
            background: rgba(0, 122, 255, 0.2);
            border: 1.5px solid rgba(0, 122, 255, 0.4);
            color: #007AFF;
        }

        .quick-action-btn.copy .quick-action-icon {
            background: rgba(175, 82, 222, 0.2);
            border: 1.5px solid rgba(175, 82, 222, 0.4);
            color: #AF52DE;
        }

        .quick-action-btn.safari .quick-action-icon {
            background: rgba(0, 199, 190, 0.2);
            border: 1.5px solid rgba(0, 199, 190, 0.4);
            color: #00C7BE;
        }

        .quick-action-btn.disabled .quick-action-icon {
            background: rgba(255, 255, 255, 0.05);
            border: 1.5px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.3);
        }

        .quick-action-label {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Swipe CTA Track - iOS Holographic Style */
        .swipe-cta-track {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 48px;
            margin-top: 16px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1.5px solid transparent;
            border-image: linear-gradient(
                90deg,
                rgba(6, 182, 212, 0.4),
                rgba(59, 130, 246, 0.5),
                rgba(139, 92, 246, 0.4),
                rgba(236, 72, 153, 0.3)
            ) 1;
            border-radius: 12px;
            padding: 0 16px;
            position: relative;
            overflow: hidden;
        }

        .swipe-cta-track::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                rgba(6, 182, 212, 0.2),
                rgba(139, 92, 246, 0.15),
                rgba(255, 255, 255, 0.1),
                transparent
            );
            animation: shimmer 1.875s linear infinite;
        }

        @keyframes shimmer {
            to {
                left: 100%;
            }
        }

        .chevron-group {
            display: flex;
            gap: 2px;
            font-size: 18px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.6);
        }

        .cta-label {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }

        /* Problem/Solution Split */
        .comparison-section {
            margin: 40px 0;
            padding: 0 20px;
        }

        .section-title {
            font-size: 48px;
            font-weight: 900;
            text-align: center;
            margin-bottom: 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Hide redundant section titles when on those tabs */
        #tab-difference .section-title,
        #tab-capabilities .section-title {
            display: none;
        }

        .comparison-grid {
            max-width: 750px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 2px solid;
            border-image: linear-gradient(
                135deg,
                rgba(139, 92, 246, 0.5),
                rgba(59, 130, 246, 0.5),
                rgba(236, 72, 153, 0.5)
            ) 1;
            border-radius: 20px;
            padding: 32px 24px;
            box-shadow: 0 0 60px rgba(139, 92, 246, 0.2);
        }

        .comparison-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px dotted rgba(255, 255, 255, 0.3);
            position: relative;
        }

        .comparison-header:after {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: repeating-linear-gradient(
                to bottom,
                rgba(255, 255, 255, 0.3) 0px,
                rgba(255, 255, 255, 0.3) 4px,
                transparent 4px,
                transparent 10px
            );
        }

        .comparison-header-item {
            font-size: 18px;
            font-weight: 700;
            padding: 0 12px;
        }

        .comparison-header-item.problem {
            text-align: right;
            filter: grayscale(0.5);
            color: rgba(255, 255, 255, 0.7);
        }

        .comparison-header-item.solution {
            text-align: left;
            color: rgba(52, 199, 89, 0.9);
        }

        .comparison-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 0;
            padding: 14px 0;
            border-bottom: 1px dotted rgba(255, 255, 255, 0.15);
            position: relative;
        }

        .comparison-row:last-child {
            border-bottom: none;
        }

        .comparison-row:after {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 1px;
            background: repeating-linear-gradient(
                to bottom,
                rgba(255, 255, 255, 0.2) 0px,
                rgba(255, 255, 255, 0.2) 4px,
                transparent 4px,
                transparent 8px
            );
        }

        .comparison-item {
            background: transparent;
            border: none;
            padding: 0 12px;
            font-size: 14px;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.85);
        }

        .comparison-item.problem {
            text-align: right;
            filter: grayscale(0.5);
            color: rgba(255, 255, 255, 0.65);
        }

        .comparison-item.solution {
            text-align: left;
            color: rgba(255, 255, 255, 0.95);
        }

        /* Feature Spotlights */
        .features-section {
            margin: 40px 0;
            padding: 0 20px;
        }

        .features-grid {
            max-width: 750px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 2px solid;
            border-image: linear-gradient(
                135deg,
                rgba(139, 92, 246, 0.5),
                rgba(59, 130, 246, 0.5),
                rgba(236, 72, 153, 0.5)
            ) 1;
            border-radius: 20px;
            padding: 32px 24px;
            box-shadow: 0 0 60px rgba(139, 92, 246, 0.2);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            position: relative;
        }

        .features-grid:after {
            content: '';
            position: absolute;
            left: 50%;
            top: 32px;
            bottom: 32px;
            width: 1px;
            background: repeating-linear-gradient(
                to bottom,
                rgba(255, 255, 255, 0.2) 0px,
                rgba(255, 255, 255, 0.2) 4px,
                transparent 4px,
                transparent 8px
            );
        }

        .features-grid:before {
            content: '';
            position: absolute;
            left: 24px;
            right: 24px;
            top: 50%;
            height: 1px;
            background: repeating-linear-gradient(
                to right,
                rgba(255, 255, 255, 0.2) 0px,
                rgba(255, 255, 255, 0.2) 4px,
                transparent 4px,
                transparent 8px
            );
        }

        .feature-row {
            padding: 20px 16px;
        }

        .feature-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
            color: rgba(52, 199, 89, 0.9);
        }

        .feature-description {
            font-size: 13px;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.85);
        }

        /* CTA Section */
        .cta-section {
            text-align: center;
            margin: 100px 0 60px;
            padding: 80px 40px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 32px;
        }

        .cta-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 24px;
        }

        .cta-subtitle {
            font-size: 20px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cta-btn {
            padding: 18px 48px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .cta-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }

        .cta-btn.primary:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.6);
        }

        .cta-btn.secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .cta-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .social-proof {
            margin-top: 40px;
            display: flex;
            gap: 40px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .proof-item {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
        }

        .proof-item strong {
            font-size: 20px;
            color: white;
            display: block;
            margin-bottom: 4px;
        }

        /* Bottom Navigation - Inside iPhone */
        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            z-index: 100;
        }

        .nav-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .archetype-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .archetype-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .archetype-pill {
            padding: 4px 12px;
            border-radius: 14px;
            font-size: 12px;
            font-weight: 700;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .archetype-pill.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .archetype-pill.inactive {
            background: transparent;
            color: rgba(255, 255, 255, 0.5);
        }

        .nav-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .cart-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-size: 11px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .email-counter-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 9px;
            font-weight: 700;
            padding: 2px 5px;
            border-radius: 10px;
            min-width: 16px;
            text-align: center;
        }

        .progress-container {
            position: absolute;
            bottom: 80px;
            left: 0;
            right: 0;
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .progress-bar-bg {
            height: 4px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg,
                rgba(0, 255, 255, 0.8) 0%,
                rgba(0, 150, 255, 0.9) 25%,
                rgba(138, 43, 226, 0.8) 75%,
                rgba(255, 105, 180, 0.7) 100%
            );
            box-shadow: 0 0 4px rgba(0, 255, 255, 0.5);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        /* Mini Celebration Toast */
        .mini-celebration {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .mini-celebration-toast {
            display: flex;
            align-items: center;
            gap: 16px;
            background: rgba(0, 0, 0, 0.85);
            border: 2px solid transparent;
            border-image: linear-gradient(135deg, #0f9d58 0%, #4285f4 100%) 1;
            border-radius: 20px;
            padding: 20px;
            color: white;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            animation: miniToastSlideIn 0.5s ease;
            max-width: 80%;
        }

        @keyframes miniToastSlideIn {
            from {
                opacity: 0;
                transform: translateY(100px) scale(0.5);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Major Celebration Full Screen */
        .major-celebration {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg,
                rgba(255, 215, 0, 0.9) 0%,
                rgba(255, 105, 180, 0.9) 50%,
                rgba(138, 43, 226, 0.9) 100%
            );
        }

        .major-celebration-content {
            text-align: center;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: celebrationBounceIn 0.6s ease;
        }

        @keyframes celebrationBounceIn {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }
            60% {
                transform: scale(1.1);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .celebration-continue-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease;
        }

        .celebration-continue-btn:hover {
            transform: translateY(-2px);
        }

        /* Confetti Animation */
        .celebration-confetti {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            overflow: hidden;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(800px) rotate(720deg);
                opacity: 0;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .features-grid {
                padding: 20px;
                grid-template-columns: 1fr;
            }

            .features-grid:after {
                display: none;
            }

            .features-grid:before {
                display: none;
            }

            .feature-row {
                padding: 16px 12px;
                border-bottom: 1px dotted rgba(255, 255, 255, 0.15);
            }

            .feature-row:last-child {
                border-bottom: none;
            }

            .feature-title {
                font-size: 15px;
            }

            .feature-description {
                font-size: 13px;
            }
        }

        @media (max-width: 768px) {
            .comparison-grid {
                padding: 20px;
            }

            .comparison-header {
                grid-template-columns: 1fr;
                gap: 12px;
                padding-bottom: 12px;
            }

            .comparison-header:after {
                display: none;
            }

            .comparison-header-item {
                font-size: 16px;
                padding: 0 12px;
                text-align: center !important;
            }

            .comparison-row {
                grid-template-columns: 1fr;
                gap: 12px;
                padding: 10px 0;
            }

            .comparison-row:after {
                display: none;
            }

            .comparison-item {
                font-size: 13px;
                padding: 0 12px;
                text-align: left !important;
            }
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 48px;
            }

            .main-subtitle {
                font-size: 18px;
                margin: 16px auto 0;
            }

            .metrics-bar {
                gap: 32px;
            }

            .metric-value {
                font-size: 48px;
            }

            .iphone-mockup {
                transform: scale(0.85);
            }

            .section-title {
                font-size: 36px;
            }

            .tab-switcher {
                flex-direction: column;
                gap: 10px;
                padding: 0 16px;
                max-width: 100%;
                margin: 16px auto;
            }

            .tab-button-grid {
                max-width: 100%;
                padding: 0 16px;
                gap: 10px;
                margin: 16px auto 40px;
            }

            .tab-button {
                padding: 14px 12px;
                font-size: 12px;
                white-space: normal;
                line-height: 1.3;
                min-height: 48px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .tab-button:hover {
                transform: none;
            }
        }

        /* Email Detail Modal */
        .email-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .email-modal.show {
            display: flex;
            opacity: 1;
        }

        .email-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .email-modal-content {
            position: relative;
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideUp 0.3s ease;
        }

        @keyframes modalSlideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .email-modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: flex-end;
        }

        .email-modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .email-modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .email-modal-body {
            padding: 24px;
            overflow-y: auto;
            max-height: calc(85vh - 72px);
        }

        .email-detail-from {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 8px;
        }

        .email-detail-subject {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin-bottom: 16px;
            line-height: 1.3;
        }

        .email-detail-meta {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
        }

        .email-detail-preview {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            margin-bottom: 24px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .email-detail-section {
            margin-bottom: 24px;
        }

        .email-detail-section-title {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .email-detail-section-content {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            white-space: pre-line;
        }

        .email-detail-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .email-detail-action-btn {
            padding: 10px 16px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .email-detail-action-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-1px);
        }

        .email-detail-action-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* Beta Access Form Modal */
        .beta-form-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .beta-form-overlay.active {
            display: flex;
        }

        .beta-form-modal {
            background: linear-gradient(135deg,
                rgba(26, 26, 46, 0.98) 0%,
                rgba(45, 27, 78, 0.98) 50%,
                rgba(31, 31, 58, 0.98) 100%
            );
            backdrop-filter: blur(30px);
            border: 2px solid rgba(139, 92, 246, 0.4);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5),
                        0 0 100px rgba(139, 92, 246, 0.2);
            position: relative;
        }

        .beta-form-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s ease;
            line-height: 1;
        }

        .beta-form-close:hover {
            opacity: 1;
        }

        .beta-form-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .beta-form-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 30px;
        }

        .beta-form-group {
            margin-bottom: 20px;
        }

        .beta-form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: white;
        }

        .beta-form-input,
        .beta-form-select,
        .beta-form-textarea {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .beta-form-input:focus,
        .beta-form-select:focus,
        .beta-form-textarea:focus {
            outline: none;
            border-color: rgba(139, 92, 246, 0.6);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
        }

        .beta-form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .beta-form-submit {
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #6366f1 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .beta-form-submit::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent
            );
            transform: rotate(45deg);
            animation: button-shine 3s ease-in-out infinite;
        }

        .beta-form-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .beta-form-submit:active {
            transform: translateY(0);
        }

        .beta-form-success {
            text-align: center;
            padding: 40px;
        }

        .beta-form-success-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .beta-form-success-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .beta-form-success-message {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 30px;
        }
        /* ==================== ACTION FLOW MODAL STYLES ==================== */
        .action-flow-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .action-flow-overlay.active {
            display: flex;
            opacity: 1;
        }

        .action-flow-modal {
            background: rgba(28, 28, 30, 0.98);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 32px;
            max-width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .action-flow-overlay.active .action-flow-modal {
            transform: scale(1);
        }

        .action-flow-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .action-flow-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .action-flow-title {
            font-size: 24px;
            font-weight: 700;
            color: white;
            margin-bottom: 24px;
            text-align: center;
        }

        .modal-flow-horizontal {
            display: flex;
            align-items: center;
            gap: 16px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 20px 0;
            flex-wrap: nowrap;
            scrollbar-width: thin;
            scrollbar-color: rgba(139, 92, 246, 0.4) rgba(255, 255, 255, 0.05);
        }

        .modal-flow-horizontal::-webkit-scrollbar {
            height: 8px;
        }

        .modal-flow-horizontal::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .modal-flow-horizontal::-webkit-scrollbar-thumb {
            background: linear-gradient(90deg, rgba(6, 182, 212, 0.5) 0%, rgba(139, 92, 246, 0.5) 50%, rgba(236, 72, 153, 0.5) 100%);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-flow-horizontal::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(90deg, rgba(6, 182, 212, 0.7) 0%, rgba(139, 92, 246, 0.7) 50%, rgba(236, 72, 153, 0.7) 100%);
        }

        .modal-flow-step {
            min-width: 180px;
            max-width: 180px;
            flex-shrink: 0;
        }

        .modal-flow-label {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 12px;
            text-align: center;
        }

        .modal-flow-arrow {
            font-size: 24px;
            color: rgba(52, 199, 89, 0.6);
            flex-shrink: 0;
        }

        .modal-email-card,
        .modal-preview-card,
        .modal-success-state {
            background: rgba(28, 28, 30, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 16px;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .modal-success-state {
            background: rgba(52, 199, 89, 0.15);
            border-color: rgba(52, 199, 89, 0.4);
            text-align: center;
            padding: 24px;
        }

        .modal-success-icon {
            width: 48px;
            height: 48px;
            background: rgba(52, 199, 89, 1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: 700;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Ellipses Menu */
        .menu-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            text-decoration: none;
        }

        .menu-button:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(1.05);
        }

        .menu-button-icon {
            font-size: 20px;
            color: white;
        }

        .menu-dropdown {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 8px 0;
            min-width: 200px;
            opacity: 0;
            transform: translateY(10px);
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 999;
        }

        .menu-dropdown.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .menu-item-icon {
            margin-right: 12px;
            font-size: 16px;
        }

        .menu-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 4px 0;
        }

        /* Navigation Bar - Below Beta Banner */
        .main-nav {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            background: rgba(26, 26, 46, 0.92);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
            z-index: 9998;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px;
        }

        .nav-links {
            display: flex;
            gap: 8px;
            list-style: none;
            padding: 8px 0;
        }

        .nav-link {
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-link:hover {
            background: rgba(139, 92, 246, 0.2);
            color: white;
            transform: translateY(-1px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.3));
            color: white;
            border: 1px solid rgba(139, 92, 246, 0.4);
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 70px;
            right: 20px;
            z-index: 10000;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(139, 92, 246, 0.9));
            border: none;
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            transition: all 0.3s ease;
        }

        .mobile-menu-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.6);
        }

        /* Mobile Drawer */
        .mobile-drawer {
            position: fixed;
            top: 0;
            right: -100%;
            width: 280px;
            height: 100vh;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.98), rgba(45, 27, 78, 0.98));
            backdrop-filter: blur(20px);
            box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
            z-index: 10001;
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 80px 20px 20px 20px;
            overflow-y: auto;
        }

        .mobile-drawer.open {
            right: 0;
        }

        .mobile-drawer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.3);
        }

        .mobile-drawer-title {
            font-size: 20px;
            font-weight: 700;
            color: white;
        }

        .mobile-drawer-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-nav-links {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .mobile-nav-link {
            display: block;
            padding: 16px 20px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.03);
        }

        .mobile-nav-link:hover {
            background: rgba(139, 92, 246, 0.2);
            transform: translateX(4px);
        }

        .mobile-nav-link.active {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.3));
            border: 1px solid rgba(139, 92, 246, 0.4);
        }

        /* Mobile Backdrop */
        .mobile-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mobile-backdrop.visible {
            display: block;
            opacity: 1;
        }

        @media (max-width: 768px) {
            body {
                padding-top: 60px;
            }

            .main-nav {
                display: none;
            }

            .mobile-menu-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

    </style>
</head>
<body>
    <!-- Beta Banner -->
    <div class="beta-banner">
        <div class="beta-banner-content">
            <div class="beta-banner-text">
                <div class="beta-banner-subtitle">Join early adopters achieving inbox zero  Built and ready for testing</div>
            </div>
            <div class="beta-banner-actions">
                <a href="https://apps.apple.com/us/app/testflight/id899247664" target="_blank" class="beta-banner-btn secondary">
                    Download TestFlight
                </a>
                <button onclick="openBetaAccessForm()" class="beta-banner-btn primary">
                    Request Access
                </button>
            </div>
        </div>
    </div>

    <!-- Main Navigation (Desktop) -->
    <nav class="main-nav">
        <div class="nav-container">
            <ul class="nav-links">
                <li><a href="landing.html" class="nav-link">Home</a></li>
                <li><a href="/" class="nav-link active">Live Demo</a></li>
                <li><a href="zero-sequence-live.html" class="nav-link">Intent-Action Demo</a></li>
                <li><a href="action-modal-explorer.html" class="nav-link">Actions</a></li>
                <li><a href="intent-action-explorer.html" class="nav-link">Intents</a></li>
                <li><a href="shopping-cart.html" class="nav-link">Shopping</a></li>
                <li><a href="architecture-visual.html" class="nav-link">System Architecture</a></li>
            </ul>
        </div>
    </nav>

    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="Menu">
        
    </button>

    <!-- Mobile Backdrop -->
    <div class="mobile-backdrop" id="mobileBackdrop" onclick="closeMobileMenu()"></div>

    <!-- Mobile Drawer -->
    <div class="mobile-drawer" id="mobileDrawer">
        <div class="mobile-drawer-header">
            <span class="mobile-drawer-title">Navigation</span>
            <button class="mobile-drawer-close" onclick="closeMobileMenu()" aria-label="Close"></button>
        </div>
        <ul class="mobile-nav-links">
            <li><a href="landing.html" class="mobile-nav-link">Home</a></li>
            <li><a href="/" class="mobile-nav-link active">Live Demo</a></li>
            <li><a href="zero-sequence-live.html" class="mobile-nav-link">Intent-Action Demo</a></li>
            <li><a href="action-modal-explorer.html" class="mobile-nav-link">Actions</a></li>
            <li><a href="intent-action-explorer.html" class="mobile-nav-link">Intents</a></li>
            <li><a href="shopping-cart.html" class="mobile-nav-link">Shopping</a></li>
            <li><a href="architecture-visual.html" class="mobile-nav-link">System Architecture</a></li>
        </ul>
    </div>

    <!-- Beta Access Form Modal -->
    <div class="beta-form-overlay" id="betaFormOverlay">
        <div class="beta-form-modal" id="betaFormModal">
            <button class="beta-form-close" onclick="closeBetaAccessForm()">&times;</button>

            <div id="betaFormContent">
                <h2 class="beta-form-title">Request Beta Access</h2>
                <p class="beta-form-subtitle">Join the waitlist to get early access to ZerO Inbox</p>

                <form id="betaAccessForm" onsubmit="submitBetaAccess(event)">
                    <div class="beta-form-group">
                        <label class="beta-form-label" for="betaName">Full Name *</label>
                        <input type="text" id="betaName" name="name" class="beta-form-input" required placeholder="John Doe">
                    </div>

                    <div class="beta-form-group">
                        <label class="beta-form-label" for="betaEmail">Email Address *</label>
                        <input type="email" id="betaEmail" name="email" class="beta-form-input" required placeholder="john@example.com">
                    </div>

                    <div class="beta-form-group">
                        <label class="beta-form-label" for="betaProvider">Current Email Provider *</label>
                        <select id="betaProvider" name="provider" class="beta-form-select" required>
                            <option value="">Select your email provider</option>
                            <option value="gmail">Gmail</option>
                            <option value="outlook">Outlook / Microsoft</option>
                            <option value="apple">Apple Mail / iCloud</option>
                            <option value="yahoo">Yahoo Mail</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="beta-form-group">
                        <label class="beta-form-label" for="betaReason">Why do you want to try ZerO Inbox? (Optional)</label>
                        <textarea id="betaReason" name="reason" class="beta-form-textarea" placeholder="Tell us what you're looking for in an email client..."></textarea>
                    </div>

                    <button type="submit" class="beta-form-submit">Submit Request</button>
                </form>
            </div>

            <div id="betaSuccessContent" style="display: none;">
                <div class="beta-form-success">
                    <div class="beta-form-success-icon"></div>
                    <h3 class="beta-form-success-title">You're on the list!</h3>
                    <p class="beta-form-success-message">
                        Thanks for your interest in ZerO Inbox. We'll reach out soon with beta access instructions.
                    </p>
                    <button onclick="closeBetaAccessForm()" class="beta-banner-btn primary">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firefly Background -->
    <div class="firefly-background" id="fireflyBg"></div>

    <!-- Main Content -->
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="main-title">ZerO Inbox</h1>

            <p class="main-subtitle">
                Short-form email, swipe and move on.
            </p>
        </div>

        <!-- Tab Content: Demo -->
        <div class="tab-content active" id="tab-demo">
        <!-- Hero Section - Interactive iPhone Mockup -->
        <div class="hero-section">
            <div class="iphone-mockup">
                <div class="iphone-notch"></div>
                <div class="iphone-screen">
                    <div class="status-bar">
                        <span>9:41</span>
                        <span></span>
                    </div>

                    <!-- In-Phone Demo Instruction -->
                    <div class="in-phone-instruction" id="inPhoneInstruction">
                        Try it: Swipe right on an email to take action
                    </div>

                    <div class="email-feed" id="emailFeed">
                        <!-- Email cards will be dynamically inserted -->
                    </div>

                    <!-- Progress Bar - Above Bottom Nav -->
                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-label">
                            <span style="font-size: 9px; font-weight: 700; letter-spacing: 1px; opacity: 0.7;">INBOX PROGRESS</span>
                            <span style="font-size: 10px; font-weight: 700; opacity: 0.9;" id="progressPercentage">0%</span>
                        </div>
                        <div class="progress-bar-bg">
                            <div class="progress-bar-fill" id="progressBarFill" style="width: 0%;"></div>
                        </div>
                    </div>

                    <!-- Mini Celebration Toast -->
                    <div class="mini-celebration" id="miniCelebration" style="display: none;">
                        <div class="celebration-confetti" id="miniConfetti"></div>
                        <div class="mini-celebration-toast">
                            <div style="font-size: 32px;"></div>
                            <div>
                                <div style="font-weight: 700; font-size: 16px;">Nice work!</div>
                                <div style="font-size: 14px; opacity: 0.9; margin-top: 4px;" id="miniCelebrationText"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Major Celebration Full Screen -->
                    <div class="major-celebration" id="majorCelebration" style="display: none;">
                        <div class="celebration-confetti" id="majorConfetti"></div>
                        <div class="major-celebration-content">
                            <div style="font-size: 120px; margin-bottom: 20px;"></div>
                            <div style="font-size: 54px; font-weight: 700; margin-bottom: 10px;">Total Inbox Zero!</div>
                            <div style="font-size: 24px; opacity: 0.9; margin-bottom: 30px;">All Categories Cleared!</div>
                            <button class="celebration-continue-btn" onclick="dismissMajorCelebration()">Continue</button>
                        </div>
                    </div>

                    <!-- Bottom In-Phone Demo Instruction -->
                    <div class="in-phone-instruction-bottom" id="inPhoneInstructionBottom">
                        Swipe up to change actions first
                    </div>

                    <!-- Bottom Navigation - Inside iPhone -->
                    <div class="bottom-nav" id="bottomNav">
                        <div class="nav-section">
                            <!-- Archetype Toggle -->
                            <div class="archetype-toggle" id="archetypeToggle">
                                <span class="archetype-pill active" id="mailPill" onclick="switchArchetype('mail')" style="position: relative;">
                                    Mail
                                    <span class="email-counter-badge" id="mailCounter">0</span>
                                </span>
                                <span class="archetype-pill inactive" id="adsPill" onclick="switchArchetype('ads')" style="position: relative;">
                                    Ads
                                    <span class="email-counter-badge" id="adsCounter">0</span>
                                </span>
                            </div>
                        </div>

                        <div class="nav-section">
                            <!-- Refresh -->
                            <div class="nav-icon" onclick="refreshFeed()" title="Refresh">
                                <span></span>
                            </div>
                        </div>

                        <div class="nav-section">
                            <!-- Shopping Cart -->
                            <div class="nav-icon" onclick="alert('Shopping cart feature - tracks deals across all your emails!')" title="Shopping Cart">
                                <span></span>
                                <span class="cart-badge" id="cartBadge">3</span>
                            </div>
                            <!-- Settings -->
                            <div class="nav-icon" onclick="alert('Settings - customize your Zero experience')" title="Settings">
                                <span></span>
                            </div>
                            <!-- Search -->
                            <div class="nav-icon" onclick="alert('Search - find any email instantly')" title="Search">
                                <span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ANIMATED METRICS - USER EMPHASIZED -->
        </div>
        <!-- End Tab Content: Demo -->

        <!-- Tab Content: The Zero Difference -->
        <div class="tab-content" id="tab-difference">
        <!-- Problem/Solution Comparison -->
        <div class="comparison-section">
            <h2 class="section-title">The Zero Difference</h2>

            <div class="comparison-grid">
                <div class="comparison-header">
                    <div class="comparison-header-item problem">Traditional Email</div>
                    <div class="comparison-header-item solution">Zero</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">50 unread emails staring at you</div>
                    <div class="comparison-item solution">AI instantly classifies all 50 emails</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">Manual sorting and categorization</div>
                    <div class="comparison-item solution">Auto-sorted into Mail/Ads categories</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">Copy/paste tracking numbers to browser</div>
                    <div class="comparison-item solution">One-tap package tracking</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">Switch between 5+ apps for each task</div>
                    <div class="comparison-item solution">Native Calendar, Wallet, Notes integration</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">10 minutes to process 10 emails</div>
                    <div class="comparison-item solution">6 swipes to complete 10 tasks</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">No context or suggested actions</div>
                    <div class="comparison-item solution">AI-powered intent detection</div>
                </div>

                <div class="comparison-row">
                    <div class="comparison-item problem">Miss important deadlines and dates</div>
                    <div class="comparison-item solution">Smart reminders & 2 min to inbox zero</div>
                </div>
            </div>
        </div>

        <!-- Feature Spotlights -->
        <div class="features-section" style="margin-top: 60px;">
            <h2 class="section-title">Unique Capabilities That Make It Possible</h2>

            <div class="features-grid">
                <div class="feature-row">
                    <h3 class="feature-title">Native iOS Integrations</h3>
                    <p class="feature-description">
                        Deep system integrations with iOS. Add to Calendar, Wallet, Notes,
                        Reminders, Messages, and Contacts with one tap. No web views - real iOS APIs.
                    </p>
                </div>

                <div class="feature-row">
                    <h3 class="feature-title">137 Email Intents</h3>
                    <p class="feature-description">
                        From shipping updates to healthcare appointments, travel bookings to bill payments.
                        Our AI understands a majority of emails, from simple to complex.
                    </p>
                </div>

                <div class="feature-row">
                    <h3 class="feature-title">Unified Shopping Cart</h3>
                    <p class="feature-description">
                        Track products, prices, and deals across ALL your shopping emails. Expiration tracking
                        and merchant comparison. One cart for your entire inbox.
                    </p>
                </div>

                <div class="feature-row">
                    <h3 class="feature-title">Compound Workflows</h3>
                    <p class="feature-description">
                        Multi-step tasks in one swipe. Sign a school form, pay the fee, and add the event to your
                        calendar automatically. Intelligent workflows that save hours.
                    </p>
                </div>
            </div>
        </div>

        </div>
        <!-- End Tab Content: The Zero Difference -->
    </div>

    <script>
        // ==================== GLOBAL STATE MANAGEMENT ====================


        // ==================== ACTION FLOW DEFINITIONS ====================

        const MODAL_FLOWS = {
            'sign_form': {
                title: 'Sign Form',
                steps: [
                    {
                        label: '1. Form Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Permission Form</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Signature required</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Sign</div>
                        </div>`
                    },
                    {
                        label: '2. Draw Signature',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Sign Form</div>
                            <div style="background: rgba(255,255,255,0.95); height: 80px; border-radius: 10px; display: flex; align-items: center; justify-content: center; color: #999; font-style: italic;">
                                Draw your signature
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Confirm',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm Signature</div>
                            <div style="background: rgba(147, 51, 234, 0.15); border: 2px solid rgba(147, 51, 234, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Field Trip Permission Form</div>
                                <div style="font-size: 14px; opacity: 0.8;">Ready to send with your signature</div>
                            </div>
                            <div style="background: rgba(147, 51, 234, 0.3); padding: 14px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Send Signed Form
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Signed',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Form Signed!</div>
                            <div style="opacity: 0.8;">Reply sent with signature</div>
                        </div>`
                    }
                ]
            },
            'pay_invoice': {
                title: 'Pay Invoice',
                steps: [
                    {
                        label: '1. Invoice Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Invoice #INV-2025-1234</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$599.00</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due: Oct 30, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Pay Now</div>
                        </div>`
                    },
                    {
                        label: '2. Payment Method',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pay Invoice</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="opacity: 0.7; font-size: 12px;">Amount Due</div>
                                <div style="font-size: 28px; font-weight: 700; color: #FFD700;">$599.00</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Pay with Apple Pay
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Processing',
                        html: `<div class="modal-preview-card" style="background: rgba(59, 130, 246, 0.15); border-color: rgba(59, 130, 246, 0.4);">
                            <div style="width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.2); border-top-color: #3B82F6; border-radius: 50%; margin: 0 auto 16px; animation: spin 1s linear infinite;"></div>
                            <div style="text-align: center; font-weight: 600;">Processing Payment...</div>
                        </div>`
                    },
                    {
                        label: '4. Complete',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Payment Sent!</div>
                            <div style="opacity: 0.8;">$599.00 paid to Acme Corp</div>
                        </div>`
                    }
                ]
            },
            'track_package': {
                title: 'Track Package',
                steps: [
                    {
                        label: '1. Shipping Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your order has shipped</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">UPS  Arrives Friday</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Track</div>
                        </div>`
                    },
                    {
                        label: '2. Tracking Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Package Tracking</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px;">
                                <div style="font-size: 12px; opacity: 0.7;">Status</div>
                                <div style="font-weight: 600; color: #FFD700;">Out for Delivery</div>
                            </div>
                            <div style="display: flex; gap: 8px; margin-top: 12px;">
                                <div style="flex: 1; height: 4px; background: rgba(52, 199, 89, 0.8); border-radius: 2px;"></div>
                                <div style="flex: 1; height: 4px; background: rgba(52, 199, 89, 0.8); border-radius: 2px;"></div>
                                <div style="flex: 1; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px;"></div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Live Updates',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Tracking Active</div>
                            <div style="opacity: 0.8;">Push notifications enabled</div>
                        </div>`
                    }
                ]
            },
            'check_in_flight': {
                title: 'Check In Flight',
                steps: [
                    {
                        label: '1. Check-in Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">UA 1234 Ready for Check-in</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">SFO  JFK  Tomorrow 9:00 AM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(59, 130, 246, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Check In</div>
                        </div>`
                    },
                    {
                        label: '2. Seat Selection',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Check In</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px;">
                                <div style="font-weight: 600;">Flight UA 1234</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-top: 4px;">Seat 12A</div>
                            </div>
                            <div style="background: rgba(59, 130, 246, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Confirm Check-in
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Boarding Pass',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Checked In!</div>
                            <div style="opacity: 0.8;">Pass added to Wallet</div>
                        </div>`
                    }
                ]
            },
            'schedule_purchase': {
                title: 'Scheduled Purchase',
                steps: [
                    {
                        label: '1. Product',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Monthly Coffee Subscription</div>
                            <div style="font-size: 20px; font-weight: 700; margin: 10px 0;">$24.99/mo</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule Purchase</div>
                        </div>`
                    },
                    {
                        label: '2. Schedule',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Schedule Recurring</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px;">
                                <div style="opacity: 0.7; font-size: 12px;">Frequency</div>
                                <div style="font-weight: 600;">Monthly</div>
                            </div>
                            <div style="background: rgba(147, 51, 234, 0.2); border: 2px solid rgba(147, 51, 234, 0.6); padding: 12px; border-radius: 10px;">
                                <div style="opacity: 0.7; font-size: 12px;">Next Charge</div>
                                <div style="font-weight: 600;">Nov 29, 2025</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Scheduled',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Subscription Active!</div>
                            <div style="opacity: 0.8;">$24.99 charged monthly</div>
                        </div>`
                    }
                ]
            },
            'add_to_calendar': {
                title: 'Add to Calendar',
                steps: [
                    {
                        label: '1. Event Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Field Trip - Oct 25th</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Science Museum Visit</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(0, 122, 255, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Add to Calendar</div>
                        </div>`
                    },
                    {
                        label: '2. Event Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Calendar Event</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px;">
                                <div style="font-weight: 600;">Field Trip</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-top: 4px;">October 25, 2025 at 9:00 AM</div>
                            </div>
                            <div style="background: rgba(0, 122, 255, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Add to Calendar
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Added',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Event Added!</div>
                            <div style="opacity: 0.8;">Reminder set for 1 day before</div>
                        </div>`
                    }
                ]
            },
            'pay_form_fee': {
                title: 'Pay Form Fee',
                steps: [
                    {
                        label: '1. Fee Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Field Trip Fee</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$15.00</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Per student</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Pay Now</div>
                        </div>`
                    },
                    {
                        label: '2. Payment',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pay Fee</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="opacity: 0.7; font-size: 12px;">Amount</div>
                                <div style="font-size: 28px; font-weight: 700; color: #FFD700;">$15.00</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Pay with Apple Pay
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Complete',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Payment Sent!</div>
                            <div style="opacity: 0.8;">$15.00 paid</div>
                        </div>`
                    }
                ]
            },
            'view_order': {
                title: 'View Order',
                steps: [
                    {
                        label: '1. Order Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Order #112-8493829</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">3 items</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(0, 122, 255, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Order Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Order Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px;">
                                <div style="font-weight: 600;">Order #112-8493829</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-top: 4px;">Placed: Oct 20, 2025</div>
                                <div style="font-size: 13px; opacity: 0.7;">Total: $89.97</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'view_invoice': {
                title: 'View Invoice',
                steps: [
                    {
                        label: '1. Invoice Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Invoice #INV-2025-1234</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$599.00</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due: Oct 30, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Invoice Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Invoice Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Invoice #</span>
                                    <span style="font-weight: 600;">INV-2025-1234</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Amount</span>
                                    <span style="font-weight: 600; color: #FFD700;">$599.00</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Due Date</span>
                                    <span style="font-weight: 600;">Oct 30, 2025</span>
                                </div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Pay Now
                            </div>
                        </div>`
                    }
                ]
            },
            'set_payment_reminder': {
                title: 'Set Payment Reminder',
                steps: [
                    {
                        label: '1. Invoice',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Invoice Due Oct 30</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$599.00</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Remind Me</div>
                        </div>`
                    },
                    {
                        label: '2. Set Reminder',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Payment Reminder</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px;">
                                <div style="opacity: 0.7; font-size: 12px;">Remind me</div>
                                <div style="font-weight: 600;">2 days before due date</div>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Set Reminder
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Reminder Set',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reminder Set!</div>
                            <div style="opacity: 0.8;">You'll be notified on Oct 28</div>
                        </div>`
                    }
                ]
            },
            'contact_support': {
                title: 'Contact Support',
                steps: [
                    {
                        label: '1. Support Request',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Need Help?</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Get support for your order</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Contact</div>
                        </div>`
                    },
                    {
                        label: '2. Send Message',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Contact Support</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 10px; text-align: center;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Message sent</div>
                                <div style="font-size: 13px; opacity: 0.7;">Expected response: 24 hours</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'add_to_wallet': {
                title: 'Add to Wallet',
                steps: [
                    {
                        label: '1. Boarding Pass',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Flight UA 1234</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">SFO  JFK</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(0, 122, 255, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Add to Wallet</div>
                        </div>`
                    },
                    {
                        label: '2. Pass Added',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Added to Wallet!</div>
                            <div style="opacity: 0.8;">Boarding pass ready</div>
                        </div>`
                    }
                ]
            },
            'quick_reply': {
                title: 'Quick Reply',
                steps: [
                    {
                        label: '1. Email Card',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Email Thread</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Reply requested</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reply</div>
                        </div>`
                    },
                    {
                        label: '2. Compose Reply',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Quick Reply</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px; min-height: 80px; color: rgba(255,255,255,0.5); font-style: italic;">
                                Type your reply...
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Send Reply
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Sent',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reply Sent!</div>
                            <div style="opacity: 0.8;">Message delivered</div>
                        </div>`
                    }
                ]
            },
            'confirm_appointment': {
                title: 'Confirm Appointment',
                steps: [
                    {
                        label: '1. Appointment Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Dr. Martinez</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Annual Physical  Oct 30, 2pm</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Confirm</div>
                        </div>`
                    },
                    {
                        label: '2. Confirmation',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm Appointment</div>
                            <div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Annual Physical</div>
                                <div style="font-size: 14px; opacity: 0.8; margin-bottom: 4px;">Dr. Martinez</div>
                                <div style="font-size: 14px; opacity: 0.8;">Oct 30, 2025 at 2:00 PM</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 14px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Confirm Appointment
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Confirmed',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Appointment Confirmed!</div>
                            <div style="opacity: 0.8;">Calendar updated</div>
                        </div>`
                    }
                ]
            },
            'reply_to_thread': {
                title: 'Reply to Thread',
                steps: [
                    {
                        label: '1. Thread Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Re: Project Update</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">3 messages in thread</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reply</div>
                        </div>`
                    },
                    {
                        label: '2. Compose Reply',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Reply to Thread</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px; min-height: 80px; color: rgba(255,255,255,0.5); font-style: italic;">
                                Type your reply...
                            </div>
                            <div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Send to Thread
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Sent',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reply Sent!</div>
                            <div style="opacity: 0.8;">Added to thread</div>
                        </div>`
                    }
                ]
            },
            'save_for_later': {
                title: 'Save for Later',
                steps: [
                    {
                        label: '1. Email Card',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Important Email</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Save to review later</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Save</div>
                        </div>`
                    },
                    {
                        label: '2. Saved',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Saved!</div>
                            <div style="opacity: 0.8;">Moved to Saved folder</div>
                        </div>`
                    }
                ]
            },
            'view_details': {
                title: 'View Details',
                steps: [
                    {
                        label: '1. Email Card',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Email Summary</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Tap to view full details</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Full Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Full Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Email Content</div>
                                <div style="font-size: 14px; opacity: 0.8; line-height: 1.5;">Full email body with all details, attachments, and metadata displayed here.</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'copy_promo_code': {
                title: 'Copy Promo Code',
                steps: [
                    {
                        label: '1. Promo Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Special Offer!</div>
                            <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin: 10px 0;">SAVE25</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">25% off your order</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Copy Code</div>
                        </div>`
                    },
                    {
                        label: '2. Copied',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Code Copied!</div>
                            <div style="opacity: 0.8;">SAVE25 copied to clipboard</div>
                        </div>`
                    }
                ]
            },
            'cancel_subscription': {
                title: 'Cancel Subscription',
                steps: [
                    {
                        label: '1. Subscription Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Premium Subscription</div>
                            <div style="font-size: 20px; font-weight: 700; margin: 10px 0;">$9.99/mo</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 59, 48, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Cancel</div>
                        </div>`
                    },
                    {
                        label: '2. Confirm Cancel',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Cancel Subscription</div>
                            <div style="background: rgba(255, 59, 48, 0.15); border: 2px solid rgba(255, 59, 48, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Are you sure?</div>
                                <div style="font-size: 14px; opacity: 0.8;">Your subscription will end on the current billing date</div>
                            </div>
                            <div style="background: rgba(255, 59, 48, 0.3); padding: 14px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Confirm Cancellation
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Cancelled',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Subscription Cancelled</div>
                            <div style="opacity: 0.8;">No future charges</div>
                        </div>`
                    }
                ]
            },
            'rsvp_yes': {
                title: 'Accept Invitation',
                steps: [
                    {
                        label: '1. Invitation',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Event Invitation</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 15, 2025 at 6:00 PM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Accept</div>
                        </div>`
                    },
                    {
                        label: '2. Accepted',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">RSVP Sent!</div>
                            <div style="opacity: 0.8;">Event added to calendar</div>
                        </div>`
                    }
                ]
            },
            'rsvp_no': {
                title: 'Decline Invitation',
                steps: [
                    {
                        label: '1. Invitation',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Event Invitation</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 15, 2025 at 6:00 PM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 59, 48, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Decline</div>
                        </div>`
                    },
                    {
                        label: '2. Declined',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">RSVP Sent</div>
                            <div style="opacity: 0.8;">Organizer notified</div>
                        </div>`
                    }
                ]
            },
            'file_insurance_claim': {
                title: 'File Insurance Claim',
                steps: [
                    {
                        label: '1. Medical Bill',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Medical Bill</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$450.00</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Submit to insurance</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(0, 122, 255, 0.3); border-radius: 10px; font-size: 13px;"><span></span> File Claim</div>
                        </div>`
                    },
                    {
                        label: '2. Review Claim',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Insurance Claim</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="opacity: 0.7; font-size: 12px;">Claim Amount</div>
                                <div style="font-size: 28px; font-weight: 700; color: #FFD700;">$450.00</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-top: 8px;">Provider: Dr. Martinez</div>
                            </div>
                            <div style="background: rgba(0, 122, 255, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Submit Claim
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Submitted',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Claim Submitted!</div>
                            <div style="opacity: 0.8;">Processing in 7-10 days</div>
                        </div>`
                    }
                ]
            },
            'view_pickup_details': {
                title: 'View Pickup Details',
                steps: [
                    {
                        label: '1. Prescription Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Prescription Ready</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">CVS Pharmacy</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Pickup Info',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pickup Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">CVS Pharmacy</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">123 Main St</div>
                                <div style="font-size: 13px; opacity: 0.7;">Ready for pickup</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'pickup_prescription': {
                title: 'Pickup Prescription',
                steps: [
                    {
                        label: '1. Prescription Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Prescription Ready</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">CVS Pharmacy</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Pickup</div>
                        </div>`
                    },
                    {
                        label: '2. Pickup Confirmed',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Ready for Pickup!</div>
                            <div style="opacity: 0.8;">Directions added to Maps</div>
                        </div>`
                    }
                ]
            },
            'view_practice_details': {
                title: 'View Practice Details',
                steps: [
                    {
                        label: '1. Practice Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Soccer Practice</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Saturday 10:00 AM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Practice Info',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Practice Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Soccer Practice</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Saturday, 10:00 AM</div>
                                <div style="font-size: 13px; opacity: 0.7;">Central Park Field 3</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'accept_school_event': {
                title: 'Accept School Event',
                steps: [
                    {
                        label: '1. Event Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Parent-Teacher Conference</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 20, 2025 at 3:00 PM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Accept</div>
                        </div>`
                    },
                    {
                        label: '2. Add to Calendar',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Accept Event</div>
                            <div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Parent-Teacher Conference</div>
                                <div style="font-size: 14px; opacity: 0.8;">Nov 20, 2025 at 3:00 PM</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 14px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Accept & Add to Calendar
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Accepted',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Event Accepted!</div>
                            <div style="opacity: 0.8;">Added to your calendar</div>
                        </div>`
                    }
                ]
            },
            'view_team_announcement': {
                title: 'View Team Announcement',
                steps: [
                    {
                        label: '1. Announcement Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Team Announcement</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Important update from coach</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Announcement',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Team Announcement</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Game Schedule Update</div>
                                <div style="font-size: 14px; opacity: 0.8; line-height: 1.5;">Saturday's game has been rescheduled to 2:00 PM due to field availability.</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'write_review': {
                title: 'Write Review',
                steps: [
                    {
                        label: '1. Review Request',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">How was your order?</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Share your feedback</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 204, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Write Review</div>
                        </div>`
                    },
                    {
                        label: '2. Rating & Review',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Write Review</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="display: flex; gap: 8px; margin-bottom: 12px; justify-content: center;">
                                    <span style="font-size: 28px;"></span>
                                    <span style="font-size: 28px;"></span>
                                    <span style="font-size: 28px;"></span>
                                    <span style="font-size: 28px;"></span>
                                    <span style="font-size: 28px;"></span>
                                </div>
                                <div style="min-height: 60px; color: rgba(255,255,255,0.5); font-style: italic; text-align: center;">
                                    Write your review...
                                </div>
                            </div>
                            <div style="background: rgba(255, 204, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Submit Review
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Submitted',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Review Submitted!</div>
                            <div style="opacity: 0.8;">Thank you for your feedback</div>
                        </div>`
                    }
                ]
            },
            'rate_product': {
                title: 'Rate Product',
                steps: [
                    {
                        label: '1. Rating Request',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Rate your purchase</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Quick star rating</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 204, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Rate</div>
                        </div>`
                    },
                    {
                        label: '2. Star Rating',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Rate Product</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 24px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="display: flex; gap: 12px; justify-content: center;">
                                    <span style="font-size: 36px;"></span>
                                    <span style="font-size: 36px;"></span>
                                    <span style="font-size: 36px;"></span>
                                    <span style="font-size: 36px;"></span>
                                    <span style="font-size: 36px;"></span>
                                </div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Rated',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Rating Submitted!</div>
                            <div style="opacity: 0.8;">5 stars</div>
                        </div>`
                    }
                ]
            },
            'set_reminder': {
                title: 'Set Reminder',
                steps: [
                    {
                        label: '1. Sale Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Flash Sale Tomorrow</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 1, 2025 at 9:00 AM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Remind Me</div>
                        </div>`
                    },
                    {
                        label: '2. Reminder Set',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reminder Set!</div>
                            <div style="opacity: 0.8;">You'll be notified tomorrow at 9:00 AM</div>
                        </div>`
                    }
                ]
            },
            'set_price_alert': {
                title: 'Set Price Alert',
                steps: [
                    {
                        label: '1. Product Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Product Price Tracker</div>
                            <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin: 10px 0;">$99.99</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Set Alert</div>
                        </div>`
                    },
                    {
                        label: '2. Alert Set',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Price Alert Set!</div>
                            <div style="opacity: 0.8;">Product saved for monitoring (coming soon)</div>
                        </div>`
                    }
                ]
            },
            'notify_restock': {
                title: 'Restock Notification',
                steps: [
                    {
                        label: '1. Out of Stock',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Item Currently Unavailable</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Get notified when back in stock</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(0, 122, 255, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Notify Me</div>
                        </div>`
                    },
                    {
                        label: '2. Notification Set',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Notification Set!</div>
                            <div style="opacity: 0.8;">We'll email you when restocked</div>
                        </div>`
                    }
                ]
            },
            'reply_to_ticket': {
                title: 'Reply to Ticket',
                steps: [
                    {
                        label: '1. Support Ticket',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Support Ticket #12345</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Reply from support team</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reply</div>
                        </div>`
                    },
                    {
                        label: '2. Compose Reply',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Reply to Ticket</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px; min-height: 80px; color: rgba(255,255,255,0.5); font-style: italic;">
                                Type your reply...
                            </div>
                            <div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Send Reply
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Sent',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reply Sent!</div>
                            <div style="opacity: 0.8;">Ticket updated</div>
                        </div>`
                    }
                ]
            },
            'contact_driver': {
                title: 'Contact Driver',
                steps: [
                    {
                        label: '1. Delivery Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Out for Delivery</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Contact your driver</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Contact</div>
                        </div>`
                    },
                    {
                        label: '2. Driver Info',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Contact Driver</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Driver: John</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">ETA: 10 minutes</div>
                            </div>
                            <div style="display: flex; gap: 12px;">
                                <div style="flex: 1; background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                     Call
                                </div>
                                <div style="flex: 1; background: rgba(0, 122, 255, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                     Message
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'view_introduction': {
                title: 'View Introduction',
                steps: [
                    {
                        label: '1. Intro Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Introduction</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Someone wants to connect</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Introduction',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Introduction</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Sarah Johnson</div>
                                <div style="font-size: 14px; opacity: 0.8; line-height: 1.5;">Would like to connect with you regarding a potential collaboration opportunity.</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'schedule_payment': {
                title: 'Schedule Payment',
                steps: [
                    {
                        label: '1. Bill Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Monthly Bill</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$125.00</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due Nov 15, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div>
                        </div>`
                    },
                    {
                        label: '2. Set Date',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Schedule Payment</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="opacity: 0.7; font-size: 12px;">Amount</div>
                                <div style="font-size: 28px; font-weight: 700; color: #FFD700; margin-bottom: 12px;">$125.00</div>
                                <div style="opacity: 0.7; font-size: 12px;">Payment Date</div>
                                <div style="font-weight: 600;">Nov 15, 2025</div>
                            </div>
                            <div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Schedule Automatic Payment
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Scheduled',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Payment Scheduled!</div>
                            <div style="opacity: 0.8;">Auto-pay on Nov 15, 2025</div>
                        </div>`
                    }
                ]
            },
            'view_benefits': {
                title: 'View Benefits',
                steps: [
                    {
                        label: '1. Subscription Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Subscription Benefits</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">See what's included</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Benefits List',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Your Benefits</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="margin-bottom: 12px;">
                                    <div style="font-weight: 600; margin-bottom: 4px;"> Free Shipping</div>
                                    <div style="font-size: 13px; opacity: 0.7;">On all orders</div>
                                </div>
                                <div style="margin-bottom: 12px;">
                                    <div style="font-weight: 600; margin-bottom: 4px;"> Early Access</div>
                                    <div style="font-size: 13px; opacity: 0.7;">To new products</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;"> 20% Discount</div>
                                    <div style="font-size: 13px; opacity: 0.7;">On all purchases</div>
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'view_onboarding_info': {
                title: 'View Onboarding Info',
                steps: [
                    {
                        label: '1. Onboarding Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Welcome to the Team!</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Your first day info</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Onboarding Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Onboarding Information</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">First Day: Nov 1, 2025</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Location: Building A, Floor 3</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Time: 9:00 AM</div>
                                <div style="font-size: 13px; opacity: 0.7;">Manager: Sarah Johnson</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'view_mortgage_details': {
                title: 'View Mortgage Details',
                steps: [
                    {
                        label: '1. Mortgage Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Refinancing Offer</div>
                            <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin: 10px 0;">3.25% APR</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">See if you qualify</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Mortgage Info',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Mortgage Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Interest Rate</span>
                                    <span style="font-weight: 600; color: #FFD700;">3.25% APR</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Estimated Payment</span>
                                    <span style="font-weight: 600;">$1,850/mo</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Loan Term</span>
                                    <span style="font-weight: 600;">30 years</span>
                                </div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                Check Eligibility
                            </div>
                        </div>`
                    }
                ]
            },
            'view_legal_document': {
                title: 'View Legal Document',
                steps: [
                    {
                        label: '1. Document Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Legal Document Received</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Terms of Service Update</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Document Preview',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Legal Document</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Terms of Service Update</div>
                                <div style="font-size: 14px; opacity: 0.8; line-height: 1.5; margin-bottom: 12px;">We've updated our terms to better serve you...</div>
                                <div style="font-size: 12px; opacity: 0.6;">Last updated: Oct 31, 2025</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'view_newsletter_summary': {
                title: 'Newsletter Summary',
                steps: [
                    {
                        label: '1. Newsletter Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Weekly Newsletter</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">AI-generated summary</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View Summary</div>
                        </div>`
                    },
                    {
                        label: '2. AI Summary',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Newsletter Summary</div>
                            <div style="background: rgba(147, 51, 234, 0.15); border: 2px solid rgba(147, 51, 234, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                                    <span></span>
                                    <div style="font-weight: 600; font-size: 12px; text-transform: uppercase; opacity: 0.8;">AI Summary</div>
                                </div>
                                <div style="font-size: 14px; opacity: 0.9; line-height: 1.5;">
                                     Top story: New product launch announced<br>
                                     Industry update: Market trends analysis<br>
                                     Expert tip: Best practices for growth
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'buy_again': {
                title: 'Buy Again',
                steps: [
                    {
                        label: '1. Order Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Recent Order</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Loved it? Order again!</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Buy Again</div>
                        </div>`
                    },
                    {
                        label: '2. Add to Cart',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Reorder Items</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">Previous Order #12345</div>
                                <div style="font-size: 13px; opacity: 0.7;">3 items</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Add to Cart
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Order Placed',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Order Placed!</div>
                            <div style="opacity: 0.8;">Items added to cart</div>
                        </div>`
                    }
                ]
            },
            'reorder_item': {
                title: 'Reorder Item',
                steps: [
                    {
                        label: '1. Restock Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Back in Stock!</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Your favorite item is available</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reorder</div>
                        </div>`
                    },
                    {
                        label: '2. Confirm Order',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm Reorder</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">Product Name</div>
                                <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin: 8px 0;">$29.99</div>
                                <div style="font-size: 13px; opacity: 0.7;">Qty: 1</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Confirm Reorder
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Ordered',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reorder Complete!</div>
                            <div style="opacity: 0.8;">Item ordered successfully</div>
                        </div>`
                    }
                ]
            },
            'return_item': {
                title: 'Return Item',
                steps: [
                    {
                        label: '1. Order Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Order</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Need to return something?</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Return</div>
                        </div>`
                    },
                    {
                        label: '2. Select Reason',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Return Reason</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);">
                                <div style="font-weight: 600;">Wrong size</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div>Changed my mind</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div>Damaged/Defective</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Print Label',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Return Label</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Return label generated</div>
                                <div style="font-size: 13px; opacity: 0.7;">Tracking: 1Z999AA10123456784</div>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Print Label
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Return Initiated',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Return Initiated!</div>
                            <div style="opacity: 0.8;">Ship within 30 days</div>
                        </div>`
                    }
                ]
            },
            'complete_cart': {
                title: 'Complete Cart',
                steps: [
                    {
                        label: '1. Cart Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Items in Your Cart</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Complete your purchase</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Checkout</div>
                        </div>`
                    },
                    {
                        label: '2. Review Cart',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Review Order</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="margin-bottom: 8px;">
                                    <div style="font-weight: 600;">Subtotal</div>
                                    <div style="font-size: 20px; color: #FFD700;">$125.00</div>
                                </div>
                                <div style="font-size: 13px; opacity: 0.7;">3 items in cart</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Proceed to Checkout
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Order Complete',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Order Complete!</div>
                            <div style="opacity: 0.8;">Confirmation sent to email</div>
                        </div>`
                    }
                ]
            },
            'claim_deal': {
                title: 'Claim Deal (Shopping Automation)',
                steps: [
                    {
                        label: '1. Product Deal Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px; opacity: 0.7;">Amazon</div>
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">AirPods Pro (2nd Gen)</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$199 <span style="font-size: 14px; opacity: 0.7; text-decoration: line-through;">$249</span></div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Save $50  Limited time</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 215, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Claim Deal</div>
                        </div>`
                    },
                    {
                        label: '2. Platform Detection',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Detecting Platform...</div>
                            <div style="background: rgba(255, 153, 0, 0.15); border: 2px solid rgba(255, 153, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px; text-align: center;">
                                <div style="font-size: 40px; margin-bottom: 8px;"></div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Amazon Detected</div>
                                <div style="font-size: 13px; opacity: 0.8;">Preparing automation...</div>
                            </div>
                            <div style="font-size: 11px; opacity: 0.6; text-align: center;">Powered by Steel.dev</div>
                        </div>`
                    },
                    {
                        label: '3. Adding to Cart',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Adding to Cart...</div>
                            <div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">AirPods Pro (2nd Generation)</div>
                                <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Finding "Add to Cart" button...</div>
                                <div style="display: flex; gap: 4px; align-items: center;">
                                    <div style="width: 60%; height: 4px; background: rgba(100, 149, 237, 0.5); border-radius: 2px; overflow: hidden;">
                                        <div style="width: 70%; height: 100%; background: #6495ED;"></div>
                                    </div>
                                    <div style="font-size: 12px; opacity: 0.7;">70%</div>
                                </div>
                            </div>
                            <div style="font-size: 11px; opacity: 0.6; text-align: center;">Powered by Steel.dev</div>
                        </div>`
                    },
                    {
                        label: '4. Navigating to Checkout',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Item Added!</div>
                            <div style="background: rgba(34, 197, 94, 0.15); border: 2px solid rgba(34, 197, 94, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">AirPods Pro added to cart</div>
                                <div style="font-size: 13px; opacity: 0.8;">Opening checkout page...</div>
                            </div>
                            <div style="background: rgba(34, 197, 94, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Open Checkout
                            </div>
                            <div style="font-size: 11px; opacity: 0.6; text-align: center; margin-top: 8px;">Powered by Steel.dev</div>
                        </div>`
                    },
                    {
                        label: '5. Success',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Ready to Checkout!</div>
                            <div style="opacity: 0.8; margin-bottom: 4px;">AirPods Pro in your Amazon cart</div>
                            <div style="font-size: 11px; opacity: 0.5;">amazon.com/cart</div>
                        </div>`
                    }
                ]
            },
            'view_product': {
                title: 'View Product',
                steps: [
                    {
                        label: '1. Product Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">New Arrival</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Check out this product</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Product Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Product Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Premium Wireless Headphones</div>
                                <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 8px 0;">$199.99</div>
                                <div style="font-size: 13px; opacity: 0.7;"> 4.8/5 (2,341 reviews)</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'redeem_rewards': {
                title: 'Redeem Rewards',
                steps: [
                    {
                        label: '1. Rewards Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Rewards Available</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">5,000 points</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Ready to redeem</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 215, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Redeem</div>
                        </div>`
                    },
                    {
                        label: '2. Select Reward',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Choose Reward</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 215, 0, 0.4);">
                                <div style="font-weight: 600;">$50 Gift Card</div>
                                <div style="font-size: 12px; opacity: 0.7;">5,000 points</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">$25 Gift Card</div>
                                <div style="font-size: 12px; opacity: 0.7;">2,500 points</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Confirm Redemption',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div>
                            <div style="background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">$50 Gift Card</div>
                                <div style="font-size: 13px; opacity: 0.8;">Cost: 5,000 points</div>
                            </div>
                            <div style="background: rgba(255, 215, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Redeem Reward
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Redeemed',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Redeemed!</div>
                            <div style="opacity: 0.8;">Gift card sent to email</div>
                        </div>`
                    }
                ]
            },
            'view_announcement': {
                title: 'View Announcement',
                steps: [
                    {
                        label: '1. Announcement Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Important Update</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">New features available</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Read</div>
                        </div>`
                    },
                    {
                        label: '2. Announcement Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Brand Update</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">What's New</div>
                                <div style="font-size: 14px; opacity: 0.9; line-height: 1.5;">
                                     New product features<br>
                                     Improved performance<br>
                                     Enhanced user experience
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'track_delivery': {
                title: 'Track Delivery',
                steps: [
                    {
                        label: '1. Delivery Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Out for Delivery</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Arriving today</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Track</div>
                        </div>`
                    },
                    {
                        label: '2. Live Tracking',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Live Tracking</div>
                            <div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Driver is 5 min away</div>
                                <div style="font-size: 13px; opacity: 0.8;">Order #12345</div>
                            </div>
                            <div style="text-align: center; opacity: 0.7; font-size: 12px;"> Map view</div>
                        </div>`
                    },
                    {
                        label: '3. Delivery Status',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Arriving Soon!</div>
                            <div style="opacity: 0.8;">ETA: 3:45 PM</div>
                        </div>`
                    }
                ]
            },
            'track_return': {
                title: 'Track Return',
                steps: [
                    {
                        label: '1. Return Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Return Shipped</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Track your return</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Track</div>
                        </div>`
                    },
                    {
                        label: '2. Return Status',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Return Status</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">In Transit</div>
                                <div style="font-size: 13px; opacity: 0.7;">Tracking: 1Z999AA10123456784</div>
                                <div style="font-size: 13px; opacity: 0.7;">Expected: Nov 5, 2025</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Refund Timeline',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Refund Info</div>
                            <div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">Refund Amount: $49.99</div>
                                <div style="font-size: 13px; opacity: 0.8;">Processing 3-5 business days after receipt</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'print_return_label': {
                title: 'Print Return Label',
                steps: [
                    {
                        label: '1. Return Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Return Approved</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Print your label</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Print</div>
                        </div>`
                    },
                    {
                        label: '2. Generate Label',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Shipping Label</div>
                            <div style="background: rgba(255,255,255,0.95); padding: 16px; border-radius: 10px; margin-bottom: 12px; color: #000;">
                                <div style="font-weight: 600; margin-bottom: 4px;">USPS Priority Mail</div>
                                <div style="font-size: 11px; opacity: 0.7;">1Z999AA10123456784</div>
                                <div style="border: 1px dashed #ccc; padding: 8px; margin-top: 8px; font-size: 10px;">
                                    [Barcode]
                                </div>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Print Label
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Ready to Ship',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Label Ready!</div>
                            <div style="opacity: 0.8;">Attach to package</div>
                        </div>`
                    }
                ]
            },
            'view_warranty': {
                title: 'View Warranty',
                steps: [
                    {
                        label: '1. Product Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Warranty Information</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Check coverage</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Warranty Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Warranty Coverage</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">2-Year Limited Warranty</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Expires: Nov 1, 2026</div>
                                <div style="font-size: 13px; opacity: 0.7;">Coverage: Parts & Labor</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'download_receipt': {
                title: 'Download Receipt',
                steps: [
                    {
                        label: '1. Payment Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Payment Received</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Download your receipt</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Download</div>
                        </div>`
                    },
                    {
                        label: '2. Receipt Preview',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Receipt</div>
                            <div style="background: rgba(255,255,255,0.95); padding: 16px; border-radius: 10px; margin-bottom: 12px; color: #000;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Receipt #R-2025-001</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Date: Nov 1, 2025</div>
                                <div style="font-size: 20px; font-weight: 700; color: #0066CC; margin-top: 8px;">$599.00</div>
                            </div>
                            <div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Download PDF
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Downloaded',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Downloaded!</div>
                            <div style="opacity: 0.8;">Receipt saved</div>
                        </div>`
                    }
                ]
            },
            'view_statement': {
                title: 'View Statement',
                steps: [
                    {
                        label: '1. Statement Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Monthly Statement</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">October 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Statement Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Account Statement</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="margin-bottom: 12px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Previous Balance</div>
                                    <div style="font-weight: 600;">$1,234.56</div>
                                </div>
                                <div style="margin-bottom: 12px;">
                                    <div style="font-size: 12px; opacity: 0.7;">New Charges</div>
                                    <div style="font-weight: 600;">$567.89</div>
                                </div>
                                <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 12px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Current Balance</div>
                                    <div style="font-size: 24px; font-weight: 700; color: #FFD700;">$1,802.45</div>
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'update_payment': {
                title: 'Update Payment',
                steps: [
                    {
                        label: '1. Payment Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Update Payment Method</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Card ending in 1234 expires soon</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Update</div>
                        </div>`
                    },
                    {
                        label: '2. Select Method',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Payment Method</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(100, 149, 237, 0.4);">
                                <div style="font-weight: 600;"> Credit Card</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;"> Bank Account</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;"> Apple Pay</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Enter Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Card Details</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-size: 12px; opacity: 0.7; margin-bottom: 4px;">Card Number</div>
                                <div>   5678</div>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px;">
                                <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Expiry</div>
                                    <div>12/27</div>
                                </div>
                                <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px;">
                                    <div style="font-size: 12px; opacity: 0.7;">CVV</div>
                                    <div></div>
                                </div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Save Card
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Updated',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Payment Updated!</div>
                            <div style="opacity: 0.8;">Card saved successfully</div>
                        </div>`
                    }
                ]
            },
            'update_payment_method': {
                title: 'Update Payment Method',
                steps: [
                    {
                        label: '1. Account Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Payment Method Expiring</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Update to continue service</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Update</div>
                        </div>`
                    },
                    {
                        label: '2. Choose Method',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Choose Payment</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(52, 199, 89, 0.4);">
                                <div style="font-weight: 600;"> Apple Pay</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;"> New Card</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Confirm',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm Change</div>
                            <div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">New Default Payment</div>
                                <div style="font-size: 13px; opacity: 0.8;"> Apple Pay</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Confirm
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Updated',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Method Updated!</div>
                            <div style="opacity: 0.8;">Default payment changed</div>
                        </div>`
                    }
                ]
            },
            'dispute_transaction': {
                title: 'Dispute Transaction',
                steps: [
                    {
                        label: '1. Transaction Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Unrecognized Transaction</div>
                            <div style="font-size: 20px; font-weight: 700; color: #FF3B30; margin: 10px 0;">$234.56</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 1, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 59, 48, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Dispute</div>
                        </div>`
                    },
                    {
                        label: '2. Select Reason',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Dispute Reason</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 59, 48, 0.4);">
                                <div style="font-weight: 600;">Fraudulent Charge</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Not Received</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Wrong Amount</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Submit Evidence',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Additional Info</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-size: 12px; opacity: 0.7; margin-bottom: 8px;">Description (optional)</div>
                                <div style="font-size: 14px;">I did not authorize this transaction...</div>
                            </div>
                            <div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Submit Dispute
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Filed',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Dispute Filed!</div>
                            <div style="opacity: 0.8;">Review in 5-7 days</div>
                        </div>`
                    }
                ]
            },
            'view_credit_report': {
                title: 'View Credit Report',
                steps: [
                    {
                        label: '1. Report Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Credit Report Available</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Check your score</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Verify Identity',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Verify Identity</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-size: 12px; opacity: 0.7; margin-bottom: 8px;">Last 4 of SSN</div>
                                <div> 1234</div>
                            </div>
                            <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Verify
                            </div>
                        </div>`
                    },
                    {
                        label: '3. View Report',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Credit Score</div>
                            <div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px; text-align: center;">
                                <div style="font-size: 48px; font-weight: 700; color: #34C759; margin-bottom: 8px;">750</div>
                                <div style="font-size: 14px; opacity: 0.8;">Good Credit</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'view_portfolio': {
                title: 'View Portfolio',
                steps: [
                    {
                        label: '1. Portfolio Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Portfolio Update</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">October 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Portfolio Dashboard',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Portfolio</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="margin-bottom: 12px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Total Value</div>
                                    <div style="font-size: 28px; font-weight: 700; color: #FFD700;">$52,341.89</div>
                                </div>
                                <div style="font-size: 13px; opacity: 0.7; color: #34C759;">
                                     +$2,450.32 (4.9%)
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'verify_transaction': {
                title: 'Verify Transaction',
                steps: [
                    {
                        label: '1. Transaction Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Verify This Purchase?</div>
                            <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin: 10px 0;">$123.45</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 1, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Verify</div>
                        </div>`
                    },
                    {
                        label: '2. Confirm/Deny',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Was This You?</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">Amazon.com</div>
                                <div style="font-size: 20px; color: #FFD700; margin: 8px 0;">$123.45</div>
                                <div style="font-size: 13px; opacity: 0.7;">Nov 1, 2025 3:42 PM</div>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                <div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                     Yes, It's Me
                                </div>
                                <div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                     Not Me
                                </div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Verified',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Transaction Verified!</div>
                            <div style="opacity: 0.8;">Thank you for confirming</div>
                        </div>`
                    }
                ]
            },
            'view_refund_status': {
                title: 'View Refund',
                steps: [
                    {
                        label: '1. Refund Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Refund Processing</div>
                            <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin: 10px 0;">$49.99</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Track status</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Refund Timeline',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Refund Status</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 12px;">Processing</div>
                                <div style="font-size: 20px; font-weight: 700; color: #FFD700; margin-bottom: 8px;">$49.99</div>
                                <div style="font-size: 13px; opacity: 0.7;">Expected: 3-5 business days</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'pay_property_tax': {
                title: 'Pay Property Tax',
                steps: [
                    {
                        label: '1. Tax Bill Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Property Tax Due</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$2,450.00</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due: Dec 31, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Pay</div>
                        </div>`
                    },
                    {
                        label: '2. Review Amount',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Tax Payment</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">123 Main St, Anytown, CA</div>
                                <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 8px 0;">$2,450.00</div>
                                <div style="font-size: 13px; opacity: 0.7;">Tax Year: 2025</div>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Pay Now
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Payment Processing',
                        html: `<div class="modal-preview-card" style="background: rgba(59, 130, 246, 0.15); border-color: rgba(59, 130, 246, 0.4);">
                            <div style="width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.2); border-top-color: #3B82F6; border-radius: 50%; margin: 0 auto 16px; animation: spin 1s linear infinite;"></div>
                            <div style="text-align: center; font-weight: 600;">Processing Payment...</div>
                        </div>`
                    },
                    {
                        label: '4. Receipt',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Payment Complete!</div>
                            <div style="opacity: 0.8;">Receipt sent to email</div>
                        </div>`
                    }
                ]
            },
            'pay_utility_bill': {
                title: 'Pay Utility Bill',
                steps: [
                    {
                        label: '1. Bill Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Utility Bill Due</div>
                            <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 10px 0;">$145.67</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due: Nov 15, 2025</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Pay</div>
                        </div>`
                    },
                    {
                        label: '2. Confirm Amount',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pay Bill</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Electric Service</div>
                                <div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 8px 0;">$145.67</div>
                                <div style="font-size: 13px; opacity: 0.7;">Account: ****5678</div>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Pay with Apple Pay
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Processing',
                        html: `<div class="modal-preview-card" style="background: rgba(59, 130, 246, 0.15); border-color: rgba(59, 130, 246, 0.4);">
                            <div style="width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.2); border-top-color: #3B82F6; border-radius: 50%; margin: 0 auto 16px; animation: spin 1s linear infinite;"></div>
                            <div style="text-align: center; font-weight: 600;">Processing Payment...</div>
                        </div>`
                    },
                    {
                        label: '4. Paid',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Bill Paid!</div>
                            <div style="opacity: 0.8;">Confirmation sent</div>
                        </div>`
                    }
                ]
            },
            'download_tax_document': {
                title: 'Download Tax Form',
                steps: [
                    {
                        label: '1. Tax Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Tax Documents Available</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">2024 Forms Ready</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Download</div>
                        </div>`
                    },
                    {
                        label: '2. Select Form',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Tax Documents</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(100, 149, 237, 0.4);">
                                <div style="font-weight: 600;">Form 1099-INT</div>
                                <div style="font-size: 12px; opacity: 0.7;">Tax Year 2024</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Form 1099-DIV</div>
                                <div style="font-size: 12px; opacity: 0.7;">Tax Year 2024</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Downloaded',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Downloaded!</div>
                            <div style="opacity: 0.8;">Form 1099-INT.pdf</div>
                        </div>`
                    }
                ]
            },
            'manage_subscription': {
                title: 'Manage Subscription',
                steps: [
                    {
                        label: '1. Subscription Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Subscription</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Manage settings</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Manage</div>
                        </div>`
                    },
                    {
                        label: '2. Subscription Settings',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Subscription</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Premium Plan</div>
                                <div style="font-size: 20px; color: #FFD700; margin: 8px 0;">$9.99/mo</div>
                                <div style="font-size: 13px; opacity: 0.7;">Renews Dec 1, 2025</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Change Plan</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Update Payment</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Updated',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Settings Updated!</div>
                            <div style="opacity: 0.8;">Changes saved</div>
                        </div>`
                    }
                ]
            },
            'upgrade_subscription': {
                title: 'Upgrade Subscription',
                steps: [
                    {
                        label: '1. Upgrade Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Unlock Premium Features</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Upgrade today!</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 215, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Upgrade</div>
                        </div>`
                    },
                    {
                        label: '2. Select Plan',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Choose Plan</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Pro Plan</div>
                                <div style="font-size: 20px; color: #FFD700; margin: 8px 0;">$19.99/mo</div>
                            </div>
                            <div style="background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.4); padding: 16px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;">Premium Plan</div>
                                <div style="font-size: 20px; color: #FFD700; margin: 8px 0;">$29.99/mo</div>
                                <div style="font-size: 12px; opacity: 0.8;"> All features</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Payment',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm Upgrade</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">Premium Plan</div>
                                <div style="font-size: 24px; color: #FFD700; margin: 8px 0;">$29.99/mo</div>
                                <div style="font-size: 13px; opacity: 0.7;">Billed monthly</div>
                            </div>
                            <div style="background: rgba(255, 215, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Upgrade Now
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Upgraded',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Upgraded!</div>
                            <div style="opacity: 0.8;">Welcome to Premium</div>
                        </div>`
                    }
                ]
            },
            'view_reservation': {
                title: 'View Reservation',
                steps: [
                    {
                        label: '1. Confirmation Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Reservation Confirmed</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 15, 2025 at 7:00 PM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Reservation Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Your Reservation</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">The Italian Kitchen</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> Nov 15, 2025 at 7:00 PM</div>
                                <div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> Party of 4</div>
                                <div style="font-size: 13px; opacity: 0.7;">Conf: #R-12345</div>
                            </div>
                        </div>`
                    }
                ]
            },
            'modify_reservation': {
                title: 'Modify Reservation',
                steps: [
                    {
                        label: '1. Confirmation Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Reservation</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 15, 2025 at 7:00 PM</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Modify</div>
                        </div>`
                    },
                    {
                        label: '2. Change Details',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Modify Reservation</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-size: 12px; opacity: 0.7;">Date & Time</div>
                                <div style="font-weight: 600;">Nov 15, 7:00 PM </div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-size: 12px; opacity: 0.7;">Party Size</div>
                                <div style="font-weight: 600;">4 guests </div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Confirm Changes',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div>
                            <div style="background: rgba(255, 149, 0, 0.15); border: 2px solid rgba(255, 149, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                <div style="font-weight: 600; margin-bottom: 4px;">New Time: Nov 16, 8:00 PM</div>
                                <div style="font-size: 13px; opacity: 0.8;">Party of 4</div>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">
                                 Confirm Changes
                            </div>
                        </div>`
                    },
                    {
                        label: '4. Updated',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reservation Updated!</div>
                            <div style="opacity: 0.8;">Confirmation sent</div>
                        </div>`
                    }
                ]
            },
            'view_itinerary': {
                title: 'View Itinerary',
                steps: [
                    {
                        label: '1. Travel Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Trip Itinerary</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Conf: ABC123</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div>
                        </div>`
                    },
                    {
                        label: '2. Full Itinerary',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Travel Itinerary</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;">
                                <div style="margin-bottom: 12px;">
                                    <div style="font-weight: 600;"> Outbound Flight</div>
                                    <div style="font-size: 13px; opacity: 0.7;">AA 1234  Nov 15, 9:00 AM</div>
                                </div>
                                <div style="margin-bottom: 12px;">
                                    <div style="font-weight: 600;"> Hotel Stay</div>
                                    <div style="font-size: 13px; opacity: 0.7;">Nov 15-18, 2025</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600;"> Return Flight</div>
                                    <div style="font-size: 13px; opacity: 0.7;">AA 5678  Nov 18, 6:00 PM</div>
                                </div>
                            </div>
                        </div>`
                    }
                ]
            },
            'manage_booking': {
                title: 'Manage Booking',
                steps: [
                    {
                        label: '1. Booking Email',
                        html: `<div class="modal-email-card">
                            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Booking</div>
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Conf: XYZ789</div>
                            <div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Manage</div>
                        </div>`
                    },
                    {
                        label: '2. Booking Options',
                        html: `<div class="modal-preview-card">
                            <div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Manage Booking</div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;"> Modify Reservation</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;"> Cancel Booking</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;">
                                <div style="font-weight: 600;"> Resend Confirmation</div>
                            </div>
                        </div>`
                    },
                    {
                        label: '3. Action Complete',
                        html: `<div class="modal-success-state">
                            <div class="modal-success-icon"></div>
                            <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Booking Updated!</div>
                            <div style="opacity: 0.8;">Changes saved</div>
                        </div>`
                    }
                ]
            },
            'view_assignment': {
                title: 'View Assignment',
                steps: [
                    { label: '1. Assignment Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">New Assignment Posted</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due Nov 20, 2025</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>` },
                    { label: '2. Assignment Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Assignment</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Math Chapter 5 Problems</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Due: Nov 20, 2025</div><div style="font-size: 13px; opacity: 0.7;">Points: 50</div></div></div>` }
                ]
            },
            'check_grade': {
                title: 'Check Grade',
                steps: [
                    { label: '1. Grade Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Grade Posted</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Math Test #3</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>` },
                    { label: '2. Grade Breakdown', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Your Grade</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; text-align: center;"><div style="font-size: 48px; font-weight: 700; color: #34C759;">92%</div><div style="font-size: 14px; opacity: 0.8;">Grade: A-</div></div></div>` }
                ]
            },
            'view_lms_message': {
                title: 'View Message',
                steps: [
                    { label: '1. Message Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">New Message from Teacher</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Ms. Johnson</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Read</div></div>` },
                    { label: '2. Message Thread', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Message</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">From: Ms. Johnson</div><div style="font-size: 14px; opacity: 0.9;">Please review Chapter 5 before tomorrow's class...</div></div></div>` }
                ]
            },
            'reply_to_teacher': {
                title: 'Reply to Teacher',
                steps: [
                    { label: '1. Message Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Message from Ms. Johnson</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Question about assignment</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reply</div></div>` },
                    { label: '2. Compose Reply', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Reply</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-size: 14px; opacity: 0.9;">Thank you for clarifying...</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Send Reply</div></div>` },
                    { label: '3. Sent', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reply Sent!</div><div style="opacity: 0.8;">Message delivered</div></div>` }
                ]
            },
            'submit_assignment': {
                title: 'Submit Assignment',
                steps: [
                    { label: '1. Assignment Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Assignment Due Soon</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due Nov 20, 2025</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Submit</div></div>` },
                    { label: '2. Upload File', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Submit Work</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-weight: 600; margin-bottom: 8px;">Math_Assignment.pdf</div><div style="font-size: 13px; opacity: 0.7;">2.3 MB</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Submit Assignment</div></div>` },
                    { label: '3. Review', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm Submission</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Math_Assignment.pdf</div><div style="font-size: 13px; opacity: 0.8;">Ready to submit</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm</div></div>` },
                    { label: '4. Submitted', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Submitted!</div><div style="opacity: 0.8;">Assignment received</div></div>` }
                ]
            },
            'rsvp_school_event': {
                title: 'RSVP School Event',
                steps: [
                    { label: '1. Event Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">School Play Invitation</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Dec 10, 2025 at 7:00 PM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> RSVP</div></div>` },
                    { label: '2. Confirm Attendance', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> RSVP</div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Attending</div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Not Attending</div></div></div>` },
                    { label: '3. Confirmed', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">RSVP Confirmed!</div><div style="opacity: 0.8;">See you there</div></div>` }
                ]
            },
            'view_game_schedule': {
                title: 'View Schedule',
                steps: [
                    { label: '1. Schedule Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Basketball Schedule</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Fall 2025 Season</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>` },
                    { label: '2. Game Calendar', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Season Schedule</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">vs. Eagles</div><div style="font-size: 13px; opacity: 0.7;">Nov 15 @ 6:00 PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">vs. Tigers</div><div style="font-size: 13px; opacity: 0.7;">Nov 22 @ 5:30 PM</div></div></div>` }
                ]
            },
            'rsvp_game': {
                title: 'RSVP Game',
                steps: [
                    { label: '1. Game Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Upcoming Soccer Game</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Saturday @ 10:00 AM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> RSVP</div></div>` },
                    { label: '2. Confirm Attendance', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Will You Attend?</div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Yes</div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> No</div></div></div>` },
                    { label: '3. Confirmed', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">RSVP Received!</div><div style="opacity: 0.8;">Coach notified</div></div>` }
                ]
            },        // Compound Action Flows (Multi-Step Wizards)
            'check_in_appointment': {title: 'Check In', steps: [{label: '1. Appointment Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Appointment Tomorrow</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">10:00 AM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Check In</div></div>`}, {label: '2. Confirm Info', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Check-In</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-weight: 600;">Dr. Smith</div><div style="font-size: 13px; opacity: 0.7;">Nov 15, 10:00 AM</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Check In Now</div></div>`}, {label: '3. Checked In', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Checked In!</div><div style="opacity: 0.8;">Please arrive 10 min early</div></div>`}]},
            'get_directions': {title: 'Get Directions', steps: [{label: '1. Appointment Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Dr. Smith Appointment</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">123 Medical Plaza</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Directions</div></div>`}, {label: '2. Opening Maps', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Directions</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px;"><div style="font-weight: 600; margin-bottom: 4px;">123 Medical Plaza</div><div style="font-size: 13px; opacity: 0.8;">Opening in Maps...</div></div></div>`}]},
            'view_results': {title: 'View Results', steps: [{label: '1. Results Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Lab Results Available</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Blood Test - Complete</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Verify Identity', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Secure Access</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-size: 12px; opacity: 0.7;">DOB</div><div>MM/DD/YYYY</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Verify</div></div>`}, {label: '3. View Results', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Lab Results</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Blood Test - Complete</div><div style="font-size: 13px; opacity: 0.7;">All values normal</div></div></div>`}]},
            'download_results': {title: 'Download Results', steps: [{label: '1. Results Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Lab Results Ready</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Download PDF</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Download</div></div>`}, {label: '2. PDF Preview', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Results PDF</div><div style="background: rgba(255,255,255,0.95); padding: 16px; border-radius: 10px; margin-bottom: 12px; color: #000;"><div style="font-weight: 600;">Lab_Results_11-01-2025.pdf</div><div style="font-size: 12px; opacity: 0.7;">854 KB</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Download</div></div>`}, {label: '3. Downloaded', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Downloaded!</div><div style="opacity: 0.8;">Results saved</div></div>`}]},
            'reschedule_appointment': {title: 'Reschedule', steps: [{label: '1. Appointment Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Appointment</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 15 @ 10:00 AM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reschedule</div></div>`}, {label: '2. Select Date', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> New Date</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);"><div style="font-weight: 600;">Nov 16 @ 2:00 PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Nov 17 @ 10:00 AM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(255, 149, 0, 0.15); border: 2px solid rgba(255, 149, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">New: Nov 16 @ 2:00 PM</div></div><div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm</div></div>`}, {label: '4. Rescheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Rescheduled!</div><div style="opacity: 0.8;">Confirmation sent</div></div>`}]},
            'view_referral': {title: 'View Referral', steps: [{label: '1. Referral Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Specialist Referral</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Dr. Johnson - Cardiology</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Referral Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Referral</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Dr. Sarah Johnson</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Cardiology</div><div style="font-size: 13px; opacity: 0.7;"> (555) 123-4567</div></div></div>`}]},
            'schedule_test': {title: 'Schedule Test', steps: [{label: '1. Test Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Lab Work Ordered</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Blood Test Required</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div></div>`}, {label: '2. Select Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Available Times</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(147, 51, 234, 0.4);"><div style="font-weight: 600;">Nov 15 @ 8:00 AM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Nov 16 @ 9:00 AM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(147, 51, 234, 0.15); border: 2px solid rgba(147, 51, 234, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Blood Test</div><div style="font-size: 13px; opacity: 0.8;">Nov 15 @ 8:00 AM</div></div><div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Schedule</div></div>`}, {label: '4. Scheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Test Scheduled!</div><div style="opacity: 0.8;">Reminder sent</div></div>`}]},
            'view_claim_status': {title: 'View Claim', steps: [{label: '1. Claim Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Insurance Claim Update</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Claim #C-12345</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Claim Tracker', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Claim Status</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Claim #C-12345</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Status: Under Review</div><div style="font-size: 13px; opacity: 0.7;">Est. Decision: 5-7 days</div></div></div>`}]},
            'schedule_interview': {title: 'Schedule Interview', steps: [{label: '1. Interview Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Interview Invitation</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Acme Corp - Software Engineer</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div></div>`}, {label: '2. Select Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Available Slots</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(52, 199, 89, 0.4);"><div style="font-weight: 600;">Nov 18 @ 2:00 PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Nov 19 @ 10:00 AM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Software Engineer Interview</div><div style="font-size: 13px; opacity: 0.8;">Nov 18 @ 2:00 PM</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Schedule Interview</div></div>`}, {label: '4. Scheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Interview Scheduled!</div><div style="opacity: 0.8;">Calendar invite sent</div></div>`}]},
            'accept_offer': {title: 'Accept Offer', steps: [{label: '1. Offer Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Job Offer</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Software Engineer @ Acme Corp</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 215, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Review</div></div>`}, {label: '2. Review Terms', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Job Offer</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-weight: 600; margin-bottom: 8px;">Software Engineer</div><div style="font-size: 20px; color: #FFD700; margin: 8px 0;">$120,000/year</div><div style="font-size: 13px; opacity: 0.7;">Start: Dec 1, 2025</div></div></div>`}, {label: '3. Accept', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Accept Offer</div><div style="background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Ready to accept?</div><div style="font-size: 13px; opacity: 0.8;">This action is binding</div></div><div style="background: rgba(255, 215, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Accept Offer</div></div>`}, {label: '4. Accepted', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Offer Accepted!</div><div style="opacity: 0.8;">Welcome aboard!</div></div>`}]},
            'view_job_details': {title: 'View Job Details', steps: [{label: '1. Job Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Job Opening</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Software Engineer</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Full Description', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Job Details</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Software Engineer</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> San Francisco, CA</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> $100k-150k</div><div style="font-size: 13px; opacity: 0.7;"> Full-time</div></div></div>`}]},
            'check_application_status': {title: 'Check Status', steps: [{label: '1. Application Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Application Update</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Software Engineer @ Acme</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Check</div></div>`}, {label: '2. Status Tracker', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Application Status</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Software Engineer</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Status: Under Review</div><div style="font-size: 13px; opacity: 0.7;">Applied: Oct 25, 2025</div></div></div>`}]},
            'schedule_meeting': {title: 'Schedule Meeting', steps: [{label: '1. Meeting Request', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Meeting Request</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Project Discussion</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div></div>`}, {label: '2. Select Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Available Times</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(100, 149, 237, 0.4);"><div style="font-weight: 600;">Nov 15 @ 2:00 PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Nov 16 @ 10:00 AM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Project Discussion</div><div style="font-size: 13px; opacity: 0.8;">Nov 15 @ 2:00 PM (30 min)</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Schedule</div></div>`}, {label: '4. Scheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Meeting Scheduled!</div><div style="opacity: 0.8;">Calendar invite sent</div></div>`}]},
            'register_to_vote': {title: 'Register to Vote', steps: [{label: '1. Registration Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Voter Registration</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Deadline: Nov 30, 2025</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Register</div></div>`}, {label: '2. Fill Form', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Registration</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Name</div><div>John Smith</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Address</div><div>123 Main St</div></div></div>`}, {label: '3. Verify', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Verify</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Review & Submit</div><div style="font-size: 13px; opacity: 0.8;">All information correct?</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Submit</div></div>`}, {label: '4. Registered', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Registered!</div><div style="opacity: 0.8;">Confirmation mailed</div></div>`}]},
            'renew_license': {title: 'Renew License', steps: [{label: '1. Renewal Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">License Expiring</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Expires: Dec 31, 2025</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Renew</div></div>`}, {label: '2. Upload Photo', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> New Photo</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-weight: 600; margin-bottom: 8px;"> Upload Photo</div><div style="font-size: 13px; opacity: 0.7;">Max 5MB, JPG/PNG</div></div><div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Take Photo</div></div>`}, {label: '3. Pay Fee', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pay Fee</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 8px 0;">$35.00</div><div style="font-size: 13px; opacity: 0.7;">License Renewal Fee</div></div><div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Pay Now</div></div>`}, {label: '4. Renewed', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">License Renewed!</div><div style="opacity: 0.8;">Arrives in 7-10 days</div></div>`}]},
            'apply_for_permit': {title: 'Apply for Permit', steps: [{label: '1. Permit Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Permit Application</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Building Permit</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Apply</div></div>`}, {label: '2. Application Form', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Application</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Property Address</div><div>123 Main St</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Project Type</div><div>Deck Addition</div></div></div>`}, {label: '3. Submit', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Submit</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Application Fee: $150</div><div style="font-size: 13px; opacity: 0.8;">Review time: 2-4 weeks</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Submit & Pay</div></div>`}, {label: '4. Submitted', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Application Submitted!</div><div style="opacity: 0.8;">Tracking #P-12345</div></div>`}]},
            'view_ballot': {title: 'View Ballot', steps: [{label: '1. Ballot Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Sample Ballot Available</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 5, 2025 Election</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Ballot Preview', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Sample Ballot</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Nov 5, 2025 Election</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> Federal Offices</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> State Propositions</div><div style="font-size: 13px; opacity: 0.7;"> Local Measures</div></div></div>`}]},
            'confirm_court_appearance': {title: 'Confirm Appearance', steps: [{label: '1. Court Notice', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Court Appearance</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Dec 1, 2025 @ 9:00 AM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Confirm</div></div>`}, {label: '2. Confirm Attendance', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Courtroom 4A</div><div style="font-size: 13px; opacity: 0.8;">Dec 1 @ 9:00 AM</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm Appearance</div></div>`}, {label: '3. Confirmed', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Appearance Confirmed!</div><div style="opacity: 0.8;">Arrive 15 min early</div></div>`}]},
            'schedule_inspection': {title: 'Schedule Inspection', steps: [{label: '1. Inspection Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Inspection Required</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Home Inspection</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div></div>`}, {label: '2. Select Date', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Available Dates</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(147, 51, 234, 0.4);"><div style="font-weight: 600;">Nov 18 @ 10:00 AM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Nov 19 @ 2:00 PM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(147, 51, 234, 0.15); border: 2px solid rgba(147, 51, 234, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Home Inspection</div><div style="font-size: 13px; opacity: 0.8;">Nov 18 @ 10:00 AM</div></div><div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Schedule</div></div>`}, {label: '4. Scheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Inspection Scheduled!</div><div style="opacity: 0.8;">Confirmation sent</div></div>`}]},
            'reset_password': {title: 'Reset Password', steps: [{label: '1. Reset Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Reset Password</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Click to reset</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reset</div></div>`}, {label: '2. New Password', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> New Password</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Password</div><div></div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 12px;"><div style="font-size: 12px; opacity: 0.7;">Confirm</div><div></div></div><div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Save Password</div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(255, 149, 0, 0.15); border: 2px solid rgba(255, 149, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Password meets requirements</div><div style="font-size: 13px; opacity: 0.8;"> At least 8 characters</div></div><div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm</div></div>`}, {label: '4. Reset Complete', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Password Reset!</div><div style="opacity: 0.8;">You can now log in</div></div>`}]},
            'verify_account': {title: 'Verify Account', steps: [{label: '1. Verification Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Verify Your Account</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Click to verify</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Verify</div></div>`}, {label: '2. Click Verify', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Verify Email</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Confirm your email address</div><div style="font-size: 13px; opacity: 0.8;">john@example.com</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Verify Email</div></div>`}, {label: '3. Verified', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Account Verified!</div><div style="opacity: 0.8;">You're all set</div></div>`}]},
            'verify_device': {title: 'Verify Device', steps: [{label: '1. Device Alert', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">New Device Login</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Was this you?</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Verify</div></div>`}, {label: '2. Approve Device', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> New Device</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-weight: 600; margin-bottom: 4px;">iPhone 15 Pro</div><div style="font-size: 13px; opacity: 0.7;">San Francisco, CA</div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Approve</div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Deny</div></div></div>`}, {label: '3. Verified', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Device Verified!</div><div style="opacity: 0.8;">Login approved</div></div>`}]},
            'review_security': {title: 'Review Security', steps: [{label: '1. Security Alert', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Security Update</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Review recent activity</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Review</div></div>`}, {label: '2. Activity Log', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Recent Activity</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">Login - Nov 1, 3:00 PM</div><div style="font-size: 12px; opacity: 0.7;">San Francisco, CA</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">Password Changed - Oct 28</div></div></div>`}, {label: '3. Review Complete', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Security OK!</div><div style="opacity: 0.8;">All activity verified</div></div>`}]},
            'revoke_secret': {title: 'Revoke Secret', steps: [{label: '1. Security Alert', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Exposed API Key</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Found in public repo</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 59, 48, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Revoke</div></div>`}, {label: '2. Confirm Revoke', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Revoke Key</div><div style="background: rgba(255, 59, 48, 0.15); border: 2px solid rgba(255, 59, 48, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">API Key: sk-</div><div style="font-size: 13px; opacity: 0.8;">This will stop all access</div></div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Revoke Now</div></div>`}, {label: '3. Revoked', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Key Revoked!</div><div style="opacity: 0.8;">Generate new key</div></div>`}]},
            'verify_social_account': {title: 'Verify Account', steps: [{label: '1. Verification Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Verify Social Account</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Confirm connection</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Verify</div></div>`}, {label: '2. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Verify</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Link @username?</div><div style="font-size: 13px; opacity: 0.8;">This will connect your accounts</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm</div></div>`}, {label: '3. Verified', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Account Verified!</div><div style="opacity: 0.8;">Successfully linked</div></div>`}]},
            'accept_social_invitation': {title: 'Accept Invitation', steps: [{label: '1. Invitation Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Network Invitation</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">From @username</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Accept</div></div>`}, {label: '2. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Accept?</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Connect with @username?</div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Accept</div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Decline</div></div></div>`}, {label: '3. Connected', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Invitation Accepted!</div><div style="opacity: 0.8;">Now connected</div></div>`}]},
            'view_social_message': {title: 'View Message', steps: [{label: '1. Message Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">New Message</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">From @username</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Read</div></div>`}, {label: '2. Message View', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Message</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">From: @username</div><div style="font-size: 14px; opacity: 0.9;">Hey, I wanted to connect about...</div></div></div>`}]},
            'join_meeting': {title: 'Join Meeting', steps: [{label: '1. Meeting Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Meeting Starting</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Nov 15 @ 2:00 PM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Join</div></div>`}, {label: '2. Joining...', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Joining Meeting</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px;"><div style="font-weight: 600; margin-bottom: 4px;">Opening Zoom...</div><div style="font-size: 13px; opacity: 0.8;">Meeting ID: 123-456-789</div></div></div>`}]},
            'view_incident': {title: 'View Incident', steps: [{label: '1. Incident Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Service Incident</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Status: Investigating</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Incident Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Incident #12345</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">API Performance Degradation</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Status: Investigating</div><div style="font-size: 13px; opacity: 0.7;">Started: 2:30 PM</div></div></div>`}]},
            'register_event': {title: 'Register Event', steps: [{label: '1. Event Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Conference Registration</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Dec 10-12, 2025</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Register</div></div>`}, {label: '2. Registration Form', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Register</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Name</div><div>John Smith</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Email</div><div>john@example.com</div></div></div>`}, {label: '3. Review', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Review</div><div style="background: rgba(147, 51, 234, 0.15); border: 2px solid rgba(147, 51, 234, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Conference Pass</div><div style="font-size: 13px; opacity: 0.8;">Dec 10-12, 2025</div></div><div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Complete Registration</div></div>`}, {label: '4. Registered', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Registered!</div><div style="opacity: 0.8;">Ticket sent to email</div></div>`}]},
            'register_for_sports': {title: 'Register Sports', steps: [{label: '1. Registration Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Youth Soccer Registration</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Spring 2026 Season</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Register</div></div>`}, {label: '2. Player Info', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Player Info</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Player Name</div><div>Sarah Smith</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-size: 12px; opacity: 0.7;">Age Group</div><div>U-10</div></div></div>`}, {label: '3. Pay Fee', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Registration Fee</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-size: 24px; font-weight: 700; color: #FFD700; margin: 8px 0;">$150.00</div><div style="font-size: 13px; opacity: 0.7;">Season Registration</div></div><div style="background: rgba(255, 149, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Pay & Register</div></div>`}, {label: '4. Registered', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Registered!</div><div style="opacity: 0.8;">Practice starts March 1</div></div>`}]},
            'unsubscribe': {title: 'Unsubscribe', steps: [{label: '1. Newsletter Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Marketing Newsletter</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Don't want these?</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 59, 48, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Unsubscribe</div></div>`}, {label: '2. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Unsubscribe?</div><div style="background: rgba(255, 59, 48, 0.15); border: 2px solid rgba(255, 59, 48, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Stop receiving emails?</div><div style="font-size: 13px; opacity: 0.8;">You can resubscribe anytime</div></div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Unsubscribe</div></div>`}, {label: '3. Unsubscribed', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Unsubscribed!</div><div style="opacity: 0.8;">You won't receive more emails</div></div>`}]},
            'take_survey': {title: 'Take Survey', steps: [{label: '1. Survey Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Customer Survey</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">2 minutes</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Start</div></div>`}, {label: '2. Answer Questions', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Survey</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-weight: 600; margin-bottom: 8px;">How was your experience?</div><div style="font-size: 24px;"></div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">Next </div></div>`}, {label: '3. Review', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Review</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">3 questions answered</div></div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Submit Survey</div></div>`}, {label: '4. Submitted', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Survey Complete!</div><div style="opacity: 0.8;">Thank you for your feedback</div></div>`}]},
            'cancel_subscription_service': {title: 'Cancel Service', steps: [{label: '1. Subscription Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Subscription</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">$9.99/month</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 59, 48, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Cancel</div></div>`}, {label: '2. Confirm Cancel', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Cancel Subscription?</div><div style="background: rgba(255, 59, 48, 0.15); border: 2px solid rgba(255, 59, 48, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Premium Plan</div><div style="font-size: 13px; opacity: 0.8;">Active until Dec 1, 2025</div></div><div style="background: rgba(255, 59, 48, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm Cancellation</div></div>`}, {label: '3. Cancelled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Subscription Cancelled</div><div style="opacity: 0.8;">Access until Dec 1</div></div>`}]},
            'extend_trial': {title: 'Extend Trial', steps: [{label: '1. Trial Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Trial Ending Soon</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Expires in 3 days</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 215, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Extend</div></div>`}, {label: '2. Extend Options', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Extend Trial</div><div style="background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">7 More Days Free</div><div style="font-size: 13px; opacity: 0.8;">No credit card required</div></div><div style="background: rgba(255, 215, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Extend Trial</div></div>`}, {label: '3. Extended', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Trial Extended!</div><div style="opacity: 0.8;">New end date: Nov 22</div></div>`}]},
            'view_usage': {title: 'View Usage', steps: [{label: '1. Usage Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Monthly Usage Report</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">October 2025</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Usage Dashboard', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Usage</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="margin-bottom: 12px;"><div style="font-size: 12px; opacity: 0.7;">API Calls</div><div style="font-weight: 600;">12,450 / 15,000</div></div><div style="margin-bottom: 12px;"><div style="font-size: 12px; opacity: 0.7;">Storage</div><div style="font-weight: 600;">8.2 GB / 10 GB</div></div><div><div style="font-size: 12px; opacity: 0.7;">Bandwidth</div><div style="font-weight: 600;">45 GB / 100 GB</div></div></div></div>`}]},
            'view_task': {title: 'View Task', steps: [{label: '1. Task Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Task Assignment</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Due Tomorrow</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Task Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Task Details</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Complete Q4 Report</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Due: Nov 15, 2025</div><div style="font-size: 13px; opacity: 0.7;">Priority: High</div></div></div>`}]},
            'view_ticket': {title: 'View Ticket', steps: [{label: '1. Ticket Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Support Ticket Update</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Ticket #T-12345</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Ticket Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Ticket #T-12345</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Login Issue</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Status: In Progress</div><div style="font-size: 13px; opacity: 0.7;">Updated: 2 hours ago</div></div></div>`}]}
,
            'add_to_notes': {title: 'Add to Notes', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Important Info</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Save for later</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 204, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Save</div></div>`}, {label: '2. Save', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Add to Notes</div><div style="background: rgba(255, 204, 0, 0.15); border: 2px solid rgba(255, 204, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Content copied</div><div style="font-size: 13px; opacity: 0.8;">Save to Notes app?</div></div><div style="background: rgba(255, 204, 0, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Save</div></div>`}, {label: '3. Saved', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Saved to Notes!</div><div style="opacity: 0.8;">Opened in Notes app</div></div>`}]},
            'add_reminder': {title: 'Add Reminder', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Follow Up</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Set reminder</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Remind</div></div>`}, {label: '2. Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> When?</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);"><div style="font-weight: 600;">Tomorrow @ 9 AM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Next Week</div></div></div>`}, {label: '3. Set', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reminder Set!</div><div style="opacity: 0.8;">Tomorrow @ 9 AM</div></div>`}]},
            'add_activity_to_calendar': {title: 'Add Activity', steps: [{label: '1. Activity', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Yoga Class</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Sat @ 10 AM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Add</div></div>`}, {label: '2. Calendar', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Add Event</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Yoga Class</div><div style="font-size: 13px; opacity: 0.8;">Sat, Nov 16 @ 10:00 AM</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Add to Calendar</div></div>`}, {label: '3. Added', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Event Added!</div><div style="opacity: 0.8;">Reminder set</div></div>`}]},
            'book_activity_tickets': {title: 'Book Tickets', steps: [{label: '1. Event', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Concert Tickets</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">$45 each</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Book</div></div>`}, {label: '2. Quantity', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> How Many?</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(147, 51, 234, 0.4);"><div style="font-weight: 600;">2 Tickets</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>4 Tickets</div></div></div>`}, {label: '3. Payment', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pay</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px;"><div style="font-size: 24px; font-weight: 700; color: #FFD700;">$90.00</div><div style="font-size: 13px; opacity: 0.7;">2 tickets</div></div><div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Pay Now</div></div>`}, {label: '4. Booked', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Tickets Booked!</div><div style="opacity: 0.8;">Added to Wallet</div></div>`}]},
            'book_appointment': {title: 'Book Appointment', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Book with Dr. Smith</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Available times</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Book</div></div>`}, {label: '2. Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Select Time</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(52, 199, 89, 0.4);"><div style="font-weight: 600;">Mon @ 10 AM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Tue @ 2 PM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">Dr. Smith</div><div style="font-size: 13px; opacity: 0.8;">Mon, Nov 18 @ 10 AM</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Book</div></div>`}, {label: '4. Booked', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Booked!</div><div style="opacity: 0.8;">Added to calendar</div></div>`}]},
            'change_delivery_preferences': {title: 'Change Delivery', steps: [{label: '1. Order', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Delivery Preferences</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Update delivery</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Change</div></div>`}, {label: '2. Options', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Preferences</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);"><div style="font-weight: 600;">Leave at door</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Signature required</div></div></div>`}, {label: '3. Updated', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Preferences Updated!</div><div style="opacity: 0.8;">Changes saved</div></div>`}]},
            'download_attachment': {title: 'Download File', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Document.pdf</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">2.4 MB</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Download</div></div>`}, {label: '2. Downloading', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Downloading</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px;"><div style="font-weight: 600;">Document.pdf</div><div style="font-size: 13px; opacity: 0.8; margin-top: 8px;">2.4 MB</div></div></div>`}, {label: '3. Downloaded', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Downloaded!</div><div style="opacity: 0.8;">Saved to Files</div></div>`}]},
            'open_link': {title: 'Open Link', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">View Page</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">External link</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Open</div></div>`}, {label: '2. Opening', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Opening Link</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px;"><div style="font-size: 13px; opacity: 0.8;">Opening in Safari...</div></div></div>`}]},
            'open_original_link': {title: 'Open Original', steps: [{label: '1. Link', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Shortened Link</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">View original URL</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Open</div></div>`}, {label: '2. Opening', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Opening</div><div style="background: rgba(100, 149, 237, 0.15); border: 2px solid rgba(100, 149, 237, 0.4); padding: 16px; border-radius: 12px;"><div style="font-size: 13px; opacity: 0.8;">Bypassing redirect...</div></div></div>`}]},
            'prepare_for_outage': {title: 'Prepare for Outage', steps: [{label: '1. Alert', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Planned Outage</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Sat 2-4 PM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Prepare</div></div>`}, {label: '2. Tips', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Preparation</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> Charge devices</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;"> Fill water containers</div><div style="font-size: 13px; opacity: 0.7;"> Check flashlights</div></div></div>`}]},
            'provide_access_code': {title: 'Access Code', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Your Access Code</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Gate code</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Code', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Access Code</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px;"><div style="font-size: 32px; font-weight: 700; letter-spacing: 8px; color: #FFD700;">1234</div><div style="font-size: 13px; opacity: 0.8; margin-top: 8px;">Valid until Dec 1</div></div></div>`}]},
            'read_community_post': {title: 'Read Post', steps: [{label: '1. Notification', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">New Community Post</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">From Admin</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Read</div></div>`}, {label: '2. Post', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Community Post</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Important Update</div><div style="font-size: 13px; opacity: 0.7;">Posted by Admin  2 hours ago</div></div></div>`}]},
            'reply_thanks': {title: 'Reply Thanks', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Thank You</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Send thanks</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(52, 199, 89, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reply</div></div>`}, {label: '2. Send', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Send Thanks</div><div style="background: rgba(52, 199, 89, 0.15); border: 2px solid rgba(52, 199, 89, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">"Thank you!"</div></div><div style="background: rgba(52, 199, 89, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Send</div></div>`}, {label: '3. Sent', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Thanks Sent!</div><div style="opacity: 0.8;">Message delivered</div></div>`}]},
            'reply_to_post': {title: 'Reply to Post', steps: [{label: '1. Post', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Community Discussion</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Add your reply</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Reply</div></div>`}, {label: '2. Compose', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Write Reply</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px; margin-bottom: 12px; min-height: 80px; color: rgba(255,255,255,0.5); font-style: italic;">Type your reply...</div><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Post Reply</div></div>`}, {label: '3. Posted', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reply Posted!</div><div style="opacity: 0.8;">Added to thread</div></div>`}]},
            'save_properties': {title: 'Save Properties', steps: [{label: '1. Listings', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">3 New Properties</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">In your area</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Save</div></div>`}, {label: '2. Select', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Select Properties</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);"><div style="font-weight: 600;">123 Main St - $450k</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>456 Oak Ave - $520k</div></div></div>`}, {label: '3. Saved', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Properties Saved!</div><div style="opacity: 0.8;">Added to favorites</div></div>`}]},
            'schedule_delivery_time': {title: 'Schedule Delivery', steps: [{label: '1. Order', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Choose Delivery Time</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Select a window</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div></div>`}, {label: '2. Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pick Time</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);"><div style="font-weight: 600;">Sat 10AM - 2PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Sat 2PM - 6PM</div></div></div>`}, {label: '3. Scheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Delivery Scheduled!</div><div style="opacity: 0.8;">Sat 10AM - 2PM</div></div>`}]},
            'schedule_extraction_retry': {title: 'Retry Extraction', steps: [{label: '1. Failed', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Extraction Failed</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Try again?</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Retry</div></div>`}, {label: '2. Retrying', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Retrying</div><div style="background: rgba(255, 149, 0, 0.15); border: 2px solid rgba(255, 149, 0, 0.4); padding: 16px; border-radius: 12px;"><div style="font-weight: 600;">Processing...</div><div style="font-size: 13px; opacity: 0.8;">This may take a moment</div></div></div>`}, {label: '3. Complete', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Extraction Complete!</div><div style="opacity: 0.8;">Data ready</div></div>`}]},
            'schedule_showing': {title: 'Schedule Showing', steps: [{label: '1. Property', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Schedule Showing</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">123 Main St</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Schedule</div></div>`}, {label: '2. Time', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Pick Time</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(147, 51, 234, 0.4);"><div style="font-weight: 600;">Sat @ 2 PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Sun @ 10 AM</div></div></div>`}, {label: '3. Confirm', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Confirm</div><div style="background: rgba(147, 51, 234, 0.15); border: 2px solid rgba(147, 51, 234, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-weight: 600;">123 Main St</div><div style="font-size: 13px; opacity: 0.8;">Sat @ 2 PM</div></div><div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;"> Confirm</div></div>`}, {label: '4. Scheduled', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Showing Scheduled!</div><div style="opacity: 0.8;">Agent notified</div></div>`}]},
            'set_outage_reminder': {title: 'Outage Reminder', steps: [{label: '1. Alert', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Planned Outage</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Sat 2-4 PM</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Remind Me</div></div>`}, {label: '2. When', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Remind When?</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 2px solid rgba(255, 149, 0, 0.4);"><div style="font-weight: 600;">1 hour before</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>1 day before</div></div></div>`}, {label: '3. Set', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Reminder Set!</div><div style="opacity: 0.8;">1 hour before outage</div></div>`}]},
            'share_achievement': {title: 'Share Achievement', steps: [{label: '1. Achievement', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">You earned a badge!</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;"> Expert Level</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 215, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Share</div></div>`}, {label: '2. Share', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Share</div><div style="background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.4); padding: 16px; border-radius: 12px; margin-bottom: 12px;"><div style="font-size: 48px; margin-bottom: 8px;"></div><div style="font-weight: 600;">Expert Level</div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"><div style="background: rgba(100, 149, 237, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">Twitter</div><div style="background: rgba(147, 51, 234, 0.3); padding: 12px; border-radius: 10px; text-align: center; font-weight: 600;">LinkedIn</div></div></div>`}, {label: '3. Shared', html: `<div class="modal-success-state"><div class="modal-success-icon"></div><div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Shared!</div><div style="opacity: 0.8;">Posted successfully</div></div>`}]},
            'view_activity': {title: 'View Activity', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Recent Activity</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Last 30 days</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Activity', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Activity Log</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">Login - Today @ 3 PM</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div>Settings Changed - Yesterday</div></div></div>`}]},
            'view_activity_details': {title: 'Activity Details', steps: [{label: '1. Summary', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Activity Summary</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">View details</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Details</div></div>`}, {label: '2. Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Full Details</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Total Actions: 42</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Most Active: Mon-Fri</div><div style="font-size: 13px; opacity: 0.7;">Peak Time: 10 AM</div></div></div>`}]},
            'view_extracted_content': {title: 'View Content', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Extracted Data</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">View extracted info</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Content', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Extracted Data</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Date: Nov 15, 2025</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Amount: $599.00</div><div style="font-size: 13px; opacity: 0.7;">Vendor: Acme Corp</div></div></div>`}]},
            'view_outage_details': {title: 'Outage Details', steps: [{label: '1. Alert', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Service Outage</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">View details</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(255, 149, 0, 0.3); border-radius: 10px; font-size: 13px;"><span></span> Details</div></div>`}, {label: '2. Details', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Outage Info</div><div style="background: rgba(255,255,255,0.08); padding: 16px; border-radius: 10px;"><div style="font-weight: 600; margin-bottom: 8px;">Planned Maintenance</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">When: Sat 2-4 PM</div><div style="font-size: 13px; opacity: 0.7; margin-bottom: 4px;">Area: Downtown</div><div style="font-size: 13px; opacity: 0.7;">Impact: 2,500 customers</div></div></div>`}]},
            'view_post_comments': {title: 'View Comments', steps: [{label: '1. Post', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">12 New Comments</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">On your post</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(100, 149, 237, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Comments', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Comments</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">@user1</div><div style="font-size: 13px; opacity: 0.7;">Great post!</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">@user2</div><div style="font-size: 13px; opacity: 0.7;">Thanks for sharing</div></div></div>`}]},
            'view_property_listings': {title: 'View Listings', steps: [{label: '1. Email', html: `<div class="modal-email-card"><div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">5 New Listings</div><div style="font-size: 13px; opacity: 0.8; margin-bottom: 12px;">Matching your criteria</div><div style="display: inline-flex; padding: 8px 14px; background: rgba(147, 51, 234, 0.3); border-radius: 10px; font-size: 13px;"><span></span> View</div></div>`}, {label: '2. Listings', html: `<div class="modal-preview-card"><div style="font-size: 18px; font-weight: 700; margin-bottom: 16px;"> Properties</div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">123 Main St</div><div style="font-size: 13px; opacity: 0.7;">3 bed, 2 bath  $450k</div></div><div style="background: rgba(255,255,255,0.08); padding: 12px; border-radius: 10px; margin-bottom: 8px;"><div style="font-weight: 600;">456 Oak Ave</div><div style="font-size: 13px; opacity: 0.7;">4 bed, 3 bath  $520k</div></div></div>`}]}        };

        // Global application state
        const appState = {
            // Track all completed swipe actions with history
            swipeHistory: [],

            // Track completed actions per email
            completedActions: {},

            // Track email processing queue
            emailQueue: {
                pending: [],      // Emails not yet processed
                processed: [],    // Emails that have been swiped
                archived: []      // Emails that were dismissed
            },

            // Session stats
            sessionStats: {
                startTime: Date.now(),
                totalSwipes: 0,
                actionsByType: {
                    right: 0,  // Primary action
                    left: 0,   // Archive
                    down: 0,   // Snooze
                    up: 0      // Change action
                },
                actionsCompleted: 0,
                emailsProcessed: 0
            }
        };

        // Initialize state with current email data
        function initializeState(emailData) {
            // Try to load saved state first
            const stateLoaded = loadState();

            // Only initialize if no saved state was found
            if (!stateLoaded || appState.emailQueue.pending.length === 0) {
                // Populate pending queue with all emails
                appState.emailQueue.pending = emailData.map((email, index) => ({
                    emailId: email.id || `email-${index}`,
                    subject: email.subject,
                    sender: email.from,
                    timestamp: Date.now(),
                    status: 'pending'
                }));

                console.log('State initialized with', appState.emailQueue.pending.length, 'emails');
                saveState();
            } else {
                console.log(' Restored previous session state');
            }
        }

        // Track swipe action
        function trackSwipeAction(direction, emailData, actionDetails = {}) {
            const emailId = emailData.id || emailData.subject;
            const swipeRecord = {
                emailId: emailId,
                emailSubject: emailData.subject,
                direction: direction,
                timestamp: Date.now(),
                actionDetails: actionDetails
            };

            // Add to swipe history
            appState.swipeHistory.push(swipeRecord);

            // Update session stats
            appState.sessionStats.totalSwipes++;
            appState.sessionStats.actionsByType[direction]++;

            // Move email from pending to appropriate queue
            const emailIndex = appState.emailQueue.pending.findIndex(
                e => e.emailId === emailId || e.subject === emailData.subject
            );

            if (emailIndex !== -1) {
                const email = appState.emailQueue.pending.splice(emailIndex, 1)[0];
                email.processedAt = Date.now();
                email.action = direction;

                if (direction === 'left') {
                    // Archive
                    appState.emailQueue.archived.push(email);
                } else {
                    // All other actions go to processed
                    appState.emailQueue.processed.push(email);
                }

                appState.sessionStats.emailsProcessed++;
            }

            console.log(`Swipe tracked: ${direction} on "${emailData.subject}"`);
            console.log(` Stats: ${appState.sessionStats.totalSwipes} total swipes, ${appState.emailQueue.pending.length} pending`);

            // Persist state to localStorage
            saveState();
        }

        // Track completed action (e.g., when user clicks action badge or completes modal)
        function trackCompletedAction(emailId, actionId, actionType, details = {}) {
            if (!appState.completedActions[emailId]) {
                appState.completedActions[emailId] = [];
            }

            const actionRecord = {
                actionId: actionId,
                actionType: actionType,
                completedAt: Date.now(),
                details: details
            };

            appState.completedActions[emailId].push(actionRecord);
            appState.sessionStats.actionsCompleted++;

            console.log(` Action completed: ${actionId} for email ${emailId}`);

            // Persist state to localStorage
            saveState();
        }

        // Get state summary for debugging
        function getStateSummary() {
            const summary = {
                swipes: appState.swipeHistory.length,
                pending: appState.emailQueue.pending.length,
                processed: appState.emailQueue.processed.length,
                archived: appState.emailQueue.archived.length,
                stats: appState.sessionStats,
                completedActions: Object.keys(appState.completedActions).length
            };

            console.table(summary);
            return summary;
        }

        // ==================== STATE PERSISTENCE ====================

        const STATE_KEY = 'zero_demo_state';

        // Save state to localStorage
        function saveState() {
            try {
                const stateToSave = {
                    swipeHistory: appState.swipeHistory,
                    completedActions: appState.completedActions,
                    emailQueue: appState.emailQueue,
                    sessionStats: appState.sessionStats,
                    savedAt: Date.now()
                };
                localStorage.setItem(STATE_KEY, JSON.stringify(stateToSave));
                console.log(' State saved to localStorage');
            } catch (error) {
                console.error('Failed to save state:', error);
            }
        }

        // Load state from localStorage
        function loadState() {
            try {
                const savedState = localStorage.getItem(STATE_KEY);
                if (savedState) {
                    const parsed = JSON.parse(savedState);

                    // Restore state
                    appState.swipeHistory = parsed.swipeHistory || [];
                    appState.completedActions = parsed.completedActions || {};
                    appState.emailQueue = parsed.emailQueue || {
                        pending: [],
                        processed: [],
                        archived: []
                    };
                    appState.sessionStats = parsed.sessionStats || appState.sessionStats;

                    console.log(' State loaded from localStorage');
                    console.log(`   Last saved: ${new Date(parsed.savedAt).toLocaleString()}`);
                    console.log(`   Swipes: ${appState.swipeHistory.length}, Pending: ${appState.emailQueue.pending.length}`);
                    return true;
                }
            } catch (error) {
                console.error('Failed to load state:', error);
            }
            return false;
        }

        // Clear saved state
        function clearState() {
            try {
                localStorage.removeItem(STATE_KEY);
                console.log(' State cleared from localStorage');

                // Reset to initial state
                appState.swipeHistory = [];
                appState.completedActions = {};
                appState.emailQueue = {
                    pending: [],
                    processed: [],
                    archived: []
                };
                appState.sessionStats = {
                    startTime: Date.now(),
                    totalSwipes: 0,
                    actionsByType: { right: 0, left: 0, down: 0, up: 0 },
                    actionsCompleted: 0,
                    emailsProcessed: 0
                };
            } catch (error) {
                console.error('Failed to clear state:', error);
            }
        }

        // Expose state for debugging in console
        window.appState = appState;
        window.getStateSummary = getStateSummary;
        window.saveState = saveState;
        window.loadState = loadState;
        window.clearState = clearState;

        // Initialize firefly background
        (function initFireflies() {
            const container = document.getElementById('fireflyBg');
            const fireflyCount = 40;
            const orbCount = 6;

            for (let i = 0; i < fireflyCount; i++) {
                const firefly = document.createElement('div');
                const rand = Math.random();
                const variant = rand < 0.33 ? 'small' : rand < 0.66 ? 'medium' : 'warm';
                firefly.className = `firefly ${variant}`;

                firefly.style.left = `${Math.random() * 100}%`;
                firefly.style.top = `${Math.random() * 100}%`;

                const duration = 8 + Math.random() * 12;
                firefly.style.animationDuration = `${duration}s`;
                firefly.style.animationDelay = `${Math.random() * -duration}s`;

                const moveRange = 60 + Math.random() * 80;
                firefly.style.setProperty('--tx1', `${(Math.random() - 0.5) * moveRange}px`);
                firefly.style.setProperty('--ty1', `${(Math.random() - 0.5) * moveRange}px`);
                firefly.style.setProperty('--tx2', `${(Math.random() - 0.5) * moveRange}px`);
                firefly.style.setProperty('--ty2', `${(Math.random() - 0.5) * moveRange}px`);
                firefly.style.setProperty('--tx3', `${(Math.random() - 0.5) * moveRange}px`);
                firefly.style.setProperty('--ty3', `${(Math.random() - 0.5) * moveRange}px`);

                container.appendChild(firefly);
            }
        })();

        // Tab Switcher
        function switchTab(tabName) {
            // Remove active class from all tab buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Add active class to clicked button based on onclick attribute
            buttons.forEach(btn => {
                const onclickAttr = btn.getAttribute('onclick');
                if (onclickAttr && onclickAttr.includes(`'${tabName}'`)) {
                    btn.classList.add('active');
                }
            });

            // Hide all tab content
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            // Show selected tab content
            const selectedTab = document.getElementById(`tab-${tabName}`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
        }

        // Animate metrics counter
        function animateCounter(id, target, suffix = '', duration = 2000) {
            const element = document.getElementById(id);
            const start = 0;
            const startTime = performance.now();

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // Easing function for smooth animation
                const easeOutQuad = progress * (2 - progress);
                const current = Math.floor(start + (target - start) * easeOutQuad);

                element.textContent = current + suffix;

                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }

            requestAnimationFrame(update);
        }

        // Metrics animation removed
        window.addEventListener('load', () => {
            setTimeout(() => {
                // Metrics removed - focus on demo experience
            }, 500);
        });

        // Archetype Switching (Mail vs Ads)
        let currentArchetype = 'mail';

        function switchArchetype(archetype) {
            if (archetype === currentArchetype) return;

            currentArchetype = archetype;

            // Update pills
            const mailPill = document.getElementById('mailPill');
            const adsPill = document.getElementById('adsPill');

            if (archetype === 'mail') {
                mailPill.classList.add('active');
                mailPill.classList.remove('inactive');
                adsPill.classList.remove('active');
                adsPill.classList.add('inactive');
            } else {
                adsPill.classList.add('active');
                adsPill.classList.remove('inactive');
                mailPill.classList.remove('active');
                mailPill.classList.add('inactive');
            }

            // Filter cards and reset stack
            filterCardsByArchetype(archetype);
        }

        function filterCardsByArchetype(archetype) {
            console.log(`Switched to ${archetype} archetype`);

            // Filter emails by type
            const filteredEmails = sampleEmails.filter(email => email.metadata.type === archetype);

            // Clear existing cards
            cardStack = [];
            emailFeed.innerHTML = '';

            // Recreate cards with filtered emails
            filteredEmails.forEach((email) => {
                const card = document.createElement('div');
                const gradientClass = email.metadata?.type === 'ads' ? 'gradient-ads' : 'gradient-mail';
                card.className = `email-card ${gradientClass}`;
                card.innerHTML = createCardHTML(email);

                // Store email data with card for swipe actions
                card.emailData = email;

                cardStack.push(card);
                emailFeed.appendChild(card);
            });

            // Reset to first card
            currentTopCardIndex = 0;
            updateStack();

            // Update background gradient
            const iphoneScreen = document.querySelector('.iphone-screen');
            if (archetype === 'mail') {
                iphoneScreen.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 30%, #4a1942 60%, #1f1f3a 100%)';
            } else {
                iphoneScreen.style.background = 'linear-gradient(135deg, #1a2e1a 0%, #1b4e2d 30%, #194a42 60%, #1f3a2e 100%)';
            }

            console.log(`Filtered to ${filteredEmails.length} ${archetype} emails`);
        }

        function refreshFeed() {
            // Rotate the refresh icon
            const refreshIcon = event.currentTarget.querySelector('span');
            refreshIcon.style.transition = 'transform 0.5s ease-in-out';
            refreshIcon.style.transform = 'rotate(360deg)';

            setTimeout(() => {
                refreshIcon.style.transform = 'rotate(0deg)';
            }, 500);

            // Reset to first card
            currentTopCardIndex = 0;
            updateStack();

            console.log('Feed refreshed');
        }

        // Rich iOS-style mock data from DataGenerator.swift
        const sampleEmails = [
            {
                from: 'Amazon',
                initial: 'A',
                subject: 'Package Shipped - Arriving Tomorrow',
                preview: 'Your order has shipped and is arriving tomorrow by 8 PM. Track with UPS.',
                intent: 'e-commerce.shipping.notification',
                intentConfidence: 1.0,
                timeAgo: '30m ago',
                aiSummary: {
                    actions: ' Track package arriving tomorrow by 8 PM',
                    why: 'Your order has shipped and is on its way.',
                    context: ' Order #1234567\n Carrier: UPS\n Expected: Tomorrow 8 PM'
                },
                suggestedActions: [
                    {
                        actionId: 'track_package',
                        displayName: 'Track Package',
                        actionType: 'IN_APP',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            trackingNumber: '1Z999AA10123456784',
                            carrier: 'UPS',
                            url: 'https://www.ups.com/track?tracknum=1Z999AA10123456784'
                        }
                    },
                    {
                        actionId: 'view_order',
                        displayName: 'View Order',
                        actionType: 'GO_TO',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            url: 'https://amazon.com/orders'
                        }
                    }
                ],
                actions: [
                    { name: 'Track Package', priority: 1, isPrimary: true },
                    { name: 'View Order', priority: 2, isPrimary: false }
                ],
                metadata: {
                    type: 'mail',
                    priority: 'high',
                    trackingNumber: '1Z999AA10123456784',
                    carrier: 'UPS',
                    estimatedDelivery: 'Tomorrow by 8 PM'
                },
                threadCount: 3  // Simple thread indicator for demo
            },
            {
                from: 'Mrs. Johnson',
                initial: 'J',
                subject: 'Field Trip Permission Form - Science Museum',
                preview: 'Emma\'s 3rd grade class is visiting the Science Museum on Oct 28. $25 fee due by Oct 24.',
                intent: 'education.permission.form',
                intentConfidence: 1.0,
                timeAgo: '2h ago',
                aiSummary: {
                    actions: ' Sign permission form by Oct 24\n Pay $25 field trip fee',
                    why: 'Emma needs permission and payment for upcoming field trip.',
                    context: ' Oct 28 trip to Science Museum\n Departs 8:30 AM, returns 2:30 PM\n Dinosaur exhibit + planetarium show'
                },
                suggestedActions: [
                    {
                        actionId: 'sign_form',
                        displayName: 'Sign & Send Form',
                        actionType: 'IN_APP',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            formType: 'permission',
                            dueDate: 'Oct 24',
                            studentName: 'Emma Chen',
                            event: 'Science Museum Field Trip'
                        }
                    },
                    {
                        actionId: 'pay_field_trip_fee',
                        displayName: 'Pay $25 Fee',
                        actionType: 'IN_APP',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            amount: 25.00,
                            paymentMethod: 'credit_card',
                            recipient: 'Lincoln Elementary School'
                        }
                    },
                    {
                        actionId: 'add_field_trip_to_calendar',
                        displayName: 'Add to Calendar',
                        actionType: 'NATIVE_API',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            title: 'Emma - Science Museum Field Trip',
                            date: 'Oct 28',
                            startTime: '8:30 AM',
                            endTime: '2:30 PM',
                            location: 'Science Museum'
                        }
                    }
                ],
                actions: [
                    { name: 'Sign & Send', priority: 1, isPrimary: true },
                    { name: 'Pay Fee', priority: 2, isPrimary: false },
                    { name: 'Add to Calendar', priority: 3, isPrimary: false }
                ],
                metadata: {
                    type: 'mail',
                    priority: 'high',
                    kidName: 'Emma Chen',
                    grade: '3rd Grade',
                    paymentAmount: 25.00,
                    requiresSignature: true
                },
                threadCount: 5  // Simple thread indicator for demo
            },
            {
                from: 'Best Buy',
                initial: 'B',
                subject: 'Sony WH-1000XM5 Headphones',
                preview: 'FLASH SALE: 30% off premium noise-cancelling headphones. Save $120 - today only!',
                intent: 'e-commerce.promotional.deal',
                intentConfidence: 0.95,
                timeAgo: '1h ago',
                aiSummary: {
                    actions: ' Claim 30% off deal **today only** (saves $120)',
                    why: 'Limited-time flash sale on premium noise-cancelling headphones.',
                    context: ' Industry-leading noise cancellation, 30hr battery\n LDAC audio, multi-point connectivity\n Free shipping + 30-day returns'
                },
                suggestedActions: [
                    {
                        actionId: 'schedule_purchase',
                        displayName: 'Claim Deal',
                        actionType: 'GO_TO',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            url: 'https://www.bestbuy.com/site/sony-wh-1000xm5',
                            product: 'Sony WH-1000XM5',
                            originalPrice: 399.99,
                            salePrice: 279.99,
                            savings: 120.00,
                            expiresAt: 'Today 11:59 PM'
                        }
                    },
                    {
                        actionId: 'save_to_cart',
                        displayName: 'Save for Later',
                        actionType: 'IN_APP',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            product: 'Sony WH-1000XM5',
                            price: 279.99,
                            merchant: 'Best Buy'
                        }
                    },
                    {
                        actionId: 'compare_prices',
                        displayName: 'Compare Prices',
                        actionType: 'GO_TO',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            productName: 'Sony WH-1000XM5',
                            merchants: ['Amazon', 'Target', 'Walmart']
                        }
                    }
                ],
                actions: [
                    { name: 'Claim Deal', priority: 1, isPrimary: true },
                    { name: 'Save for Later', priority: 2, isPrimary: false },
                    { name: 'Compare Prices', priority: 3, isPrimary: false }
                ],
                metadata: {
                    type: 'ads',
                    priority: 'high',
                    originalPrice: 399.99,
                    salePrice: 279.99,
                    discount: 30,
                    urgent: true,
                    expiresIn: '6 hours'
                },
                productImageUrl: 'https://picsum.photos/seed/headphones/400/240'
            },
            {
                from: 'Target',
                initial: 'T',
                subject: 'Extra 20% Off - Code: SAVE20',
                preview: 'Flash sale! Extra 20% off everything with code SAVE20. Ends tonight at midnight.',
                intent: 'marketing.promo-code.offer',
                intentConfidence: 0.98,
                timeAgo: '3h ago',
                aiSummary: {
                    actions: ' Copy code SAVE20 and shop by **midnight tonight**',
                    why: 'Flash sale with extra 20% off already-reduced items.',
                    context: ' Stack with clearance for maximum savings\n Valid on home, clothing, electronics'
                },
                suggestedActions: [
                    {
                        actionId: 'copy_promo_code',
                        displayName: 'Copy Code SAVE20',
                        actionType: 'IN_APP',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            promoCode: 'SAVE20',
                            discount: 20,
                            expiresAt: 'Tonight 11:59 PM',
                            categories: ['home', 'clothing', 'electronics']
                        }
                    },
                    {
                        actionId: 'shop_target_now',
                        displayName: 'Shop Now',
                        actionType: 'GO_TO',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            url: 'https://www.target.com?promo=SAVE20',
                            merchant: 'Target'
                        }
                    }
                ],
                actions: [
                    { name: 'Copy Code', priority: 1, isPrimary: true },
                    { name: 'Shop Now', priority: 2, isPrimary: false }
                ],
                metadata: {
                    type: 'ads',
                    priority: 'medium',
                    promoCode: 'SAVE20',
                    discount: 20,
                    expiresIn: 'Tonight',
                    urgent: true
                },
                productImageUrl: 'https://picsum.photos/seed/target/400/240'
            },
            {
                from: 'REI',
                initial: 'R',
                subject: 'Complete Your Order - 3 Items Waiting',
                preview: 'Your trail runners, water bottle, and yoga mat are waiting. Cart total: $156.97',
                intent: 'e-commerce.cart.abandoned',
                intentConfidence: 0.93,
                timeAgo: '4h ago',
                aiSummary: {
                    actions: ' Complete checkout for 3 items in cart',
                    why: 'Your running shoes, water bottle, and yoga mat are waiting.',
                    context: ' Total: $156.97'
                },
                suggestedActions: [
                    {
                        actionId: 'pay_invoice',
                        displayName: 'Complete Checkout',
                        actionType: 'GO_TO',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            url: 'https://www.rei.com/cart/checkout',
                            cartTotal: 156.97,
                            items: [
                                { name: 'Trail Running Shoes', price: 89.99 },
                                { name: 'Insulated Water Bottle', price: 29.99 },
                                { name: 'Yoga Mat', price: 36.99 }
                            ]
                        }
                    },
                    {
                        actionId: 'view_cart',
                        displayName: 'View Cart',
                        actionType: 'GO_TO',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            url: 'https://www.rei.com/cart',
                            itemCount: 3
                        }
                    },
                    {
                        actionId: 'save_cart_for_later',
                        displayName: 'Save for Later',
                        actionType: 'IN_APP',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            cartId: 'REI-CART-12345',
                            expiresIn: '7 days'
                        }
                    }
                ],
                actions: [
                    { name: 'Complete Cart', priority: 1, isPrimary: true },
                    { name: 'View Cart', priority: 2, isPrimary: false }
                ],
                metadata: {
                    type: 'ads',
                    priority: 'medium',
                    cartTotal: 156.97,
                    itemCount: 3
                },
                productImageUrl: 'https://picsum.photos/seed/rei/400/240'
            },
            {
                from: 'Avant Arte',
                initial: 'A',
                subject: 'James Jean - Sculpture and print duo',
                preview: 'Limited edition Sun Tarot Nebula collection drops Oct 31. One week only - 500 pieces.',
                intent: 'shopping.future_sale',
                intentConfidence: 1.0,
                timeAgo: '2h ago',
                aiSummary: {
                    actions: ' Schedule purchase for **October 31** launch',
                    why: 'Limited edition Sun Tarot Nebula collection drops soon.',
                    context: ' One-week-only release\n Sculpture and print duo'
                },
                suggestedActions: [
                    {
                        actionId: 'schedule_purchase',
                        displayName: 'Schedule Purchase',
                        actionType: 'IN_APP',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            productName: 'James Jean - Sun Tarot Nebula',
                            launchDate: 'Oct 31',
                            launchTime: '10:00 AM PST',
                            estimatedPrice: 500,
                            limitedEdition: true,
                            quantity: 500
                        }
                    },
                    {
                        actionId: 'set_launch_reminder',
                        displayName: 'Remind Me on Oct 31',
                        actionType: 'NATIVE_API',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            title: 'James Jean Art Drop',
                            date: 'Oct 31',
                            time: '9:45 AM',
                            alertBefore: '15 minutes'
                        }
                    }
                ],
                actions: [
                    { name: 'Buy on Oct 31', priority: 1, isPrimary: true },
                    { name: 'Remind me on Oct 31', priority: 2, isPrimary: false }
                ],
                metadata: {
                    type: 'ads',
                    priority: 'high',
                    saleDate: '31 October',
                    productName: 'James Jean - Sun Tarot Nebula',
                    urgent: true,
                    expiresIn: 'One week only'
                },
                productImageUrl: 'https://picsum.photos/seed/art/400/240'
            },
            {
                from: 'Acme Corp',
                initial: 'AC',
                subject: 'Invoice Due - $599.00',
                preview: 'Invoice #INV-2025-1234 is due on Oct 30. Professional services for September.',
                intent: 'billing.invoice.due',
                intentConfidence: 1.0,
                timeAgo: '6h ago',
                aiSummary: {
                    actions: ' Pay $599 invoice by **Oct 30** to avoid late fee',
                    why: 'Invoice for professional services is due this week.',
                    context: ' Invoice #INV-2025-1234\n Payment methods: ACH or credit card'
                },
                suggestedActions: [
                    {
                        actionId: 'pay_invoice',
                        displayName: 'Pay Invoice',
                        actionType: 'IN_APP',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            invoiceId: 'INV-2025-1234',
                            amount: 599.00,
                            dueDate: 'Oct 30',
                            paymentMethods: ['ACH', 'credit_card'],
                            recipient: 'Acme Corp',
                            description: 'Professional Services - September 2025'
                        }
                    },
                    {
                        actionId: 'view_invoice_details',
                        displayName: 'View Details',
                        actionType: 'GO_TO',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            url: 'https://acmecorp.com/invoices/INV-2025-1234',
                            invoiceNumber: 'INV-2025-1234'
                        }
                    },
                    {
                        actionId: 'download_invoice_pdf',
                        displayName: 'Download PDF',
                        actionType: 'GO_TO',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            url: 'https://acmecorp.com/invoices/INV-2025-1234/download',
                            filename: 'Invoice-INV-2025-1234.pdf'
                        }
                    }
                ],
                actions: [
                    { name: 'Pay Invoice', priority: 1, isPrimary: true },
                    { name: 'View Details', priority: 2, isPrimary: false },
                    { name: 'Download PDF', priority: 3, isPrimary: false }
                ],
                metadata: {
                    type: 'mail',
                    priority: 'high',
                    invoiceId: 'INV-2025-1234',
                    paymentAmount: 599.00,
                    dueDate: 'Oct 30',
                    urgent: true
                }
            },
            {
                from: 'Mr. Thompson',
                initial: 'T',
                subject: 'Assignment Past Due - Math Homework',
                preview: 'Lucas has a past-due Chapter 5 homework. Extended deadline: Friday 3 PM to avoid penalty.',
                intent: 'education.homework.reminder',
                intentConfidence: 0.92,
                timeAgo: '8h ago',
                aiSummary: {
                    actions: ' Submit Chapter 5 homework (problems 1-24) by **Friday 3 PM** to avoid late penalty',
                    why: 'Assignment is past due and needs immediate submission.',
                    context: ' Covers fractions, decimals, and word problems'
                },
                suggestedActions: [
                    {
                        actionId: 'view_assignment',
                        displayName: 'View Assignment',
                        actionType: 'GO_TO',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            url: 'https://schoolportal.com/assignment/CH5-math',
                            assignmentName: 'Chapter 5 Homework',
                            problems: '1-24',
                            subject: 'Math',
                            teacher: 'Mr. Thompson'
                        }
                    },
                    {
                        actionId: 'set_homework_reminder',
                        displayName: 'Set Reminder',
                        actionType: 'NATIVE_API',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            title: 'Lucas - Submit Math Homework',
                            date: 'Friday',
                            time: '2:00 PM',
                            alertBefore: '1 hour',
                            notes: 'Chapter 5, problems 1-24'
                        }
                    },
                    {
                        actionId: 'email_teacher',
                        displayName: 'Email Teacher',
                        actionType: 'NATIVE_API',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            recipient: 'thompson@school.edu',
                            subject: 'Re: Chapter 5 Homework Extension',
                            template: 'homework_extension'
                        }
                    }
                ],
                actions: [
                    { name: 'View Assignment', priority: 1, isPrimary: true },
                    { name: 'Add Reminder', priority: 2, isPrimary: false }
                ],
                metadata: {
                    type: 'mail',
                    priority: 'high',
                    kidName: 'Lucas Chen',
                    grade: '7th Grade',
                    dueDate: 'Friday 3 PM',
                    urgent: true
                }
            },
            {
                from: 'Mrs. Johnson',
                initial: 'J',
                subject: 'Science Project Graded - 95/100',
                preview: 'Emma\'s solar system project received 95/100! Excellent research and Saturn\'s rings detail.',
                intent: 'education.grade.notification',
                intentConfidence: 0.90,
                timeAgo: '1d ago',
                aiSummary: {
                    actions: 'None',
                    why: 'Emma\'s solar system project has been graded and received excellent marks.',
                    context: ' Scored 95/100 on solar system model\n Teacher praised planet research and Saturn\'s rings detail'
                },
                suggestedActions: [
                    {
                        actionId: 'check_grade',
                        displayName: 'View Grade Details',
                        actionType: 'GO_TO',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            url: 'https://schoolportal.com/grades/emma-chen/science-project',
                            assignmentName: 'Solar System Project',
                            score: '95/100',
                            teacher: 'Mrs. Johnson'
                        }
                    },
                    {
                        actionId: 'send_congrats_message',
                        displayName: 'Congratulate Emma',
                        actionType: 'NATIVE_API',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            messageType: 'celebration',
                            achievement: '95/100 on Solar System Project',
                            childName: 'Emma'
                        }
                    },
                    {
                        actionId: 'archive_grade_notification',
                        displayName: 'Archive',
                        actionType: 'IN_APP',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            category: 'grade_notifications',
                            studentName: 'Emma Chen'
                        }
                    }
                ],
                actions: [
                    { name: 'Check Grade', priority: 1, isPrimary: true },
                    { name: 'View Feedback', priority: 2, isPrimary: false }
                ],
                metadata: {
                    type: 'mail',
                    priority: 'low',
                    kidName: 'Emma Chen',
                    grade: '3rd Grade',
                    score: '95/100'
                }
            },
            {
                from: 'TechCrunch',
                initial: 'T',
                subject: 'The Download: This Week in AI - Issue #47',
                preview: 'Weekly AI & tech newsletter: GPT-5 speculation, EU AI Act, GitHub Copilot X upgrade...',
                intent: 'generic.newsletter',
                intentConfidence: 0.98,
                timeAgo: '2h ago',
                aiSummary: {
                    actions: 'None',
                    why: 'Weekly AI & tech newsletter with industry updates.',
                    context: ' GPT-5 speculation, EU AI Act goes live, GitHub Copilot X upgrade\n 67% of devs use AI assistants daily, $21B invested this quarter'
                },
                suggestedActions: [
                    {
                        actionId: 'view_newsletter_summary',
                        displayName: 'Read Newsletter',
                        actionType: 'GO_TO',
                        isPrimary: true,
                        priority: 1,
                        context: {
                            url: 'https://techcrunch.com/newsletters/the-download-47',
                            newsletterName: 'The Download',
                            issueNumber: 47,
                            readingTime: '8 mins'
                        }
                    },
                    {
                        actionId: 'save_newsletter_for_later',
                        displayName: 'Save for Later',
                        actionType: 'IN_APP',
                        isPrimary: false,
                        priority: 2,
                        context: {
                            category: 'newsletters',
                            publication: 'TechCrunch',
                            tags: ['AI', 'Technology', 'GPT-5']
                        }
                    },
                    {
                        actionId: 'archive_newsletter',
                        displayName: 'Archive',
                        actionType: 'IN_APP',
                        isPrimary: false,
                        priority: 3,
                        context: {
                            category: 'newsletters',
                            autoArchiveAfter: '7 days'
                        }
                    }
                ],
                actions: [
                    { name: 'View Summary', priority: 1, isPrimary: true },
                    { name: 'Save for Later', priority: 2, isPrimary: false },
                    { name: 'Archive', priority: 3, isPrimary: false }
                ],
                metadata: {
                    type: 'ads',
                    priority: 'low',
                    keyTopics: ['Artificial Intelligence', 'GPT-5', 'EU Regulation', 'GitHub']
                },
                productImageUrl: 'https://picsum.photos/seed/tech/400/240'
            }
        ];

        // iOS-style Card Stack Implementation
        const emailFeed = document.getElementById('emailFeed');
        let cardStack = [];
        let currentTopCardIndex = 0;

        // Swipe state
        let startX = 0, startY = 0, currentX = 0, currentY = 0;
        let isDragging = false;

        // Create card HTML
        function createCardHTML(email) {
            // Priority badge
            const priorityBadges = {
                high: '<span class="priority-badge high">HIGH</span>',
                medium: '<span class="priority-badge medium">MEDIUM</span>',
                low: '<span class="priority-badge low">LOW</span>'
            };
            const priorityBadge = priorityBadges[email.metadata?.priority || 'medium'];

            // Thread badge (simple visual indicator)
            const threadBadge = email.threadCount ? `
                <span class="thread-badge">
                    <span class="thread-badge-icon"></span>
                    <span>${email.threadCount}</span>
                </span>
            ` : '';

            // Status dots
            let statusDots = '';
            if (email.metadata?.discount) {
                statusDots += '<span class="status-dot shopping" title="Shopping"></span>';
            }
            if (email.metadata?.urgent) {
                statusDots += '<span class="status-dot deadline" title="Deadline"></span>';
            }
            if (email.metadata?.paymentAmount) {
                statusDots += '<span class="status-dot attachment" title="Payment Required"></span>';
            }

            // Urgency bar
            const urgencyBar = email.metadata?.urgent && email.metadata?.expiresIn ? `
                <div class="urgency-bar">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="white">
                        <path d="M8 0a8 8 0 100 16A8 8 0 008 0zm0 14.4A6.4 6.4 0 1114.4 8 6.407 6.407 0 018 14.4z"/>
                        <path d="M8.8 4H7.2v5.6l4 2.4.8-1.2-3.2-1.92V4z"/>
                    </svg>
                    <span>Expires in ${email.metadata.expiresIn}</span>
                </div>
            ` : '';

            // Check if this is an ADS card for image and truncation logic
            const isAdsCard = email.metadata?.type === 'ads';

            // Product image - Show for ADS cards with productImageUrl
            const productImage = (isAdsCard && email.productImageUrl) ? `
                <div class="product-image-container">
                    <img
                        src="${email.productImageUrl}"
                        alt="Product"
                        class="product-image"
                        loading="lazy"
                    />
                </div>
            ` : '';

            // AI Preview Section with Streamlined Percentage Bar
            // For ads cards, truncate content to match mail card heights
            const truncateText = (text, maxLength) => {
                if (!text) return text;
                if (text.length <= maxLength) return text;
                return text.substring(0, maxLength) + '...';
            };

            const truncatedActions = isAdsCard ? truncateText(email.aiSummary?.actions, 50) : email.aiSummary?.actions;
            const truncatedWhy = isAdsCard ? truncateText(email.aiSummary?.why, 80) : email.aiSummary?.why;
            // For context, only show first line for ads cards
            const truncatedContext = isAdsCard && email.aiSummary?.context ?
                email.aiSummary.context.split('\n')[0] :
                email.aiSummary?.context;

            const aiPreview = email.aiSummary ? `
                <div class="ai-preview-section">
                    <div class="ai-header-streamlined">
                        <div class="ai-header-top">
                            <svg width="12" height="12" viewBox="0 0 16 16" fill="white" opacity="0.8" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
                                <path d="M8 0l2.5 5.5L16 6.5l-4 4 1 5.5L8 13.5 3 16l1-5.5-4-4 5.5-1L8 0z"/>
                            </svg>
                            <span class="ai-label">Analysis Confidence</span>
                            <span class="ai-percentage">${Math.round(email.intentConfidence * 100)}%</span>
                        </div>
                        <div class="ai-progress-bar">
                            <div class="ai-progress-fill" style="width: ${Math.round(email.intentConfidence * 100)}%"></div>
                        </div>
                    </div>
                    <div class="ai-content">
                        <div class="ai-actions-list">${truncatedActions}</div>
                        <div class="ai-why">${truncatedWhy}</div>
                        <div class="ai-context">${truncatedContext}</div>
                    </div>
                </div>
            ` : '';

            // Pricing
            const pricing = email.metadata?.salePrice ? `
                <div class="pricing-section">
                    <span class="sale-price">$${email.metadata.salePrice.toFixed(0)}</span>
                    <span class="original-price">$${email.metadata.originalPrice.toFixed(0)}</span>
                    ${email.metadata.discount ? `<span class="discount-badge">${email.metadata.discount}% OFF</span>` : ''}
                </div>
            ` : '';

            return `
                <div class="card-header">
                    <button class="square-view-btn" onclick="event.stopPropagation(); openEmailDetail(this.closest('.email-card').emailData);">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="white" opacity="0.7">
                            <path d="M0 2.5A2.5 2.5 0 012.5 0h11A2.5 2.5 0 0116 2.5v11a2.5 2.5 0 01-2.5 2.5h-11A2.5 2.5 0 010 13.5v-11zM2.5 1A1.5 1.5 0 001 2.5v11A1.5 1.5 0 002.5 15h11a1.5 1.5 0 001.5-1.5v-11A1.5 1.5 0 0013.5 1h-11z"/>
                            <path d="M10.97 4.97a.75.75 0 011.07 1.05l-3.99 4.99a.75.75 0 01-1.08.02L4.324 8.384a.75.75 0 111.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 01.02-.022z"/>
                        </svg>
                        <span>View</span>
                    </button>

                    <div class="sender-block">
                        <div class="sender-name">${email.from}</div>
                        <div class="sender-time">${email.timeAgo}</div>
                    </div>

                    <div class="header-right">
                        ${priorityBadge}
                        <div class="status-dots">
                            ${statusDots}
                        </div>
                    </div>
                </div>

                ${urgencyBar}

                <div class="email-title">
                    ${email.subject}
                    ${threadBadge}
                </div>

                ${productImage}

                <div class="email-summary">${email.preview}</div>

                ${aiPreview}

                ${pricing}

                <div class="swipe-cta-track">
                    <div class="chevron-group">
                        <span></span><span></span><span></span>
                    </div>
                    <span class="cta-label">${email.actions[0].name}</span>
                </div>
            `;
        }

        // Initialize card stack - start with mail archetype
        const initialEmails = sampleEmails.filter(email => email.metadata.type === 'mail');
        initialEmails.forEach((email) => {
            const card = document.createElement('div');
            const gradientClass = email.metadata?.type === 'ads' ? 'gradient-ads' : 'gradient-mail';
            card.className = `email-card ${gradientClass}`;
            card.innerHTML = createCardHTML(email);

            // Store email data with card for swipe actions
            card.emailData = email;

            cardStack.push(card);
            emailFeed.appendChild(card);
        });

        // Initialize app state with current emails
        initializeState(initialEmails);

        // Update stack visual state
        function updateStack() {
            cardStack.forEach((card, index) => {
                const relativeIndex = index - currentTopCardIndex;

                if (relativeIndex < 0) {
                    // Already swiped away - hide completely
                    card.style.display = 'none';
                } else if (relativeIndex === 0) {
                    // Top card
                    card.classList.add('top-card');
                    card.style.display = 'block';
                    card.style.zIndex = 100;
                    card.style.transform = 'translate(0, 0) scale(1)';
                    card.style.opacity = '1';
                    card.style.pointerEvents = 'auto';
                } else if (relativeIndex === 1) {
                    // Second card - slightly behind and smaller
                    card.classList.remove('top-card');
                    card.style.display = 'block';
                    card.style.zIndex = 90;
                    card.style.transform = 'translate(0, 10px) scale(0.95)';
                    card.style.opacity = '0.7';
                    card.style.pointerEvents = 'none';
                } else if (relativeIndex === 2) {
                    // Third card - further behind and smaller
                    card.classList.remove('top-card');
                    card.style.display = 'block';
                    card.style.zIndex = 80;
                    card.style.transform = 'translate(0, 20px) scale(0.9)';
                    card.style.opacity = '0.4';
                    card.style.pointerEvents = 'none';
                } else {
                    // Cards further back - hidden
                    card.style.display = 'none';
                }
            });
        }

        // Handle mouse/touch events on email feed
        function handleMouseDown(e) {
            if (currentTopCardIndex >= cardStack.length) return;

            const topCard = cardStack[currentTopCardIndex];
            if (!topCard.classList.contains('top-card')) return;

            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            topCard.style.transition = 'none';
        }

        function handleMouseMove(e) {
            if (!isDragging || currentTopCardIndex >= cardStack.length) return;

            const topCard = cardStack[currentTopCardIndex];
            currentX = e.clientX - startX;
            currentY = e.clientY - startY;

            topCard.style.transform = `translate(${currentX}px, ${currentY}px) rotate(${currentX * 0.1}deg) scale(1)`;
        }

        function handleMouseUp() {
            if (!isDragging || currentTopCardIndex >= cardStack.length) return;

            const topCard = cardStack[currentTopCardIndex];
            const emailData = topCard.emailData;
            isDragging = false;

            const threshold = 100;

            // Determine swipe direction
            const absX = Math.abs(currentX);
            const absY = Math.abs(currentY);
            let swipeDirection = null;

            if (absX > threshold && absX > absY) {
                // Horizontal swipe
                swipeDirection = currentX > 0 ? 'right' : 'left';
            } else if (absY > threshold && absY > absX) {
                // Vertical swipe
                swipeDirection = currentY > 0 ? 'down' : 'up';
            }

            if (swipeDirection) {
                // Special handling for UP swipe - don't dismiss card, just show action sheet
                if (swipeDirection === 'up') {
                    // Snap back to position
                    topCard.style.transition = 'transform 0.3s ease';
                    topCard.style.transform = 'translate(0, 0) scale(1)';

                    // Execute action (show action sheet) but don't advance card
                    executeSwipeAction(swipeDirection, emailData);
                } else {
                    // All other swipes: fly card off screen and advance to next
                    topCard.style.transition = 'transform 0.4s ease, opacity 0.4s ease';

                    // Determine final position based on direction
                    let finalX = currentX * 5;
                    let finalY = currentY * 5;

                    if (swipeDirection === 'right') finalX = 800;
                    else if (swipeDirection === 'left') finalX = -800;
                    else if (swipeDirection === 'down') finalY = 800;

                    topCard.style.transform = `translate(${finalX}px, ${finalY}px) rotate(${currentX}deg) scale(1)`;
                    topCard.style.opacity = '0';

                    // Execute action based on direction
                    setTimeout(() => {
                        executeSwipeAction(swipeDirection, emailData);
                        currentTopCardIndex++;
                        updateStack();
                    }, 200); // Execute before card disappears for instant feedback
                }

            } else {
                // Snap back to position
                topCard.style.transition = 'transform 0.3s ease';
                topCard.style.transform = 'translate(0, 0) scale(1)';
            }

            currentX = 0;
            currentY = 0;
        }

        // ==================== ACTION FLOW MODAL FUNCTIONS ====================

        // Show action flow modal
        function showActionFlowModal(actionId) {
            const flow = MODAL_FLOWS[actionId];
            if (!flow) {
                console.log(`No modal flow found for action: ${actionId}`);
                return false;
            }

            const overlay = document.getElementById('actionFlowOverlay');
            const title = document.getElementById('actionFlowTitle');
            const stepsContainer = document.getElementById('actionFlowSteps');

            // Set title
            title.textContent = flow.title;

            // Build steps HTML
            let stepsHTML = '';
            flow.steps.forEach((step, index) => {
                if (index > 0) {
                    stepsHTML += '<div class="modal-flow-arrow"></div>';
                }
                stepsHTML += `
                    <div class="modal-flow-step">
                        <div class="modal-flow-label">${step.label}</div>
                        ${step.html}
                    </div>
                `;
            });

            stepsContainer.innerHTML = stepsHTML;

            // Show overlay with animation
            overlay.classList.add('active');

            // Add escape key listener
            document.addEventListener('keydown', handleModalEscape);

            return true;
        }

        // Handle escape key for modal
        function handleModalEscape(e) {
            if (e.key === 'Escape') {
                closeActionFlowModal();
            }
        }

        // Close action flow modal
        function closeActionFlowModal() {
            const overlay = document.getElementById('actionFlowOverlay');
            overlay.classList.remove('active');

            // Remove escape key listener
            document.removeEventListener('keydown', handleModalEscape);

            // Ensure the email stack is ready for next interaction
            setTimeout(() => {
                updateStack();
            }, 100);
        }

        // Execute action based on swipe direction
        function executeSwipeAction(direction, emailData) {
            console.log(`Swipe ${direction} on email:`, emailData.subject);

            // Hide the in-phone instruction after first swipe
            const inPhoneInstruction = document.getElementById('inPhoneInstruction');
            if (inPhoneInstruction && !inPhoneInstruction.classList.contains('hide')) {
                inPhoneInstruction.classList.add('hide');
            }

            let actionDetails = {};

            switch (direction) {
                case 'right':
                    // Take primary action - show modal flow if available
                    if (emailData.suggestedActions && emailData.suggestedActions.length > 0) {
                        const primaryAction = emailData.suggestedActions.find(a => a.isPrimary) || emailData.suggestedActions[0];
                        actionDetails = {
                            actionId: primaryAction.actionId,
                            actionName: primaryAction.displayName,
                            actionType: primaryAction.actionType
                        };

                        // Try to show modal flow first
                        const modalShown = showActionFlowModal(primaryAction.actionId);

                        if (!modalShown) {
                            // Fallback to toast if no modal flow exists
                            showToast(` ${primaryAction.displayName}: ${emailData.subject}`);
                        }

                        console.log('Executing primary action:', primaryAction);
                    } else {
                        showToast(` Action completed: ${emailData.subject}`);
                    }
                    // Update counters - card is dismissed
                    onEmailDismissed(emailData.metadata?.type);
                    break;

                case 'left':
                    // Dismiss/Archive
                    actionDetails = { action: 'archive' };
                    showToast(` Archived: ${emailData.subject}`);
                    // Update counters - card is dismissed
                    onEmailDismissed(emailData.metadata?.type);
                    break;

                case 'down':
                    // Snooze
                    actionDetails = { action: 'snooze', snoozeUntil: 'tomorrow' };
                    showToast(`Snoozed until tomorrow: ${emailData.subject}`);
                    // Update counters - card is dismissed
                    onEmailDismissed(emailData.metadata?.type);
                    break;

                case 'up':
                    // Change action (show action selector bottom sheet)
                    if (emailData.suggestedActions && emailData.suggestedActions.length > 0) {
                        actionDetails = { action: 'show_action_sheet', availableActions: emailData.suggestedActions.length };
                        showActionSheet(emailData);
                    } else {
                        showToast(` No actions available`);
                    }
                    // Note: Swipe up doesn't dismiss, just shows actions
                    break;
            }

            // Track this swipe action in state
            trackSwipeAction(direction, emailData, actionDetails);
        }

        // Touch event handlers (with scroll prevention)
        function handleTouchStart(e) {
            // Prevent page scrolling while swiping cards
            if (e.target.closest('.email-card')) {
                e.preventDefault();
                const touch = e.touches[0];
                handleMouseDown({ clientX: touch.clientX, clientY: touch.clientY });
            }
        }

        function handleTouchMove(e) {
            if (isDragging) {
                // Prevent page scrolling during card swipe
                e.preventDefault();
                const touch = e.touches[0];
                handleMouseMove({ clientX: touch.clientX, clientY: touch.clientY });
            }
        }

        function handleTouchEnd(e) {
            if (isDragging) {
                e.preventDefault();
                handleMouseUp();
            }
        }

        // Attach event listeners
        emailFeed.addEventListener('mousedown', handleMouseDown);
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);

        // Attach touch event listeners with passive: false to allow preventDefault
        emailFeed.addEventListener('touchstart', handleTouchStart, { passive: false });
        document.addEventListener('touchmove', handleTouchMove, { passive: false });
        document.addEventListener('touchend', handleTouchEnd, { passive: false });

        // Initialize stack visual state
        updateStack();

        // ==================== ACTION HANDLING SYSTEM ====================

        // Handle action badge clicks
        function handleActionClick(event) {
            event.stopPropagation(); // Prevent card drag

            const badge = event.target;
            const actionId = badge.dataset.actionId;
            const actionType = badge.dataset.actionType;
            const displayName = badge.dataset.displayName;
            const emailId = badge.dataset.emailId;
            const context = JSON.parse(badge.dataset.actionContext);

            console.log(`Action clicked: ${actionId} (${actionType})`, context);

            // Route based on action type
            switch (actionType) {
                case 'IN_APP':
                    handleInAppAction(actionId, displayName, context, emailId);
                    break;
                case 'GO_TO':
                    handleGoToAction(actionId, displayName, context, emailId);
                    break;
                case 'NATIVE_API':
                    handleNativeApiAction(actionId, displayName, context, emailId);
                    break;
                default:
                    console.warn('Unknown action type:', actionType);
            }
        }

        // Handle IN_APP actions - show modal
        function handleInAppAction(actionId, displayName, context, emailId) {
            let modalHTML = '';

            // Route to specific modal based on actionId
            if (actionId === 'track_package') {
                modalHTML = buildTrackPackageModal(context);
            } else if (actionId === 'sign_permission_form') {
                modalHTML = buildSignFormModal(context);
            } else if (actionId === 'pay_field_trip_fee' || actionId === 'pay_invoice_now') {
                modalHTML = buildPaymentModal(context);
            } else if (actionId === 'copy_promo_code') {
                handleCopyPromoCode(context, emailId, actionId);
                return;
            } else if (actionId === 'save_to_cart' || actionId === 'save_cart_for_later') {
                modalHTML = buildSaveToCartModal(context);
            } else if (actionId === 'schedule_art_purchase') {
                modalHTML = buildSchedulePurchaseModal(context);
            } else if (actionId === 'archive_grade_notification') {
                modalHTML = buildArchiveGradeModal(context);
            } else if (actionId === 'archive_newsletter') {
                modalHTML = buildArchiveNewsletterModal(context);
            } else if (actionId === 'save_newsletter_for_later') {
                modalHTML = buildSaveNewsletterModal(context);
            } else {
                // Generic modal for unknown actions
                modalHTML = buildGenericModal(displayName, context);
            }

            showModal(modalHTML);

            // Track action as completed when modal is shown (simulating completion for demo)
            trackCompletedAction(emailId, actionId, 'IN_APP', { displayName, context });
        }

        // Handle GO_TO actions - open URL (simulate for demo)
        function handleGoToAction(actionId, displayName, context, emailId) {
            const url = context.url || '';
            console.log(`Opening URL: ${url}`);

            // For demo, show toast instead of actually opening
            showToast(` Opening: ${displayName}`);

            // Track action as completed
            trackCompletedAction(emailId, actionId, 'GO_TO', { displayName, url });

            // Uncomment to actually open URLs:
            // window.open(url, '_blank');
        }

        // Handle NATIVE_API actions - simulate iOS API call
        function handleNativeApiAction(actionId, displayName, context, emailId) {
            console.log(`Native API call: ${actionId}`, context);

            if (actionId.includes('calendar')) {
                showToast(`Added "${context.title}" to Calendar`);
            } else if (actionId.includes('reminder')) {
                showToast(`Reminder set for ${context.date || context.time}`);
            } else if (actionId.includes('email')) {
                showToast(` Email draft created for ${context.recipient}`);
            } else {
                showToast(` ${displayName} completed`);
            }

            // Track action as completed
            trackCompletedAction(emailId, actionId, 'NATIVE_API', { displayName, context });
        }

        // ==================== MODAL BUILDERS ====================

        function buildTrackPackageModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Track Package</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Tracking Information</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Tracking Number</div>
                                <div class="modal-info-value">${context.trackingNumber}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Carrier</div>
                                <div class="modal-info-value">${context.carrier}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-section">
                        <div class="modal-section-title">Status</div>
                        <p style="font-size: 16px; color: rgba(255, 255, 255, 0.9);">
                             Package is in transit and expected to arrive by 8 PM tomorrow.
                        </p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="window.open('${context.url}', '_blank'); closeModal();">
                        Open Tracking Page
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Close</button>
                </div>
            `;
        }

        function buildSignFormModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Sign Permission Form</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Event Details</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Student</div>
                                <div class="modal-info-value">${context.studentName}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Event</div>
                                <div class="modal-info-value">${context.event}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Due Date</div>
                                <div class="modal-info-value">${context.dueDate}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Form Type</div>
                                <div class="modal-info-value">${context.formType}</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="handleFormSign(); closeModal();">
                         Sign & Submit
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildPaymentModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Make Payment</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Payment Details</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Amount</div>
                                <div class="modal-info-value">$${context.amount.toFixed(2)}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Recipient</div>
                                <div class="modal-info-value">${context.recipient}</div>
                            </div>
                            ${context.dueDate ? `
                            <div class="modal-info-item">
                                <div class="modal-info-label">Due Date</div>
                                <div class="modal-info-value">${context.dueDate}</div>
                            </div>
                            ` : ''}
                            ${context.invoiceId ? `
                            <div class="modal-info-item">
                                <div class="modal-info-label">Invoice</div>
                                <div class="modal-info-value">${context.invoiceId}</div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="handlePayment(${context.amount}); closeModal();">
                         Pay $${context.amount.toFixed(2)}
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildSchedulePurchaseModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Schedule Purchase</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Product Information</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Product</div>
                                <div class="modal-info-value">${context.productName}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Launch Date</div>
                                <div class="modal-info-value">${context.launchDate}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Launch Time</div>
                                <div class="modal-info-value">${context.launchTime}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Est. Price</div>
                                <div class="modal-info-value">$${context.estimatedPrice}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-section">
                        <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">
                             Limited edition: Only ${context.quantity} pieces available
                        </p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="handleScheduledPurchase('${context.productName}', '${context.launchDate}'); closeModal();">
                        Schedule for ${context.launchDate}
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildSaveToCartModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Save to Shopping Cart</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Item Details</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Product</div>
                                <div class="modal-info-value">${context.product}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Price</div>
                                <div class="modal-info-value">$${context.price}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Merchant</div>
                                <div class="modal-info-value">${context.merchant}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-section">
                        <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">
                             Track prices across all your shopping emails in one unified cart
                        </p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="handleSaveToCart('${context.product}'); closeModal();">
                        Save to Cart
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildGenericModal(displayName, context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">${displayName}</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <p style="font-size: 16px; color: rgba(255, 255, 255, 0.9);">
                            This action would perform: <strong>${displayName}</strong>
                        </p>
                    </div>
                    <div class="modal-section">
                        <div class="modal-section-title">Context</div>
                        <pre style="background: rgba(255, 255, 255, 0.05); padding: 12px; border-radius: 8px; overflow-x: auto; font-size: 12px; color: rgba(255, 255, 255, 0.8);">${JSON.stringify(context, null, 2)}</pre>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="showToast(' ${displayName} completed'); closeModal();">
                        Execute Action
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildArchiveGradeModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Archive Grade Notification</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Notification Details</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Student</div>
                                <div class="modal-info-value">${context.studentName}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Category</div>
                                <div class="modal-info-value">${context.category}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-section">
                        <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">
                             Archive this grade notification? You can always find it in your archived items.
                        </p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="showToast(' Grade notification archived'); closeModal();">
                         Archive
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildArchiveNewsletterModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Archive Newsletter</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Newsletter Details</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Category</div>
                                <div class="modal-info-value">${context.category}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Auto-Archive After</div>
                                <div class="modal-info-value">${context.autoArchiveAfter}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-section">
                        <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">
                             Archive this newsletter? It will be moved to your archived newsletters folder.
                        </p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="showToast(' Newsletter archived'); closeModal();">
                         Archive
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        function buildSaveNewsletterModal(context) {
            return `
                <div class="modal-header">
                    <h2 class="modal-title">Save Newsletter for Later</h2>
                    <button class="modal-close" onclick="closeModal()"></button>
                </div>
                <div class="modal-content">
                    <div class="modal-section">
                        <div class="modal-section-title">Newsletter Information</div>
                        <div class="modal-info-grid">
                            <div class="modal-info-item">
                                <div class="modal-info-label">Publication</div>
                                <div class="modal-info-value">${context.publication}</div>
                            </div>
                            <div class="modal-info-item">
                                <div class="modal-info-label">Category</div>
                                <div class="modal-info-value">${context.category}</div>
                            </div>
                            ${context.tags ? `
                            <div class="modal-info-item">
                                <div class="modal-info-label">Tags</div>
                                <div class="modal-info-value">${context.tags.join(', ')}</div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                    <div class="modal-section">
                        <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">
                             Save this newsletter to your reading list? You'll get a reminder to read it later.
                        </p>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="modal-btn primary" onclick="showToast(' Newsletter saved for later'); closeModal();">
                         Save for Later
                    </button>
                    <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                </div>
            `;
        }

        // ==================== MODAL & TOAST UTILITIES ====================

        function showModal(html) {
            const overlay = document.createElement('div');
            overlay.className = 'action-modal-overlay';
            overlay.id = 'actionModalOverlay';
            overlay.innerHTML = `<div class="action-modal">${html}</div>`;

            // Close on overlay click
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    closeModal();
                }
            });

            document.body.appendChild(overlay);
        }

        function closeModal() {
            const overlay = document.getElementById('actionModalOverlay');
            if (overlay) {
                overlay.style.opacity = '0';
                setTimeout(() => overlay.remove(), 300);
            }
        }

        function showToast(message) {
            // Get iPhone screen container
            const iphoneScreen = document.querySelector('.iphone-screen');
            if (!iphoneScreen) {
                console.warn('iPhone screen not found, toast not displayed');
                return;
            }

            const toast = document.createElement('div');
            toast.className = 'action-toast';
            toast.textContent = message;
            iphoneScreen.appendChild(toast);

            // Auto-dismiss after 2.5 seconds with slide-up animation
            setTimeout(() => {
                toast.style.animation = 'slideUpToastOut 0.4s ease-out forwards';
                setTimeout(() => toast.remove(), 400);
            }, 2500);
        }

        // ==================== ACTION HANDLERS ====================

        function handleCopyPromoCode(context, emailId, actionId) {
            const code = context.promoCode;
            // In real app, would use clipboard API
            console.log(`Copying promo code: ${code}`);
            showToast(` Copied code: ${code}`);

            // Track action as completed
            trackCompletedAction(emailId, actionId, 'IN_APP', { displayName: 'Copy Promo Code', promoCode: code });
        }

        function handleFormSign() {
            showToast(' Permission form signed and submitted!');
        }

        function handlePayment(amount) {
            showToast(` Payment of $${amount.toFixed(2)} processed successfully`);
        }

        function handleScheduledPurchase(product, date) {
            showToast(`Purchase scheduled for ${product} on ${date}`);
        }

        function handleSaveToCart(product) {
            showToast(`${product} saved to shopping cart`);
        }

        // ==================== ACTION SHEET SYSTEM ====================

        function showActionSheet(emailData) {
            // Get iPhone screen container
            const iphoneScreen = document.querySelector('.iphone-screen');
            if (!iphoneScreen) return;

            // Create overlay
            const overlay = document.createElement('div');
            overlay.className = 'action-sheet-overlay';
            overlay.id = 'actionSheetOverlay';
            overlay.onclick = closeActionSheet;

            // Create sheet
            const sheet = document.createElement('div');
            sheet.className = 'action-sheet';
            sheet.id = 'actionSheet';
            sheet.onclick = (e) => e.stopPropagation(); // Prevent closing when clicking sheet

            // Build content
            const currentPrimaryAction = emailData.suggestedActions.find(a => a.isPrimary) || emailData.suggestedActions[0];

            sheet.innerHTML = `
                <div class="action-sheet-handle"></div>
                <div class="action-sheet-header">
                    <div class="action-sheet-title">Choose Action</div>
                    <button class="action-sheet-close" onclick="closeActionSheet()"></button>
                </div>
                <div class="action-sheet-subtitle">
                    Swipe right to execute the selected action
                </div>
                <div class="quick-actions-section">
                    <div class="quick-actions-label">QUICK ACTIONS</div>
                    <div class="quick-actions-row" id="quickActionsRow">
                        <!-- Populated dynamically by JavaScript -->
                    </div>
                </div>
                <div class="action-options">
                    ${emailData.suggestedActions.map((action, index) => `
                        <div class="action-option ${action.actionId === currentPrimaryAction.actionId ? 'selected' : ''}"
                             data-action-index="${index}"
                             onclick="event.stopPropagation(); selectAction(event, ${index}, '${emailData.subject.replace(/'/g, "\\'")}')">
                            <div class="action-option-content">
                                <div class="action-option-name">${action.displayName}</div>
                                <div class="action-option-type">${action.actionType}</div>
                            </div>
                            <div class="action-option-check">
                                <svg viewBox="0 0 24 24">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                </svg>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            // Store email data reference for action selection
            sheet.emailData = emailData;

            // Append to iPhone screen (not body)
            iphoneScreen.appendChild(overlay);
            iphoneScreen.appendChild(sheet);

            // Populate Quick Actions after sheet is in DOM
            populateQuickActions(emailData);
        }

        function closeActionSheet() {
            const overlay = document.getElementById('actionSheetOverlay');
            const sheet = document.getElementById('actionSheet');

            if (overlay && sheet) {
                // Animate out
                sheet.style.animation = 'none';
                sheet.style.transform = 'translateY(100%)';
                overlay.style.opacity = '0';

                setTimeout(() => {
                    overlay.remove();
                    sheet.remove();
                }, 300);
            }
        }

        // ==================== QUICK ACTIONS HELPERS ====================

        function extractFirstURL(emailData) {
            // Search for URLs in subject, preview, and action contexts
            const text = `${emailData.subject} ${emailData.preview || ''} ${JSON.stringify(emailData.suggestedActions || [])}`;
            const urlPattern = /(https?:\/\/[^\s\)]+)/g;
            const match = text.match(urlPattern);

            if (match && match[0]) {
                // Clean up trailing punctuation
                return match[0].replace(/[.,!?;:)\]]+$/, '');
            }
            return null;
        }

        function populateQuickActions(emailData) {
            const container = document.getElementById('quickActionsRow');
            if (!container) return;

            const firstURL = extractFirstURL(emailData);
            const textToCopy = `${emailData.subject}\n\n${emailData.preview || ''}`;

            // Share button
            const shareBtn = createQuickActionButton(
                'share',
                'Share',
                '',
                () => {
                    // Web Share API if available
                    if (navigator.share) {
                        navigator.share({
                            title: emailData.subject,
                            text: emailData.preview,
                            url: firstURL || window.location.href
                        }).then(() => {
                            showToast(' Shared successfully');
                            closeActionSheet();
                        }).catch(err => console.log('Share cancelled'));
                    } else {
                        showToast(' Share not available in demo');
                    }
                }
            );

            // Copy button
            const copyBtn = createQuickActionButton(
                'copy',
                'Copy',
                '',
                () => {
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        showToast(' Copied to clipboard');
                        setTimeout(() => closeActionSheet(), 300);
                    }).catch(err => {
                        console.error('Copy failed:', err);
                        showToast(' Copy failed');
                    });
                }
            );

            // Safari/Open Link button
            const safariBtn = createQuickActionButton(
                'safari',
                firstURL ? 'Safari' : 'No Links',
                '',
                firstURL ? () => {
                    window.open(firstURL, '_blank');
                    showToast(' Opening link in new tab');
                    setTimeout(() => closeActionSheet(), 300);
                } : null,
                !firstURL
            );

            container.appendChild(shareBtn);
            container.appendChild(copyBtn);
            container.appendChild(safariBtn);
        }

        function createQuickActionButton(type, label, icon, onClick, disabled = false) {
            const btn = document.createElement('div');
            btn.className = `quick-action-btn ${type}${disabled ? ' disabled' : ''}`;

            const iconDiv = document.createElement('div');
            iconDiv.className = 'quick-action-icon';
            iconDiv.textContent = icon;

            const labelDiv = document.createElement('div');
            labelDiv.className = 'quick-action-label';
            labelDiv.textContent = label;

            btn.appendChild(iconDiv);
            btn.appendChild(labelDiv);

            if (!disabled && onClick) {
                btn.onclick = onClick;
            }

            return btn;
        }

        function selectAction(event, actionIndex, emailSubject) {
            // Prevent event propagation to avoid triggering swipe handlers
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }

            const sheet = document.getElementById('actionSheet');
            if (!sheet || !sheet.emailData) return;

            const emailData = sheet.emailData;
            const selectedAction = emailData.suggestedActions[actionIndex];

            // Update UI - remove selected from all, add to clicked
            const options = sheet.querySelectorAll('.action-option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[actionIndex].classList.add('selected');

            // Update the email data to make this action primary
            emailData.suggestedActions.forEach(action => {
                action.isPrimary = (action.actionId === selectedAction.actionId);
            });

            // Update the card's swipe CTA if it's the current top card
            if (currentTopCardIndex < cardStack.length) {
                const topCard = cardStack[currentTopCardIndex];
                if (topCard.emailData.subject === emailSubject) {
                    updateCardCTA(topCard, selectedAction.displayName);
                }
            }

            // Show confirmation toast
            showToast(`Action changed to: ${selectedAction.displayName}`);

            // Auto-close after selection
            setTimeout(() => {
                closeActionSheet();
            }, 1000);
        }

        function updateCardCTA(card, actionName) {
            // Find and update the swipe CTA label in the card
            const ctaLabel = card.querySelector('.cta-label');
            if (ctaLabel) {
                ctaLabel.textContent = actionName;
            }
        }

        // Email Detail Modal Functions
        function openEmailDetail(email) {
            const modal = document.getElementById('emailDetailModal');
            const content = document.getElementById('emailDetailContent');

            // Build the email detail HTML
            let html = `
                <div class="email-detail-from">From: ${email.from}</div>
                <h2 class="email-detail-subject">${email.subject}</h2>
                <div class="email-detail-meta">
                    <span>${email.timeAgo}</span>
                    <span></span>
                    <span>${Math.round(email.intentConfidence * 100)}% confidence</span>
                </div>
                <div class="email-detail-preview">${email.preview}</div>
            `;

            // AI Summary section
            if (email.aiSummary) {
                html += `
                    <div class="email-detail-section">
                        <div class="email-detail-section-title">AI Analysis</div>
                        <div class="email-detail-section-content">
                            <strong>Actions:</strong><br>${email.aiSummary.actions}<br><br>
                            <strong>Why:</strong><br>${email.aiSummary.why}<br><br>
                            <strong>Context:</strong><br>${email.aiSummary.context}
                        </div>
                    </div>
                `;
            }

            // Suggested Actions
            if (email.actions && email.actions.length > 0) {
                html += `
                    <div class="email-detail-section">
                        <div class="email-detail-section-title">Suggested Actions</div>
                        <div class="email-detail-actions">
                            ${email.actions.map((action, index) => `
                                <button class="email-detail-action-btn ${index === 0 ? 'primary' : ''}"
                                        onclick="handleEmailAction('${action.id}', '${email.subject}')">
                                    ${action.name}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            content.innerHTML = html;
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeEmailDetail() {
            const modal = document.getElementById('emailDetailModal');
            modal.classList.remove('show');
            document.body.style.overflow = '';
        }

        function handleEmailAction(actionId, emailSubject) {
            console.log(`Action clicked: ${actionId} for email: ${emailSubject}`);
            alert(`Action "${actionId}" would be executed for:\n"${emailSubject}"`);
            closeEmailDetail();
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeEmailDetail();
            }
        });

        // ============================================
        // EMAIL COUNTERS, PROGRESS BAR, & CELEBRATIONS
        // ============================================

        // Track dismissed emails by type
        let dismissedEmails = { mail: [], ads: [] };
        let totalInitialEmails = { mail: 0, ads: 0 };
        let initialized = false;

        // Initialize counters on page load
        function initializeCounters() {
            if (initialized) return;

            // Count initial emails by type from sampleEmails
            const allEmails = sampleEmails || [];
            totalInitialEmails.mail = allEmails.filter(e => e.metadata?.type === 'mail').length;
            totalInitialEmails.ads = allEmails.filter(e => e.metadata?.type === 'ads').length;

            console.log('Initialized email counters:', totalInitialEmails);
            initialized = true;
            updateAllCounters();
        }

        // Update email counter badges
        function updateEmailCounters() {
            const mailRemaining = totalInitialEmails.mail - dismissedEmails.mail.length;
            const adsRemaining = totalInitialEmails.ads - dismissedEmails.ads.length;

            // Update mail counter - always visible
            const mailCounter = document.getElementById('mailCounter');
            if (mailCounter) {
                mailCounter.textContent = mailRemaining;
                mailCounter.style.display = 'inline';
            }

            // Update ads counter - always visible
            const adsCounter = document.getElementById('adsCounter');
            if (adsCounter) {
                adsCounter.textContent = adsRemaining;
                adsCounter.style.display = 'inline';
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const totalEmails = totalInitialEmails.mail + totalInitialEmails.ads;
            const totalDismissed = dismissedEmails.mail.length + dismissedEmails.ads.length;

            if (totalEmails === 0) return;

            const progressPercentage = (totalDismissed / totalEmails) * 100;

            // Show progress bar if at least one email dismissed
            const progressContainer = document.getElementById('progressContainer');
            if (totalDismissed > 0 && progressContainer) {
                progressContainer.style.display = 'block';

                // Update percentage text
                const percentageEl = document.getElementById('progressPercentage');
                if (percentageEl) {
                    percentageEl.textContent = Math.round(progressPercentage) + '%';
                }

                // Update progress bar fill
                const progressFill = document.getElementById('progressBarFill');
                if (progressFill) {
                    progressFill.style.width = progressPercentage + '%';
                }
            }
        }

        // Check for celebrations
        function checkForCelebrations() {
            const mailRemaining = totalInitialEmails.mail - dismissedEmails.mail.length;
            const adsRemaining = totalInitialEmails.ads - dismissedEmails.ads.length;

            // Major celebration - both cleared
            if (mailRemaining === 0 && adsRemaining === 0 &&
                totalInitialEmails.mail > 0 && totalInitialEmails.ads > 0) {
                showMajorCelebration();
                return;
            }

            // Mini celebration - one archetype cleared
            if (mailRemaining === 0 && totalInitialEmails.mail > 0 &&
                dismissedEmails.mail.length === totalInitialEmails.mail) {
                showMiniCelebration('Mail');
            } else if (adsRemaining === 0 && totalInitialEmails.ads > 0 &&
                      dismissedEmails.ads.length === totalInitialEmails.ads) {
                showMiniCelebration('Ads');
            }
        }

        // Show mini celebration toast
        function showMiniCelebration(archetype) {
            const miniCelebration = document.getElementById('miniCelebration');
            const miniCelebrationText = document.getElementById('miniCelebrationText');
            const miniConfetti = document.getElementById('miniConfetti');

            if (!miniCelebration || !miniCelebrationText) return;

            // Update text
            miniCelebrationText.textContent = `${archetype} cleared!`;

            // Create confetti
            createConfetti(miniConfetti, 20);

            // Show celebration
            miniCelebration.style.display = 'flex';

            // Auto-dismiss after 2.5 seconds
            setTimeout(() => {
                miniCelebration.style.display = 'none';
                miniConfetti.innerHTML = '';
            }, 2500);
        }

        // Show major celebration full-screen
        function showMajorCelebration() {
            const majorCelebration = document.getElementById('majorCelebration');
            const majorConfetti = document.getElementById('majorConfetti');

            if (!majorCelebration) return;

            // Create lots of confetti
            createConfetti(majorConfetti, 80);

            // Show celebration
            majorCelebration.style.display = 'flex';
        }

        // Dismiss major celebration
        function dismissMajorCelebration() {
            const majorCelebration = document.getElementById('majorCelebration');
            const majorConfetti = document.getElementById('majorConfetti');

            if (majorCelebration) {
                majorCelebration.style.display = 'none';
                if (majorConfetti) {
                    majorConfetti.innerHTML = '';
                }
            }
        }

        // Create confetti animation
        function createConfetti(container, count) {
            if (!container) return;

            container.innerHTML = '';
            const colors = ['#FFD700', '#4CAF50', '#2196F3', '#FF69B4', '#9C27B0', '#FF9800'];

            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'absolute';
                confetti.style.width = (Math.random() * 8 + 4) + 'px';
                confetti.style.height = (Math.random() * 8 + 4) + 'px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = '50%';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '0';
                confetti.style.animation = `confettiFall ${(Math.random() * 2 + 1.5)}s linear forwards`;
                confetti.style.animationDelay = (Math.random() * 0.5) + 's';

                container.appendChild(confetti);
            }
        }

        // Call when an email is dismissed (call this from swipe handlers)
        function onEmailDismissed(emailType) {
            if (!initialized) {
                initializeCounters();
            }

            // Track dismissed email
            if (emailType === 'mail' || emailType === 'ads') {
                dismissedEmails[emailType].push(Date.now());
            }

            // Update everything
            updateAllCounters();
            checkForCelebrations();
        }

        // Update all counters and progress
        function updateAllCounters() {
            updateEmailCounters();
            updateProgressBar();
        }

        // Initialize on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeCounters);
        } else {
            initializeCounters();
        }

        // Hide instructions after 10 seconds
        setTimeout(() => {
            const topInstruction = document.getElementById('inPhoneInstruction');
            const bottomInstruction = document.getElementById('inPhoneInstructionBottom');
            if (topInstruction) {
                topInstruction.classList.add('hide');
            }
            if (bottomInstruction) {
                bottomInstruction.classList.add('hide');
            }
        }, 10000);

        // USAGE EXAMPLE:
        // When a card is swiped/dismissed, call: onEmailDismissed('mail') or onEmailDismissed('ads')
        // This will update counters, progress bar, and trigger celebrations automatically

        // ==================== BETA ACCESS FORM ====================

        function openBetaAccessForm() {
            const overlay = document.getElementById('betaFormOverlay');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeBetaAccessForm() {
            const overlay = document.getElementById('betaFormOverlay');
            overlay.classList.remove('active');
            document.body.style.overflow = '';

            // Reset form after closing
            setTimeout(() => {
                document.getElementById('betaFormContent').style.display = 'block';
                document.getElementById('betaSuccessContent').style.display = 'none';
                document.getElementById('betaAccessForm').reset();
            }, 300);
        }

        async function submitBetaAccess(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            // Log the submission
            console.log('Beta access request:', data);

            // In a real app, you'd send this to your backend
            // For now, we'll just show the success message
            try {
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1000));

                // You could send to an email service like:
                // await fetch('YOUR_API_ENDPOINT', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify(data)
                // });

                // Show success message
                document.getElementById('betaFormContent').style.display = 'none';
                document.getElementById('betaSuccessContent').style.display = 'block';

                // Track the conversion (optional)
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'beta_request', {
                        event_category: 'engagement',
                        event_label: data.provider
                    });
                }
            } catch (error) {
                console.error('Error submitting beta request:', error);
                alert('There was an error submitting your request. Please try again or email us directly at zerobeta@rationale.work');
            }
        }

        // Close modal when clicking outside
        document.getElementById('betaFormOverlay')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeBetaAccessForm();
            }
        });

        // ==================== ELLIPSES MENU FUNCTIONS ====================

        // Menu toggle functionality
        function toggleMenu() {
            const dropdown = document.getElementById('menuDropdown');
            dropdown.classList.toggle('show');
        }

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            const menuButton = document.getElementById('menuButton');
            const menuDropdown = document.getElementById('menuDropdown');
            if (menuButton && menuDropdown && !menuButton.contains(e.target) && !menuDropdown.contains(e.target)) {
                menuDropdown.classList.remove('show');
            }
        });

        // Regenerate Summaries function
        async function regenerateSummaries() {
            const button = document.getElementById('regenerateSummariesButton');
            const menuDropdown = document.getElementById('menuDropdown');

            if (button) {
                const originalContent = button.innerHTML;
                button.innerHTML = '<span class="menu-item-icon"></span><span>Regenerating...</span>';
                button.style.pointerEvents = 'none';

                try {
                    // Get user ID from session or prompt
                    let userId = sessionStorage.getItem('userId');
                    if (!userId) {
                        userId = prompt('Enter your User ID (or leave blank to use authenticated user):');
                        if (!userId) {
                            // Use authenticated user endpoint instead
                            button.innerHTML = '<span class="menu-item-icon"></span><span>Cancelled</span>';
                            setTimeout(() => {
                                button.innerHTML = originalContent;
                                button.style.pointerEvents = 'auto';
                            }, 2000);
                            return;
                        }
                        sessionStorage.setItem('userId', userId);
                    }

                    // Ask for number of emails to process
                    const maxEmails = prompt('How many emails to process? (default: 50)', '50');
                    const emailCount = parseInt(maxEmails) || 50;

                    button.innerHTML = '<span class="menu-item-icon"></span><span>Processing ' + emailCount + ' emails...</span>';

                    // Call the gateway API to fetch and process emails
                    const response = await fetch('/api/emails?maxResults=' + emailCount, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    if (!response.ok) {
                        throw new Error('Failed to fetch emails: ' + response.statusText);
                    }

                    const result = await response.json();
                    const processedCount = result.emails ? result.emails.length : 0;

                    button.innerHTML = '<span class="menu-item-icon"></span><span>Done! ' + processedCount + ' emails</span>';

                    // Show success message
                    setTimeout(() => {
                        alert(' Successfully regenerated summaries for ' + processedCount + ' emails!\n\n' +
                              'Fresh AI summaries with:\n' +
                              ' Actions (15px, 100% white)\n' +
                              ' Why (14px, 80% white, italic)\n' +
                              ' Context (13px, 70% white)\n\n' +
                              'Your iOS app will receive these on next sync.');

                        button.innerHTML = originalContent;
                        button.style.pointerEvents = 'auto';
                        menuDropdown.classList.remove('show');
                    }, 1500);

                } catch (error) {
                    console.error('Regenerate summaries error:', error);
                    button.innerHTML = '<span class="menu-item-icon"></span><span>Error: ' + error.message + '</span>';
                    setTimeout(() => {
                        button.innerHTML = originalContent;
                        button.style.pointerEvents = 'auto';
                    }, 3000);
                }
            }
        }

        // Logout function
        async function logout() {
            try {
                const button = document.getElementById('logoutButton');
                if (button) {
                    const originalContent = button.innerHTML;
                    button.innerHTML = '<span class="menu-item-icon"></span><span>Logging out...</span>';
                }

                const response = await fetch('/auth/logout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const result = await response.json();

                if (result.success) {
                    window.location.href = '/splash.html';
                } else {
                    alert('Logout failed. Please try again.');
                    if (button) {
                        button.innerHTML = '<span class="menu-item-icon"></span><span>Logout</span>';
                    }
                }
            } catch (error) {
                console.error('Logout error:', error);
                alert('Connection error. Please refresh the page.');
            }
        }

        // ==================== MOBILE MENU FUNCTIONS ====================

        function toggleMobileMenu() {
            const drawer = document.getElementById('mobileDrawer');
            const backdrop = document.getElementById('mobileBackdrop');
            drawer.classList.toggle('open');
            backdrop.classList.toggle('visible');
        }

        function closeMobileMenu() {
            const drawer = document.getElementById('mobileDrawer');
            const backdrop = document.getElementById('mobileBackdrop');
            drawer.classList.remove('open');
            backdrop.classList.remove('visible');
        }

        // Close mobile menu on link click
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.mobile-nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    setTimeout(closeMobileMenu, 300);
                });
            });
        });

    </script>

    <!-- Email Detail Modal -->
    <div id="emailDetailModal" class="email-modal">
        <div class="email-modal-overlay" onclick="closeEmailDetail()"></div>
        <div class="email-modal-content">
            <div class="email-modal-header">
                <button class="email-modal-close" onclick="closeEmailDetail()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <div class="email-modal-body">
                <div id="emailDetailContent"></div>
            </div>
        </div>
    </div>

    <!-- Action Flow Modal Overlay -->
    <div class="action-flow-overlay" id="actionFlowOverlay" onclick="closeActionFlowModal()">
        <div class="action-flow-modal" onclick="event.stopPropagation()">
            <button class="action-flow-close" onclick="closeActionFlowModal()"></button>
            <h2 class="action-flow-title" id="actionFlowTitle"></h2>
            <div class="modal-flow-horizontal" id="actionFlowSteps"></div>
        </div>
    </div>

    <!-- Ellipses Menu Button -->
    <div class="menu-button" id="menuButton" onclick="toggleMenu()">
        <div class="menu-button-icon"></div>
    </div>

    <!-- Menu Dropdown -->
    <div class="menu-dropdown" id="menuDropdown">
        <a href="https://apps.apple.com/us/app/testflight/id899247664" target="_blank" class="menu-item">
            <span class="menu-item-icon"></span>
            <span>Download TestFlight</span>
        </a>
        <a href="mailto:zerobeta@rationale.work?subject=Zero%20TestFlight%20Access%20Request&body=I%20agree%20to%20the%20confidentiality%20terms%20and%20would%20like%20access%20to%20the%20Zero%20beta.%0A%0AMy%20Apple%20ID%20email%3A%20" class="menu-item">
            <span class="menu-item-icon"></span>
            <span>Request Access</span>
        </a>
        <div class="menu-divider"></div>
        <a href="architecture-visual.html" class="menu-item">
            <span class="menu-item-icon"></span>
            <span>System Architecture</span>
        </a>
        <a href="system-health.html" class="menu-item">
            <span class="menu-item-icon"></span>
            <span>System Health</span>
        </a>
        <a href="design-system-renderer.html" class="menu-item">
            <span class="menu-item-icon"></span>
            <span>Design System</span>
        </a>
        <div class="menu-item" id="regenerateSummariesButton" onclick="regenerateSummaries()">
            <span class="menu-item-icon"></span>
            <span>Regenerate Summaries</span>
        </div>
        <div class="menu-divider"></div>
        <div class="menu-item" id="logoutButton" onclick="logout()">
            <span class="menu-item-icon"></span>
            <span>Logout</span>
        </div>
    </div>

</body>
</html>
